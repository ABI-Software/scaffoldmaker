"""
Constructs a 1-D network layout mesh with specifiable structure.
"""
from cmlibs.maths.vectorops import magnitude, mult
from cmlibs.utils.zinc.field import Field, findOrCreateFieldCoordinates, findOrCreateFieldStoredString,\
    findOrCreateFieldGroup
from cmlibs.utils.zinc.general import ChangeManager
from cmlibs.utils.zinc.scene import scene_get_selection_group
from cmlibs.zinc.field import Field, FieldGroup
from cmlibs.zinc.node import Node
from scaffoldmaker.meshtypes.scaffold_base import Scaffold_base
from scaffoldmaker.utils.networkmesh import NetworkMesh
from scaffoldmaker.utils.interpolation import smoothCurveSideCrossDerivatives
from scaffoldmaker.utils.zinc_utils import clearRegion, get_nodeset_field_parameters, \
    get_nodeset_path_ordered_field_parameters, make_nodeset_derivatives_orthogonal, \
    set_nodeset_field_parameters
from scaffoldmaker.annotation.annotationgroup import AnnotationGroup, findOrCreateAnnotationGroupForTerm, \
    findAnnotationGroupByName, getAnnotationGroupForTerm
from scaffoldmaker.annotation.vagus_terms import get_vagus_term
from enum import Enum


class MeshType_1d_vagus_path1(Scaffold_base):
    """
    Defines branching network layout with side dimensions.
    """

    parameterSetStructureStrings = {
        "Default": "1-2",
        # VN version from manual annotations (doesn't include branches from Japanese dataset)
        "Left vagus nerve (Jen)":  "1-2-3-4.1-5.1-6.1-7.1-8-9-10-11.1-12-13-14-15-16-17-18-19-20-21-22-23-24-25-26-27,"
                                   "27-28-29-30-31-32-33-34-35-36-37-38-39-40,"
                                   "4.2-41, 5.2-42, 5.3-43-44-45-46, 43.2-47, 44.2-48, 6.2-49-50, 49.2-51, 6.3-52-53,"
                                   "52.2-54, 7-55-56, 55.2-57-58, 56-59-60-61, 57.2-62, 58.1-63, 58.2-64-65, 64.2-66,"
                                   "59.2-67, 21.2-68, 21.3-69, 22.2-70, 22.3-71, 23.2-72, 23.3-73, 19.2-74,"
                                   "20.2-75-76-77-78-79-80, 79.2-81, 80.2-82, 77.2-83, 78.2-84, 80.1-85-86, 85.2-87,"
                                   "86-88, 86.2-89, 80.3-90, 75.2-91, 20.3-92, 24.2-93, 25.2-94, 35.2-95, 36.2-96-97,"
                                   "96.2-98, 4.3-99, 24.3-100, 49.3-101",
        "Right vagus nerve (Jen)": "1-2-3-4-5-6-7-8-9-10-11-12-13-14-15-16-17-18-19-20-21-22-23-101,"
                                   "101-24-25-26-27-28-29-30-31-32-33-34-35-36-37-38-39-40-41-42-43,"
                                   "5.2-44, 6.2-45, 8.2-46-47-48, 46.2-49, 8.3-50-51, 50.2-52, 7.2-53-54, 53.2-55,"
                                   "7.3-56, 56-57-58, 56.2-59-60-61, 57.2-62, 58.2-63, 57.3-64-65, 64.2-66, 59.2-67,"
                                   "24.2-68, 24.3-69, 25.2-70, 25.3-71, 26.2-72, 26.3-73, 27.2-74, 22.2-75,"
                                   "23.2-76-77-78-79-80, 79.2-81, 80.2-82, 78.2-83, 79.3-84, 80.1-85-86, 85.2-87,"
                                   "86-88, 86.2-89, 80.3-90, 76.2-91, 28.2-92, 23.3-93, 27.3-94, 33.2-95, 38.2-96-97,"
                                   "96.2-98, 46.3-99, 5.3-100, 101.2-102, 50.3-103",
        # VN version with Japanese dataset
        "Left vagus nerve 1": "1-2-3-4-5-6-7-8-9-10-11-12-13-14-15-16-17-18-19.1-20-21-22-23-24-25-26-27-28-29-30-31-32-33-34.1,"
                              "34.2-35-36, 19.2-37-38.1, 38.2-39-40, 38.3-41-42, 34.3-43.1-44, 43.2-45-46",
        "Right vagus nerve 1": "1-2-3-4-5-6-7-8-9-10-11-12-13-14-15-16-17-18-19-20-21-22-23-24-25.1-26-27-28-29-30-31-32-33-34-35-36.1-37-38.1-39-40-41,"
                               "25.2-42-43.1-44, 43.2-45, 36.2-46-47.1-48-49-50, 47.2-51-52, 38.2-53-54",
        # VN trunk only version with Japanese dataset
        "Left vagus nerve trunk 1": "1-2-3-4.1-5.1-6.1-7.1-8-9-10-11.1-12-13-14-15-16-17-18-19-20-21-22-23-24-25-26-27-28-29-30-31-32-33-34-35-36-37-38-39-40",
        "Right vagus nerve trunk 1": "1-2-3-4-5-6-7-8-9-10-11-12-13-14-15-16-17-18-19-20-21-22-23-24-25-26-27-28-29-30-31-32-33-34-35-36-37-38-39-40-41",
        # VN version with Japanese dataset and guessed locations for other branches
        "Left vagus nerve 2": "1-2.1-3.1-4-5.1-6-7.1-8.1-9-10-11-12-13.1-14-15-16-17-18.1-19.1-20-21-22-23-24-25-26-27-28-29-30-31-32-33-34.1, 34.2-35-36,"
                              "19.2-37-38.1, 38.2-39-40, 38.3-41-42, 34.3-43.1-44, 43.2-45-46, 8.2-47-48.1-49-50.1-53.1-56-57, 48.2-51-52, 50.2-54-55, 53.2-58-59,"
                              "7.2-60-61,18.2-62-63-64.1-65-68.1-74-70.1-71, 64.2-66-67,68.2-69-73,70.2-72,13.2-75-76-77-78,2.2-79-80,3.2-81-82,5.2-83-84-85",
    }

    @classmethod
    def getName(cls):
        return "1D Vagus Path 1"

    @classmethod
    def getParameterSetNames(cls):
        return list(cls.parameterSetStructureStrings.keys())

    @classmethod
    def getDefaultOptions(cls, parameterSetName="Default"):
        options = {}
        options["Base parameter set"] = parameterSetName
        options["Structure"] = cls.parameterSetStructureStrings[parameterSetName]
        options["Define inner coordinates"] = False  # can be overridden by parent scaffold
        return options

    @classmethod
    def getOrderedOptionNames(cls):
        return [
            #  "Base parameter set"  # Hidden.
            #  "Structure"  # Hidden so must edit via interactive function.
            #  "Define inner coordinates"  # Hidden as enabled by parent scaffold.
        ]

    @classmethod
    def checkOptions(cls, options):
        dependentChanges = False
        return dependentChanges

    @classmethod
    def generateBaseMesh(cls, region, options):
        """
        Generate the unrefined mesh.
        :param region: Zinc region to define model in. Must be empty.
        :param options: Dict containing options. See getDefaultOptions().
        :return: [] empty list of AnnotationGroup, NetworkMesh
        """
        parameterSetName = options['Base parameter set']
        structure = options["Structure"]
        defineInnerCoordinates = options["Define inner coordinates"]
        networkMesh = NetworkMesh(structure)
        networkMesh.create1DLayoutMesh(region)

        fieldmodule = region.getFieldmodule()
        coordinates = findOrCreateFieldCoordinates(fieldmodule).castFiniteElement()
        nodes = fieldmodule.findNodesetByFieldDomainType(Field.DOMAIN_TYPE_NODES)
        fieldcache = fieldmodule.createFieldcache()

        outerPoints = []
        bifurcating_nodes = []
        nodesByGroup = []

        if "Default" in parameterSetName:
            return [], []

        elif "Left vagus nerve (Jen)" in parameterSetName:
            outerPoints = [
                [[10.9000, -70.4900, 1499.5100], [3.0580, 1.6070, -2.5650], [0.3500, 1.9500, 0.2800],
                 [1.5300, -0.3600, -0.3700], [0.8900, -0.4100, 1.7500], [-2.0800, 1.8500, 1.1800]],
                [[15.2100, -68.8900, 1497.3200], [5.4700, 1.5450, -1.7380], [1.4900, 1.3100, 0.1900],
                 [0.7600, -0.9100, 0.2000], [-0.3500, 0.1100, 1.9700], [-0.4000, -0.8200, -0.7400]],
                [[21.6400, -67.5800, 1496.3600], [4.2974, -4.1607, 0.0965], [1.4900, 1.3100, 0.1900],
                 [0.7600, -0.9100, 0.2000], [-0.3500, 0.1100, 1.9700], [-0.4000, -0.8200, -0.7400]],
                # node 4
                [[27.2300, -73.0400, 1493.4700],
                 [[3.6994,-1.1316,-5.2353],[-0.3511,4.4651,-0.8322], [1.2315,5.8715,-1.4765]],
                 [[1.4987, 0.4126, 1.2596], [1.4154, -0.0233, 1.4138], [1.4154, -0.0233, 1.4138]],
                 [[0.2100, -0.5900, 0.1500], [0.2100, -0.5900, 0.1500], [0.2100, -0.5900, 0.1500]],
                 [[-0.1349, -1.8397, 0.7632], [1.3103, -0.7186, -1.3236], [1.3103, -0.7186, -1.3236]],
                 [[0.1700, -1.0100, -0.7500], [0.1700, -1.0100, -0.7500], [0.1700, -1.0100, -0.7500]]],
                # node 5
                [[28.2300, -73.3400, 1489.4700],
                 [[2.0523,0.4427,-2.1600], [2.1347,1.1293,-1.9420], [-0.8352,3.2572,1.1936]],
                 [[1.4987, 0.4126, 1.2596], [1.7224, 0.4963, 0.8888], [1.7224, 0.4963, 0.8888]],
                 [[0.2100, -0.5900, 0.1500], [0.2100, -0.5900, 0.1500], [0.2100, -0.5900, 0.1500]],
                 [[-0.1349, -1.8397, 0.7632], [0.5881, -1.9062, -0.0754], [0.5881, -1.9062, -0.0754]],
                 [[0.1700, -1.0100, -0.7500], [0.1700, -1.0100, -0.7500], [0.1700, -1.0100, -0.7500]]],
                # node 6
                [[30.4300, -73.6200, 1486.2600],
                 [[0.2056,-0.5519,-4.2457], [-1.3771,-5.6707,-7.1371], [2.0282, 1.5674, -6.4014]],
                 [[1.8800, 0.1400, 0.6700], [1.8800, 0.1400, 0.6700], [1.8800, 0.1400, 0.6700]],
                 [[0.2100, -0.5900, 0.1500], [0.2100, -0.5900, 0.1500], [0.2100, -0.5900, 0.1500]],
                 [[0.0400, -1.9700, 0.3200], [0.0400, -1.9700, 0.3200], [0.0400, -1.9700, 0.3200]],
                 [[0.1700, -1.0100, -0.7500], [0.1700, -1.0100, -0.7500], [0.1700, -1.0100, -0.7500]]],
                # node 7
                [[31.9300, -74.3200, 1481.2600],
                 [[0.5408,-0.8766,-5.5422], [-2.8075,-15.9555,-62.8657]],
                 [[1.8800, 0.1400, 0.6700], [1.8800, 0.1400, 0.6700]],
                 [[0.2100, -0.5900, 0.1500], [0.2100, -0.5900, 0.1500]],
                 [[0.0400, -1.9700, 0.3200], [0.0400, -1.9700, 0.3200]],
                 [[0.1700, -1.0100, -0.7500], [0.1700, -1.0100, -0.7500]]],
                [[33.6200, -75.1600, 1476.6900], [2.8100, -2.3770, -10.7010], [1.9300, 0.1100, 0.5000],
                 [0.0600, -0.0400, -0.2200], [0.0000, -1.9600, 0.4200], [-0.0200, 0.0200, 0.1000]],
                [[35.8800, -78.4800, 1464.9500], [1.1740, -2.8740, -10.4120], [1.9900, 0.0600, 0.2300],
                 [0.0300, -0.0600, -0.2400], [-0.0000, -1.9300, 0.5300], [-0.0000, 0.0100, 0.0300]],
                [[36.1900, -80.9000, 1455.9700], [0.0770, -2.0120, -7.8650], [2.0000, 0.0000, 0.0200],
                 [0.0000, -0.0400, -0.1500], [-0.0100, -1.9400, 0.4900], [0.0000, -0.0100, -0.0300]],
                [[36.0900, -82.5300, 1449.2400], [-0.2730, -1.4680, -5.9770], [2.0000, -0.0200, -0.0900],
                 [-0.0100, -0.0300, -0.1400], [0.0000, -1.9400, 0.4800], [0.0000, -0.0100, -0.0500]],
                [[35.6900, -83.8300, 1444.0200], [-0.4590, -0.9780, -4.8470], [1.9800, -0.0500, -0.2600],
                 [-0.0100, -0.0100, -0.1300], [0.0000, -1.9600, 0.4100], [-0.0000, -0.0200, -0.1100]],
                # node 13
                [[34.6278, -85.2821, 1435.2964],
                 [[-1.3088, -0.8844, -6.6046], [-15.1195, -0.3262, 1.2225]],
                 [[1.9700, -0.0500, -0.3600], [1.9700, -0.0500, -0.3600]],
                 [[-0.0100, 0.0000, -0.0900], [-0.0100, 0.0000, -0.0900]],
                 [[-0.0000, -1.9800, 0.2700], [-0.0000, -1.9800, 0.2700]],
                 [[-0.0000, -0.0200, -0.1400], [-0.0000, -0.0200, -0.1400]]],
                [[32.1500, -86.0900, 1424.6500], [-3.8980, -1.1950, -17.0970], [1.9600, -0.0300, -0.4100],
                 [-0.0100, 0.0100, -0.0400], [-0.0000, -2.0000, 0.1400], [0.0000, -0.0100, -0.0400]],
                [[27.3000, -86.7500, 1405.4300], [-4.9910, -2.0750, -21.6580], [1.9500, -0.0400, -0.4400],
                 [0.0100, -0.0000, 0.1000], [0.0000, -1.9900, 0.1900], [0.0000, 0.0200, 0.1300]],
                [[22.3100, -90.5200, 1381.4900], [-1.7320, -6.3530, -25.9140], [2.0000, -0.0300, -0.1300],
                 [0.0000, 0.1000, 0.4300], [0.0000, -1.9500, 0.4600], [-0.0100, 0.0700, 0.2800]],
                [[24.4200, -99.5800, 1354.4300], [3.2710, -8.2110, -23.1480], [1.9500, 0.1600, 0.4300],
                 [-0.0100, 0.0500, 0.1700], [-0.0100, -1.8500, 0.7600], [-0.0000, 0.0200, 0.0600]],
                [[28.3800, -106.7800, 1335.2400], [2.3200, -5.2650, -15.7660], [1.9800, 0.0900, 0.2800],
                 [0.0200, -0.0800, -0.2100], [-0.0000, -1.9000, 0.6300], [0.0100, -0.0500, -0.1700]],
                # node 19
                [[29.4700, -110.3400, 1323.1400],
                 [[-0.9263, -2.1970, -7.4968], [-9.9426, 1.1121, -12.8108]],
                 [[2.0000, 0.0100, 0.0400], [2.0000, 0.0100, 0.0400]],
                 [[0.0100, -0.0300, -0.2200], [0.0100, -0.0300, -0.2200]],
                 [[0.0000, -1.9500, 0.4400], [0.0000, -1.9500, 0.4400]],
                 [[0.0200, -0.0500, -0.2500], [0.0200, -0.0500, -0.2500]]],
                # node 20
                [[29.1389, -113.0662, 1310.4759],
                 [[-0.5819,0.0967,-2.2031], [-4.5425, 8.1642, -10.6287], [-8.1002, 5.9478, -8.0234]],
                 [[2.0000, 0.0100, 0.0400], [2.0000, 0.0100, 0.0400], [2.0000, 0.0100, 0.0400]],
                 [[0.0100, -0.0300, -0.2200], [0.0100, -0.0300, -0.2200], [0.0100, -0.0300, -0.2200]],
                 [[0.0000, -1.9500, 0.4400], [0.0000, -1.9500, 0.4400], [0.0000, -1.9500, 0.4400]],
                 [[0.0200, -0.0500, -0.2500], [0.0200, -0.0500, -0.2500], [0.0200, -0.0500, -0.2500]]],
                # node 21
                [[28.2100, -113.1300, 1304.7800],
                 [[-2.8771,0.8180,-10.7422], [3.7327, -20.9284, -31.3466], [-8.5798,15.3954,-6.3984]],
                 [[2.0000, 0.0500, -0.1400], [2.0000, 0.0500, -0.1400], [2.0000, 0.0500, -0.1400]],
                 [[-0.0300, 0.1200, -0.2100], [-0.0300, 0.1200, -0.2100], [-0.0300, 0.1200, -0.2100]],
                 [[0.0600, -2.0000, 0.1000], [0.0600, -2.0000, 0.1000], [0.0600, -2.0000, 0.1000]],
                 [[-0.0400, 0.2500, -0.8800], [-0.0400, 0.2500, -0.8800], [-0.0400, 0.2500, -0.8800]]],
                # node 22
                [[22.0800, -105.1300, 1283.9900],
                 [[-6.2440, 13.1000,-18.0150],[ 15.8633, 18.0168, 10.8288],[ 1.4262, 27.5400, 0.8118]],
                 [[1.9400, 0.2800, -0.4000], [1.9400, 0.2800, -0.4000], [1.9400, 0.2800, -0.4000]],
                 [[-0.0200, 0.1100, -0.0800], [-0.0200, 0.1100, -0.0800], [-0.0200, 0.1100, -0.0800]],
                 [[-0.1100, -1.3600, -1.4600], [-0.1100, -1.3600, -1.4600], [-0.1100, -1.3600, -1.4600]],
                 [[-0.0300, 0.2500, -0.7000], [-0.0300, 0.2500, -0.7000], [-0.0300, 0.2500, -0.7000]]],
                 # node 23
                [[16.2000, -88.0200, 1270.0700],
                 [[-4.7340, 14.7100,-14.7400], [ 11.3995, 8.2100, 7.3099], [ 8.4930, 13.6615,-17.0755]],
                 [[1.9600, 0.2700, -0.3000], [1.9600, 0.2700, -0.3000], [1.9600, 0.2700, -0.3000]],
                 [[0.0300, -0.1000, 0.1100], [0.0300, -0.1000, 0.1100], [0.0300, -0.1000, 0.1100]],
                 [[-0.0000, -1.4800, -1.3400], [-0.0000, -1.4800, -1.3400], [-0.0000, -1.4800, -1.3400]],
                 [[0.0600, -0.2500, 0.3900], [0.0600, -0.2500, 0.3900], [0.0600, -0.2500, 0.3900]]],
                # node 24
                [[12.5900, -75.8000, 1255.0400],
                 [[-2.4550, 9.0700, -17.1730], [-4.0176, -8.0161, 14.3274], [-4.6795, -2.9697, 18.6149]],
                 [[1.9600, 0.2700, -0.3000], [1.9600, 0.2700, -0.3000], [1.9600, 0.2700, -0.3000]],
                 [[0.0300, -0.1000, 0.1100], [0.0300, -0.1000, 0.1100], [0.0300, -0.1000, 0.1100]],
                 [[-0.0000, -1.4800, -1.3400], [-0.0000, -1.4800, -1.3400], [-0.0000, -1.4800, -1.3400]],
                 [[0.0600, -0.2500, 0.3900], [0.0600, -0.2500, 0.3900], [0.0600, -0.2500, 0.3900]]],
                # node 25
                [[11.3900, -70.2700, 1236.6400],
                 [[-0.9680, 2.0750, -17.9280], [-4.3294, -2.3741, 12.3598]],
                 [[1.9600, 0.2700, -0.3000], [1.9600, 0.2700, -0.3000]],
                 [[0.0300, -0.1000, 0.1100], [0.0300, -0.1000, 0.1100]],
                 [[-0.0000, -1.4800, -1.3400], [-0.0000, -1.4800, -1.3400]],
                 [[0.0600, -0.2500, 0.3900], [0.0600, -0.2500, 0.3900]]],
                [[10.6700, -71.2900, 1219.9900], [-0.7540, -4.0290, -18.4990], [2.0000, -0.0200, -0.1000],
                 [0.0100, -0.0100, 0.1200], [-0.0000, -1.9700, 0.3700], [0.0100, 0.0300, 0.7500]],
                [[9.9200, -78.8500, 1200.3300], [-0.6040, -7.4150, -17.0050], [2.0000, 0.0500, 0.0600],
                 [-0.0300, -0.0400, -0.2000], [0.0200, -1.8100, 0.8500], [-0.0000, -0.0100, -0.0500]],
                [[9.4500, -85.8800, 1185.9700], [-1.6820, -5.4540, -14.7310], [2.0000, 0.0500, 0.0600],
                 [-0.0300, -0.0400, -0.2000], [0.0200, -1.8100, 0.8500], [-0.0000, -0.0100, -0.0500]],
                [[6.6200, -89.7000, 1171.1500], [-3.1360, -3.3600, -15.1710], [1.9400, -0.0800, -0.4600],
                 [-0.0000, 0.0400, 0.0800], [-0.0100, -1.9700, 0.3200], [-0.0100, 0.0400, 0.0800]],
                [[3.1800, -92.5700, 1155.6800], [-1.9530, -4.0670, -14.1290], [1.9400, -0.0800, -0.4600],
                 [-0.0000, 0.0400, 0.0800], [-0.0100, -1.9700, 0.3200], [-0.0100, 0.0400, 0.0800]],
                [[2.5400, -97.5100, 1143.1400], [0.8610, -6.1350, -11.1830], [1.9900, 0.1200, 0.2100],
                 [-0.1400, 0.0700, 0.7900], [0.0000, -1.7400, 0.9900], [0.0000, -0.0200, -0.1000]],
                [[4.7000, -104.4600, 1133.6100], [3.0040, -6.0820, -9.1750], [1.9900, 0.1200, 0.2100],
                 [-0.1400, 0.0700, 0.7900], [0.0000, -1.7400, 0.9900], [0.0000, -0.0200, -0.1000]],
                [[8.4000, -109.6400, 1124.9400], [5.2340, -3.8680, -9.3010], [1.9900, 0.1200, 0.2100],
                 [-0.1400, 0.0700, 0.7900], [0.0000, -1.7400, 0.9900], [0.0000, -0.0200, -0.1000]],
                [[15.0400, -111.8500, 1115.4500], [7.4420, 1.2160, -8.9840], [1.6600, 0.0700, 1.1100],
                 [-0.2300, -0.5000, 0.3600], [-0.0000, -2.0000, 0.1300], [0.0000, 0.1000, -1.0900]],
                # node 35
                [[21.5510, -107.8832, 1108.5723],
                 [[4.3528, 3.7140, -4.0727], [3.7142, -17.5660, -5.4125]],
                 [[1.4900, -0.7400, 1.1000], [1.4900, -0.7400, 1.1000]],
                 [[0.0100, -0.3900, -0.1600], [0.0100, -0.3900, -0.1600]],
                 [[0.0000, -1.6600, -1.1200], [0.0000, -1.6600, -1.1200]],
                 [[-0.0000, 0.2800, -0.7100], [-0.0000, 0.2800, -0.7100]]],
                # node 36
                [[27.8746, -102.8826, 1102.7865],
                 [[5.3910, 3.9787, -4.2085], [4.0449, -16.2467, -10.1740]],
                 [[1.5644, -0.6947, 0.9895], [1.5644, -0.6947, 0.9895]],
                 [[0.0100, -0.3900, -0.1600], [0.0100, -0.3900, -0.1600]],
                 [[0.0000, -1.6600, -1.1200], [0.0000, -1.6600, -1.1200]],
                 [[-0.0000, 0.2800, -0.7100], [-0.0000, 0.2800, -0.7100]]],
                [[33.1086, -99.4822, 1096.6479], [5.3801, 3.9959, -4.9890], [1.8813, -0.5939, 0.6402],
                 [0.0100, 0.6100, 0.0200], [-0.0000, -1.4300, -1.4000], [-0.0000, -0.0200, 0.8900]],
                [[38.5392, -94.5072, 1090.8784], [6.1389, 1.6957, -4.6728], [2.0260, -0.1290, 1.4950],
                 [0.1000, 0.7700, -0.2700], [-0.0000, -1.7600, 0.9400], [0.0000, 0.3500, 1.5700]],
                [[46.9139, -94.0263, 1084.1013], [7.5657, -2.4873, -6.8526], [1.7900, 0.8100, 0.3500],
                 [0.5500, -0.4300, -1.4300], [0.0000, -0.8000, 1.8300], [0.0000, 1.5700, 0.2100]],
                [[54.6608, -102.6169, 1076.9305], [2.2781, -7.2224, -3.5053], [1.7900, 0.8100, 0.3500],
                 [0.5500, -0.4300, -1.4300], [0.0000, -0.8000, 1.8300], [0.0000, 1.5700, 0.2100]],
                # ===== end of trunk =====
                # Meningeal branch of left vagus nerve
                [[14.6960, -32.9904, 1486.9920], [-24.3754, 38.9181, 22.9998], [1.6184, 0.3499, 1.1231],
                 [0.2100, -0.5900, 0.1500], [0.6927, 1.2549, -1.3893], [0.1700, -1.0100, -0.7500]],
                # Communicating branch of left vagus nerve with left glossopharyngeal nerve
                [[30.8700, -71.6880, 1488.1430], [2.2266, 2.2445, 0.2278], [1.5445, -1.2179, 0.3661],
                 [0.2100, -0.5900, 0.1500], [-0.7881, -1.3670, -1.2227], [0.1700, -1.0100, -0.7500]],
                # Auricular branch of left vagus nerve
                [[28.2181, -68.3688, 1490.3369],
                 [[3.7349,-1.0573,3.3055], [8.4262,6.0928,-4.3587]],
                 [[1.8800, 0.1400, 0.6700], [1.8800, 0.1400, 0.6700]],
                 [[0.2100, -0.5900, 0.1500], [0.2100, -0.5900, 0.1500]],
                 [[0.0400, -1.9700, 0.3200], [0.0400, -1.9700, 0.3200]],
                 [[0.1700, -1.0100, -0.7500], [0.1700, -1.0100, -0.7500]]],
                [[32.3171, -71.9379, 1490.4188],
                 [[5.3597,-5.4808,2.9572], [0.3206,-2.8190,0.3096]],
                 [[1.6184, 0.3499, 1.1231], [1.6184, 0.3499, 1.1231]],
                 [[0.2100, -0.5900, 0.1500], [0.2100, -0.5900, 0.1500]],
                 [[0.6927, 1.2549, -1.3893], [0.6927, 1.2549, -1.3893]],
                 [[0.1700, -1.0100, -0.7500], [0.1700, -1.0100, -0.7500]]],
                [[44.4821, -85.8005, 1502.0294], [4.1398,0.0031,0.2391], [1.8800, 0.1400, 0.6700],
                 [0.2100, -0.5900, 0.1500], [0.0400, -1.9700, 0.3200], [0.1700, -1.0100, -0.7500]],
                [[65.7398, -82.1005, 1504.2218], [13.4008,3.2505,4.0008], [1.8800, 0.1400, 0.6700],
                 [0.2100, -0.5900, 0.1500], [0.0400, -1.9700, 0.3200], [0.1700, -1.0100, -0.7500]],
                # Communicating branch of auricular branch of left vagus nerve with left facial nerve
                [[46.4026,-82.4326, 1503.0202], [ 3.7892,-1.6450, 0.6774], [1.8800, 0.1400, 0.6700],
                 [0.2100, -0.5900, 0.1500], [0.0400, -1.9700, 0.3200], [0.1700, -1.0100, -0.7500]],
                # Communicating branch of auricular branch of left vagus nerve with left posterior auricular nerve
                [[32.4154, -75.5411, 1490.4441], [-0.0675,-2.9089,-0.1767], [1.8800, 0.1400, 0.6700],
                 [0.2100, -0.5900, 0.1500], [0.0400, -1.9700, 0.3200], [0.1700, -1.0100, -0.7500]],
                # Pharyngeal branch of left vagus nerve to pharyngeal nerve plexus
                [[13.5765, -91.9411, 1451.3863],
                 [[-8.2897, -1.0782, -4.6843], [-6.2156, -1.8702, -6.1466], [0.5389, 0.0102, -4.1657]],
                 [[1.9300, 0.1100, 0.5000], [1.9300, 0.1100, 0.5000], [1.9300, 0.1100, 0.5000]],
                 [[0.0600, -0.0400, -0.2200], [0.0600, -0.0400, -0.2200], [0.0600, -0.0400, -0.2200]],
                 [[0.0000, -1.9600, 0.4200], [0.0000, -1.9600, 0.4200], [0.0000, -1.9600, 0.4200]],
                 [[-0.0200, 0.0200, 0.1000], [-0.0200, 0.0200, 0.1000], [-0.0200, 0.0200, 0.1000]]],
                [[-1.1585, -89.2309, 1440.2163], [-18.0779, 1.2775, -1.9563], [1.9300, 0.1100, 0.5000],
                 [0.0600, -0.0400, -0.2200], [0.0000, -1.9600, 0.4200], [-0.0200, 0.0200, 0.1000]],
                # Lingual branch of left vagus nerve
                [[-0.4285, -92.7257, 1439.0443], [-15.7715, 2.4150, -8.1361], [1.9300, 0.1100, 0.5000],
                 [0.0600, -0.0400, -0.2200], [0.0000, -1.9600, 0.4200], [-0.0200, 0.0200, 0.1000]],
                # Branch of left vagus nerve to carotid body
                [[30.9630, -73.2486, 1478.7567],
                 [[-0.1906,-2.3638,-2.7758],[-1.7882,-2.3760,-2.5368]],
                 [[-0.0832, 0.0555, 0.0000], [-0.0447, 0.0894, 0.0000]],
                 [[0.0000, 0.0000, 0.0000], [0.0000, 0.0000, 0.0000]],
                 [[-0.2301, -1.0028, -0.7709], [0.0000, 0.0000, 0.1000]],
                 [[0.0000, 0.0000, 0.0000], [0.0000, 0.0000, 0.0000]]],
                [[29.9776, -93.9686, 1409.5336], [0.5734,-3.8840,-11.8460], [1.9300, 0.1100, 0.5000],
                 [0.0600, -0.0400, -0.2200], [0.0000, -1.9600, 0.4200], [-0.0200, 0.0200, 0.1000]],
                # Communicating branch with superior cervical ganglion
                [[10.4833, -86.8700, 1438.7160], [-2.1567,-3.5702,-2.0174], [1.9300, 0.1100, 0.5000],
                 [0.0600, -0.0400, -0.2200], [0.0000, -1.9600, 0.4200], [-0.0200, 0.0200, 0.1000]],
                # left superior laryngeal nerve (LSLN)
                [[27.6225, -89.5755, 1423.3943],
                 [[-0.9115, -0.1216, -1.2207], [-6.4306, -5.0486, -28.1658]],
                 [[1.9300, 0.1100, 0.5000], [1.9300, 0.1100, 0.5000]],
                 [[0.0600, -0.0400, -0.2200], [0.0600, -0.0400, -0.2200]],
                 [[0.0000, -1.9600, 0.4200], [0.0000, -1.9600, 0.4200]],
                 [[-0.0200, 0.0200, 0.1000], [-0.0200, 0.0200, 0.1000]]],
                [[26.7407,-89.6576,1422.0663], [-0.8851,-0.8897,-4.4803], [1.9300, 0.1100, 0.5000],
                 [0.0600, -0.0400, -0.2200], [0.0000, -1.9600, 0.4200], [-0.0200, 0.0200, 0.1000]],
                # (LSLN) internal branch
                [[8.4878, -95.8129, 1397.6626],
                 [[-0.8122, 0.0187, -0.4185], [-10.2505, -6.9612, 6.8939]],
                 [[1.9300, 0.1100, 0.5000], [1.9300, 0.1100, 0.5000]],
                 [[0.0600, -0.0400, -0.2200], [0.0600, -0.0400, -0.2200]],
                 [[0.0000, -1.9600, 0.4200], [0.0000, -1.9600, 0.4200]],
                 [[-0.0200, 0.0200, 0.1000], [-0.0200, 0.0200, 0.1000]]],
                [[7.1061, -95.8046, 1397.6501],
                 [[-2.4925, -0.0409, 0.9555], [2.2068, 1.0772, -2.9073]],
                 [[1.9300, 0.1100, 0.5000], [1.9300, 0.1100, 0.5000]],
                 [[0.0600, -0.0400, -0.2200], [0.0600, -0.0400, -0.2200]],
                 [[0.0000, -1.9600, 0.4200], [0.0000, -1.9600, 0.4200]],
                 [[-0.0200, 0.0200, 0.1000], [-0.0200, 0.0200, 0.1000]]],
                # (LSLN) external branch
                [[23.1108, -89.2986, 1410.0957],
                 [[-4.5104,-5.3202,-8.9702], [-1.9507, 3.1463, -5.6968]],
                 [[1.9300, 0.1100, 0.5000], [1.9300, 0.1100, 0.5000]],
                 [[0.0600, -0.0400, -0.2200], [0.0600, -0.0400, -0.2200]],
                 [[0.0000, -1.9600, 0.4200], [0.0000, -1.9600, 0.4200]],
                 [[-0.0200, 0.0200, 0.1000], [-0.0200, 0.0200, 0.1000]]],
                [[12.9163, -102.0031, 1398.3710], [-1.4164,-2.5088,-0.8196], [1.9300, 0.1100, 0.5000],
                 [0.0600, -0.0400, -0.2200], [0.0000, -1.9600, 0.4200], [-0.0200, 0.0200, 0.1000]],
                [[11.7486, -106.7127, 1398.7817], [-1.5346,-1.2661,1.4698], [1.9300, 0.1100, 0.5000],
                 [0.0600, -0.0400, -0.2200], [0.0000, -1.9600, 0.4200], [-0.0200, 0.0200, 0.1000]],
                # (LSLN) superior ramus
                [[-0.6806, -112.5482, 1431.3310], [0.2608,-1.0801,8.2741], [1.9300,0.1100,0.5000], [1.9300, 0.1100, 0.5000],
                 [0.0600, -0.0400, -0.2200], [0.0000, -1.9600, 0.4200], [-0.0200, 0.0200, 0.1000]],
                # (LSLN) middle ramus
                [[-0.6895, -113.0155, 1420.5413], [-0.7957,-5.8373,9.8929], [1.9300, 0.1100, 0.5000],
                 [0.0600, -0.0400, -0.2200], [0.0000, -1.9600, 0.4200], [-0.0200, 0.0200, 0.1000]],
                # (LSLN) inferior ramus
                [[11.4102, -93.7816, 1396.2347],
                 [[6.1077, -0.0053, 3.8914], [0.5583, 1.9940, 1.1891]],
                 [[1.9300, 0.1100, 0.5000], [1.9300, 0.1100, 0.5000]],
                 [[0.0600, -0.0400, -0.2200], [0.0600, -0.0400, -0.2200]],
                 [[0.0000, -1.9600, 0.4200], [0.0000, -1.9600, 0.4200]],
                 [[-0.0200, 0.0200, 0.1000], [-0.0200, 0.0200, 0.1000]]],
                [[-0.6804, -113.3218, 1410.1632], [-7.8208,-10.2125,7.0257], [1.9300, 0.1100, 0.5000],
                 [0.0600, -0.0400, -0.2200], [0.0000, -1.9600, 0.4200], [-0.0200, 0.0200, 0.1000]],
                # (LSLN) inferior -> recurrent laryngeal nerve
                [[12.7805, -90.2359, 1398.5530], [3.7391, 4.6207, 3.7796], [1.9300, 0.1100, 0.5000],
                 [0.0600, -0.0400, -0.2200], [0.0000, -1.9600, 0.4200], [-0.0200, 0.0200, 0.1000]],
                # (LSLN) external -> cardiac
                [[23.4980, -89.2564, 1399.7058], [1.7082,-0.2474,-1.4862], [1.9300, 0.1100, 0.5000],
                 [0.0600, -0.0400, -0.2200], [0.0000, -1.9600, 0.4200], [-0.0200, 0.0200, 0.1000]],
                # Cardiopulmonary branch A of left vagus nerve
                [[52.4541, -156.4437, 1251.2588], [11.2779, -22.4247, -19.9086], [2.0000, 0.0500, -0.1400],
                 [-0.0300, 0.1200, -0.2100], [0.0600, -2.0000, 0.1000], [-0.0400, 0.2500, -0.8800]],
                # Cardiopulmonary branch B of left vagus nerve
                [[6.9094, -91.3545, 1292.7288], [-12.0172, 16.2036, -8.0041], [2.0000, 0.0500, -0.1400],
                 [-0.0300, 0.1200, -0.2100], [0.0600, -2.0000, 0.1000], [-0.0400, 0.2500, -0.8800]],
                # Pulmonary branch A of left vagus nerve
                [[63.0277, -50.6609, 1317.0952], [ 11.1088, 15.2968, 7.3678], [1.9600, 0.2700, -0.3000],
                 [0.0300, -0.1000, 0.1100], [-0.0000, -1.4800, -1.3400], [0.0600, -0.2500, 0.3900]],
                # Pulmonary branch B of left vagus nerve
                [[22.6853, -11.0470, 1279.4607], [-0.4135, 19.3014, 0.5808], [1.9600, 0.2700, -0.3000],
                 [0.0300, -0.1000, 0.1100], [-0.0000, -1.4800, -1.3400], [0.0600, -0.2500, 0.3900]],
                # Pulmonary branch C of left vagus nerve
                [[37.7152, -46.8935, 1306.6800], [7.1348, 11.2296, 9.3824], [1.9600, 0.2700, -0.3000],
                 [0.0300, -0.1000, 0.1100], [-0.0000, -1.4800, -1.3400], [0.0600, -0.2500, 0.3900]],
                # Pulmonary branch D of left vagus nerve
                [[53.6671, -29.8954, 1203.5182], [7.5787, 9.9694,-11.0793], [1.9600, 0.2700, -0.3000],
                 [0.0300, -0.1000, 0.1100], [-0.0000, -1.4800, -1.3400], [0.0600, -0.2500, 0.3900]],
                # Superior cervical cardiac branch of left vagus nerve
                [[0.4779, -105.2867, 1285.9475], [-5.9163,2.0127,-8.7524], [1.9600, 0.2700, -0.3000],
                 [0.0300, -0.1000, 0.1100], [-0.0000, -1.4800, -1.3400], [0.0600, -0.2500, 0.3900]],
                # Left recurrent laryngeal nerve (RLN)
                [[19.0334, -95.5163, 1294.0196],
                 [[-14.8973,9.5087,8.9161], [-8.2273,1.1272,-3.1722]],
                 [[1.9600, 0.2700, -0.3000], [1.9600, 0.2700, -0.3000]],
                 [[0.0300, -0.1000, 0.1100], [0.0300, -0.1000, 0.1100]],
                 [[-0.0000, -1.4800, -1.3400], [-0.0000, -1.4800, -1.3400]],
                 [[0.0600, -0.2500, 0.3900], [0.0600, -0.2500, 0.3900]]],
                [[8.6919, -91.8246, 1311.5225], [-6.0848, 6.3288, 27.0432], [1.9600, 0.2700, -0.3000],
                 [0.0300, -0.1000, 0.1100], [-0.0000, -1.4800, -1.3400], [0.0600, -0.2500, 0.3900]],
                [[11.4001, -94.9968, 1378.0901],
                 [[-0.2023,0.7018,6.4161], [-0.6262,0.5435,1.9659]],
                 [[1.9600, 0.2700, -0.3000], [1.9600, 0.2700, -0.3000]],
                 [[0.0300, -0.1000, 0.1100], [0.0300, -0.1000, 0.1100]],
                 [[-0.0000, -1.4800, -1.3400], [-0.0000, -1.4800, -1.3400]],
                 [[0.0600, -0.2500, 0.3900], [0.0600, -0.2500, 0.3900]]],
                [[11.3870, -95.0406, 1388.7899],
                 [[0.0541,-0.3335,1.4130], [-1.2088,-1.1339,-1.9307]],
                 [[1.9600, 0.2700, -0.3000], [1.9600, 0.2700, -0.3000]],
                 [[0.0300, -0.1000, 0.1100], [0.0300, -0.1000, 0.1100]],
                 [[-0.0000, -1.4800, -1.3400], [-0.0000, -1.4800, -1.3400]],
                 [[0.0600, -0.2500, 0.3900], [0.0600, -0.2500, 0.3900]]],
                [[11.5068, -95.5415, 1390.4597],
                 [[-0.9144,-0.3402,0.8441], [0.0737,-0.2825,4.1738]],
                 [[1.9600, 0.2700, -0.3000], [1.9600, 0.2700, -0.3000]],
                 [[0.0300, -0.1000, 0.1100], [0.0300, -0.1000, 0.1100]],
                 [[-0.0000, -1.4800, -1.3400], [-0.0000, -1.4800, -1.3400]],
                 [[0.0600, -0.2500, 0.3900], [0.0600, -0.2500, 0.3900]]],
                [[10.0471, -96.1702, 1391.5234],
                 [[-0.8494, 0.8192, 1.4390], [-0.0242, 1.1994, 1.6992], [0.0242, -1.1994, 1.6992]],
                 [[1.9600, 0.2700, -0.3000], [1.9600, 0.2700, -0.3000], [1.9600, 0.2700, -0.3000]],
                 [[0.0300, -0.1000, 0.1100], [0.0300, -0.1000, 0.1100], [0.0300, -0.1000, 0.1100]],
                 [[-0.0000, -1.4800, -1.3400], [-0.0000, -1.4800, -1.3400], [-0.0000, -1.4800, -1.3400]],
                 [[0.0600, -0.2500, 0.3900], [0.0600, -0.2500, 0.3900], [0.0600, -0.2500, 0.3900]]],
                # Extra-laryngeal branch of left recurrent laryngeal nerve to larynx
                [[10.5016, -95.2228, 1395.6882], [-0.6404,0.6123,3.1946], [1.9600, 0.2700, -0.3000],
                 [0.0300, -0.1000, 0.1100], [-0.0000, -1.4800, -1.3400], [0.0600, -0.2500, 0.3900]],
                # Branch of left recurrent laryngeal nerve to muscle of larynx
                [[10.0056, -93.0219, 1395.8130], [-0.7117, 1.3874, 3.9137], [1.9600, 0.2700, -0.3000],
                 [0.0300, -0.1000, 0.1100], [-0.0000, -1.4800, -1.3400], [0.0600, -0.2500, 0.3900]],
                # Oesophageal branch of left recurrent laryngeal nerve
                [[10.7185, -94.1379, 1380.5857], [-0.0113, 0.2478, 1.4472], [1.9600, 0.2700, -0.3000],
                 [0.0300, -0.1000, 0.1100], [-0.0000, -1.4800, -1.3400], [0.0600, -0.2500, 0.3900]],
                # Thoracic cardiac branch of left vagus nerve
                [[9.2595, -96.3103, 1385.9525], [-3.4894, -1.0471, -3.0155], [1.9600,0.2700,-0.3000],
                 [0.0300, -0.1000, 0.1100], [-0.0000, -1.4800, -1.3400], [0.0600, -0.2500, 0.3900]],
                # Left inferior laryngeal nerve
                [[8.7808, -95.1388, 1393.0321],
                 [[-0.1639, -0.0602, 0.2176], [0.8576, -1.3917, 3.7796]],
                 [[1.9600, 0.2700, -0.3000], [1.9600, 0.2700, -0.3000]],
                 [[0.0300, -0.1000, 0.1100], [0.0300, -0.1000, 0.1100]],
                 [[-0.0000, -1.4800, -1.3400], [-0.0000, -1.4800, -1.3400]],
                 [[0.0600, -0.2500, 0.3900], [0.0600, -0.2500, 0.3900]]],
                [[8.6384, -95.1266, 1393.4277],
                 [[-0.1747, -0.2489, 0.1621], [0.0824, 0.4057, 1.0760]],
                 [[0.6562, 0.4518, -0.1210], [0.6562, 0.4518, -0.1210]],
                 [[1.9600, 0.2700, -0.3000], [1.9600, 0.2700, -0.3000]],
                 [[0.0300, -0.1000, 0.1100], [0.0300, -0.1000, 0.1100]],
                 [[-0.0000, -1.4800, -1.3400], [-0.0000, -1.4800, -1.3400]],
                 [[0.0600, -0.2500, 0.3900], [0.0600, -0.2500, 0.3900]]],
                # External branch of left inferior laryngeal nerve
                [[11.7022, -97.0162, 1399.2783], [0.6695, -0.3472, 2.7418], [1.9600, 0.2700, -0.3000],
                 [0.0300, -0.1000, 0.1100], [-0.0000, -1.4800, -1.3400], [0.0600, -0.2500, 0.3900]],
                # Anterior branch of left inferior laryngeal nerve
                [[11.1431, -103.3034, 1397.6797], [-0.6865,-2.5246,1.5597], [1.9600, 0.2700, -0.3000],
                 [0.0300, -0.1000, 0.1100], [-0.0000, -1.4800, -1.3400], [0.0600, -0.2500, 0.3900]],
                # Posterior branch of left inferior laryngeal nerve
                [[12.2598, -92.7824, 1407.3522], [1.1149,0.1218,3.2497], [1.9600, 0.2700, -0.3000],
                 [0.0300, -0.1000, 0.1100], [-0.0000, -1.4800, -1.3400], [0.0600, -0.2500, 0.3900]],
                # Communicating branch of left recurrent laryngeal nerve with superior cervical ganglion
                [[11.3815, -86.5656, 1437.8576], [0.6900, 0.0312, 3.9184], [1.9600, 0.2700, -0.3000],
                 [0.0300, -0.1000, 0.1100], [-0.0000, -1.4800, -1.3400], [0.0600, -0.2500, 0.3900]],
                # Inferior cervical cardiac branch of left recurrent laryngeal nerve
                [[1.9207, -92.8650, 1286.3325], [-5.4763, 0.4194, -0.0683], [1.9600, 0.2700, -0.3000],
                 [0.0300, -0.1000, 0.1100], [-0.0000, -1.4800, -1.3400], [0.0600, -0.2500, 0.3900]],
                # Inferior cervical cardiac branch of left vagus nerve
                [[1.9148, -92.8645, 1286.3257], [-5.2030, 4.3597, -3.7504], [1.9600, 0.2700, -0.3000],
                 [0.0300, -0.1000, 0.1100], [-0.0000, -1.4800, -1.3400], [0.0600, -0.2500, 0.3900]],
                # Thoracic cardiac branch of left vagus nerve
                [[1.5668, -92.8989, 1286.4664], [-3.4398, -4.3571, 9.2364], [1.9600, 0.2700, -0.3000],
                 [0.0300, -0.1000, 0.1100], [-0.0000, -1.4800, -1.3400], [0.0600, -0.2500, 0.3900]],
                # Branch of left vagus nerve to oesophageal nerve plexus
                [[1.1929, -74.8360, 1271.2303], [-2.9636, 0.6150, 11.1126], [1.9600, 0.2700, -0.3000],
                 [0.0300, -0.1000, 0.1100], [-0.0000, -1.4800, -1.3400], [0.0600, -0.2500, 0.3900]],
                # Coeliac branch of posterior vagal trunk
                [[8.1221, -133.2556, 1081.3912], [-4.1922, -5.2024, -6.5829], [1.9600, 0.2700, -0.3000],
                 [0.0300, -0.1000, 0.1100], [-0.0000, -1.4800, -1.3400], [0.0600, -0.2500, 0.3900]],
                # Greater posterior gastric nerve
                [[27.8602, -120.8281, 1072.9021],
                 [[8.2004, 4.6372, 0.4561], [-0.7667, -16.8714, 4.5004]],
                 [[1.9600, 0.2700, -0.3000], [1.9600, 0.2700, -0.3000]],
                 [[0.0300, -0.1000, 0.1100], [0.0300, -0.1000, 0.1100]],
                 [[-0.0000, -1.4800, -1.3400], [-0.0000, -1.4800, -1.3400]],
                 [[0.0600, -0.2500, 0.3900], [0.0600, -0.2500, 0.3900]]],
                [[32.8055, -109.8948, 1080.1288], [4.6811, 4.9359, 6.8397], [1.9600, 0.2700, -0.3000],
                 [0.0300, -0.1000, 0.1100], [-0.0000, -1.4800, -1.3400], [0.0600, -0.2500, 0.3900]],
                # Pyloric branch of greater posterior gastric nerve
                [[-9.5661, -151.3492, 1070.4161], [-7.9182, -4.6821, -1.0408], [1.9600, 0.2700, -0.3000],
                 [0.0300, -0.1000, 0.1100], [-0.0000, -1.4800, -1.3400], [0.0600, -0.2500, 0.3900]],
                # Recurrent meningeal branch of left vagus nerve
                [[22.9618, -37.8955, 1487.2993], [-3.9441, 11.5206, -1.2405], [1.9600, 0.2700, -0.3000],
                 [0.0300, -0.1000, 0.1100], [-0.0000, -1.4800, -1.3400], [0.0600, -0.2500, 0.3900]],
                # Left cardiac branch to deep cardiac nerve plexus
                [[1.9304, -92.9963, 1287.2031], [0.1219, -2.0748, 2.7468], [1.9600, 0.2700, -0.3000],
                 [0.0300, -0.1000, 0.1100], [-0.0000, -1.4800, -1.3400], [0.0600, -0.2500, 0.3900]],
                # Communicating branch of pharyngeal branch of left vagus nerve with superior cervical ganglion
                [[10.6271, -86.8473, 1438.8579], [0.0200, 0.9359, -5.5805], [1.9600, 0.2700, -0.3000],
                 [0.0300, -0.1000, 0.1100], [-0.0000, -1.4800, -1.3400], [0.0600, -0.2500, 0.3900]],
            ]

            bifurcating_nodes = [4, 5, 6, 7, 13, 19, 20, 21, 22, 23, 24, 25, 35, 36, 43, 44, 49, 52, 55, 57, 58, 59, 64,
                                 75, 77, 78, 79, 80, 85, 86, 96]

            nodesByGroup = [
                ['left vagus X nerve trunk', [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
                                              21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
                                              36, 37, 38, 39, 40]],
                ['Meningeal branch of left vagus nerve', [4, 41]],
                ['Communicating branch of left vagus nerve with left glossopharyngeal nerve', [5, 42]],
                ['Auricular branch of left vagus nerve', [5, 43, 44, 45, 46]],
                ['Communicating branch of auricular branch of left vagus nerve with left facial nerve', [43, 47]],
                ['Communicating branch of auricular branch of left vagus nerve with left posterior auricular nerve', [44, 48]],
                ['Pharyngeal branch of left vagus nerve to pharyngeal nerve plexus', [6, 49, 50]],
                ['Lingual branch of left vagus nerve', [49, 51]],
                # NA: Communicating branch with superior cervical ganglion (branch of pharyngeal branch)
                ['Branch of left vagus nerve to carotid body', [6, 52, 53]],
                ['Communicating branch with superior cervical ganglion', [52, 54]], # (branch of branch of VN to carotid body)
                ['Left superior laryngeal nerve', [7, 55, 56]],
                ['Left internal laryngeal nerve', [55, 57, 58]],
                ['Left external laryngeal nerve', [56, 59, 60, 61]],
                ['Superior ramus of left internal laryngeal nerve', [57, 62]],
                ['Middle ramus of left internal laryngeal nerve', [58, 63]],
                ['Inferior ramus of left internal laryngeal nerve', [58, 64, 65]],
                ['Communicating branch of left internal laryngeal nerve with left recurrent laryngeal nerve', [64, 66]],
                ['Communicating branch of left external laryngeal nerve with left superior cardiac nerve', [59, 67]],
                ['Cardiopulmonary branch A of left vagus nerve', [21, 68]],
                ['Cardiopulmonary branch B of left vagus nerve', [21, 69]],
                ['Pulmonary branch A of left vagus nerve', [22, 70]],
                ['Pulmonary branch B of left vagus nerve', [22, 71]],
                ['Pulmonary branch C of left vagus nerve', [23, 72]],
                ['Pulmonary branch D of left vagus nerve', [23, 73]],
                ['Superior cervical cardiac branch of left vagus nerve', [19, 74]],
                ['Left recurrent laryngeal nerve', [20, 75, 76, 77, 78, 79, 80]],
                ['Extra-laryngeal branch of left recurrent laryngeal nerve to larynx', [79, 81]],
                ['Branch of left recurrent laryngeal nerve to muscle of larynx', [80, 82]],
                ['Oesophageal branch of left recurrent laryngeal nerve', [77, 83]],
                ['Tracheal branch of left recurrent laryngeal nerve', [78, 84]],
                ['Left inferior laryngeal nerve', [80, 85, 86]],
                ['External branch of left inferior laryngeal nerve', [85, 87]],
                ['Anterior branch of left inferior laryngeal nerve', [86, 88]],
                ['Posterior branch of left inferior laryngeal nerve', [86, 89]],
                # communicating branch: RLN <-> internal laryngeal (exists already) - 66 should be possibly connected to inferior laryngeal nerve
                ['Communicating branch of left recurrent laryngeal nerve with superior cervical ganglion', [80, 90]],
                ['Inferior cervical cardiac branch of left recurrent laryngeal nerve', [75, 91]],
                ['Inferior cervical cardiac branch of left vagus nerve', [20, 92]],
                ['Thoracic cardiac branch of left vagus nerve', [24, 93]],
                # NA: Cardiac branch to deep cardiac
                # === lit.review flatmaps (Shoffstall, Pelot) ends here ===
                ['Branch of left vagus nerve to oesophageal nerve plexus', [25, 94]],
                ['Celiac branch of posterior vagal trunk', [35, 95]],
                ['Greater posterior gastric nerve', [36, 96, 97]],
                ['Pyloric branch of greater posterior gastric nerve', [96, 98]],
                ['Recurrent meningeal branch of left vagus nerve', [4, 99]],
                ['Left cardiac branch to deep cardiac nerve plexus', [24, 100]],
                ['Communicating branch of pharyngeal branch of left vagus nerve with superior cervical ganglion', [49, 101]]
            ]

        elif "Right vagus nerve (Jen)" in parameterSetName:
            outerPoints = [
                [[-11.9330, -70.1560, 1499.0570], [-3.0967, 0.6059, -0.5289], [0.3348, 1.9530, 0.2770],
                 [-1.5270, 0.3470, -0.9710], [0.3762, 0.2132, -1.9580], [-0.0590, -1.6520, -0.3160]],
                [[-15.1660, -69.3900, 1498.3610], [-3.0730, 1.3150, -1.4040], [0.8423, 1.7989, -0.1588],
                 [1.2800, -0.7190, 0.0230], [0.6423, -0.4632, -1.8398], [-0.6120, 0.4100, -0.1330]],
                [[-18.5340, -67.7180, 1497.8530], [-3.5580, 0.3360, -0.9530], [0.2449, 1.9660, -0.2210],
                 [1.2570, 5.5660, -1.2720], [0.4889, -0.2771, -1.9230], [0.5120, -0.9710, -6.7000]],
                [[-21.9650, -67.3070, 1497.4070], [-2.7280, -1.5310, -0.5360], [0.7629, -1.6510, 0.8330],
                 [4.0470, 4.3720, -3.8020], [-0.6791, 0.5858, 1.7830], [-1.7150, -1.8510, -6.9280]],
                # node 5
                [[-24.3650, -68.6320, 1496.9440],
                 [[-2.5778, -1.7319, 0.0320], [2.7618,-2.7995,-5.2685], [-0.4314, 14.2171, -4.6640]],
                 [[0.9082, -1.3299, 1.1870], [0.9082, -1.3299, 1.1870], [0.9082, -1.3299, 1.1870]],
                 [[1.1310, 0.2600, -0.3860], [1.1310, 0.2600, -0.3860], [1.1310, 0.2600, -0.3860]],
                 [[-0.6468, 0.9924, 1.6068], [-0.6468, 0.9924, 1.6068], [-0.6468, 0.9924, 1.6068]],
                 [[-0.4950, -1.0210, 0.4080], [-0.4950, -1.0210, 0.4080], [-0.4950, -1.0210, 0.4080]]],
                # node 6
                [[-26.5680, -70.9200, 1495.8550],
                 [[-2.1050, -1.8180, -2.1090], [-1.8273, 0.1175, -3.6751]],
                 [[1.5640, -1.0570, -0.6500], [1.5640, -1.0570, -0.6500]],
                 [[0.0840, 0.8040, -0.8880], [0.0840, 0.8040, -0.8880]],
                 [[-0.3013, -1.3422, 1.4577], [-0.3013, -1.3422, 1.4577]],
                 [[0.8930, -0.5790, -0.5630], [0.8930, -0.5790, -0.5630]]],
                # node 7
                [[-28.5950, -72.5380, 1493.5400],
                 [[-1.9520, 0.0480, -3.4289], [1.2766, 1.2432, -5.3466], [0.0462, -0.6298, -5.6761]],
                 [[1.7411, 0.0920, -0.9898], [1.7411, 0.0920, -0.9898], [1.7411, 0.0920, -0.9898]],
                 [[0.2620, 0.8070, 0.4350], [0.2620, 0.8070, 0.4350], [0.2620, 0.8070, 0.4350]],
                 [[0.0678, -1.9990, -0.0666], [0.0678, -1.9990, -0.0666], [0.0678, -1.9990, -0.0666]],
                 [[-0.4210, -0.0670, -1.3490], [-0.4210, -0.0670, -1.3490], [-0.4210, -0.0670, -1.3490]]],
                # node 8
                [[-30.5620, -73.0470, 1489.7290],
                 [[-1.2429, -0.5839, -3.9996], [-2.1563, 0.2746, 0.4176], [2.0378, -2.3778, -3.9020]],
                 [[1.9119, -0.0880, -0.5813], [1.9119, -0.0880, -0.5813], [1.9119, -0.0880, -0.5813]],
                 [[0.2750, 0.0090, 1.3310], [0.2750, 0.0090, 1.3310], [0.2750, 0.0090, 1.3310]],
                 [[-0.0030, -1.9800, 0.2900], [-0.0030, -1.9800, 0.2900], [-0.0030, -1.9800, 0.2900]],
                 [[-0.1580, -0.0300, -0.1620], [-0.1580, -0.0300, -0.1620], [-0.1580, -0.0300, -0.1620]]],
                [[-31.8430, -73.6810, 1485.9110], [-2.7880, -0.7630, -3.0760], [1.5029, -0.3150, -1.2841],
                 [-0.2310, -0.2210, -0.3150], [0.0025, -1.9400, 0.4789], [-0.2520, -0.0110, -0.2500]],
                [[-33.6300, -74.3470, 1482.0720], [-1.8062, -1.3811, -3.7753], [1.8220, -0.2400, -0.7839],
                 [0.1900, 0.1590, 0.3610], [0.0402, -1.8861, 0.6708], [0.0910, 0.0740, 0.3010]],
                [[-34.5330, -75.4320, 1477.8200], [-1.4180, -1.7170, -6.3281], [1.9571, -0.0659, -0.4207],
                 [-0.0680, -0.0620, -0.5310], [0.0454, -1.9310, 0.5138], [0.0450, 0.0490, 0.2190]],
                [[-36.1650, -77.5600, 1469.3230], [-0.6860, -1.6580, -8.7290], [1.9960, 0.0179, -0.1603],
                 [0.0300, 0.0840, 0.3010], [0.0475, -1.9699, 0.3704], [-0.0060, -0.0240, -0.1140]],
                [[-37.0570, -79.4500, 1460.6700], [-0.9490, -2.0830, -9.0162], [1.9880, 0.0129, -0.2122],
                 [0.0040, -0.0350, 0.0480], [0.0601, -1.9481, 0.4437], [0.0230, 0.0930, 0.3360]],
                [[-37.3710, -82.0730, 1451.3560], [0.9270, -2.0580, -10.0471], [1.9960, 0.0331, 0.1774],
                 [-0.0220, 0.0680, 0.2340], [-0.0032, -1.9630, 0.4018], [0.0140, -0.1090, -0.4960]],
                [[-36.3170, -84.4020, 1440.7770], [1.7709, -3.3959, -10.6596], [1.9780, 0.1159, 0.2917],
                 [-0.0080, 0.0220, -0.0250], [0.0216, -1.9049, 0.6104], [0.0320, -0.0580, -0.2550]],
                [[-34.5530, -86.3740, 1429.3400], [3.0881, -2.2751, -12.0133], [1.9401, 0.1269, 0.4747],
                 [-0.0640, -0.0520, 0.3000], [0.0353, -1.9650, 0.3812], [-0.0890, 0.0040, 0.1120]],
                [[-31.4460, -87.6000, 1416.3220], [2.9251, 0.3630, -11.4093], [1.9381, -0.0040, 0.4967],
                 [-0.0170, -0.1010, 0.0780], [0.0114, -1.9980, -0.0606], [-0.0770, 0.0150, -0.1020]],
                [[-28.9350, -87.2470, 1406.5550], [2.5799, 1.8510, -9.5757], [1.9390, -0.0740, 0.5081],
                 [-0.1820, 0.0130, 0.5290], [0.0229, -1.9680, -0.3742], [-0.0920, 0.0080, 0.0650]],
                [[-26.3180, -86.6770, 1396.8870], [1.1270, 1.4780, -12.1589], [1.9890, 0.0829, 0.1944],
                 [1.2390, -1.4390, -0.0480], [0.1053, -1.9820, -0.2312], [-0.4290, 0.0850, -0.8840]],
                [[-24.0090, -85.4520, 1382.6980], [0.7610, -3.2430, -11.3441], [3.2360, -2.8911, 1.0436],
                 [-0.1300, -0.3530, 0.8790], [-1.3690, -1.4190, 0.3138], [0.0090, 0.6480, 0.4470]],
                [[-23.3620, -86.7270, 1373.7570], [-1.4610, -2.9610, -8.8481], [2.3929, -0.8031, -0.1264],
                 [-0.6750, 1.8130, -0.3660], [-0.3332, -1.0570, 0.4088], [0.9160, -0.1230, 0.7090]],
                # node 22
                [[-23.5250, -89.7790, 1364.4900],
                 [[-1.1713, -5.1099, -15.2409], [3.2736, 0.1683, -11.4896]],
                 [[1.9690, 0.2646, -0.2400], [1.9690, 0.2646, -0.2400]],
                 [[-0.3820, -0.1080, -0.7480], [-0.3820, -0.1080, -0.7480]],
                 [[0.3256, -1.8748, 0.6036], [0.3256, -1.8748, 0.6036]],
                 [[0.0780, -0.4940, -0.2900], [0.0780, -0.4940, -0.2900]]],
                # node 23
                [[-22.4290, -93.9040, 1342.8140],
                 [[2.6235, 1.5216, -8.0582], [-4.4209, 2.0881, -1.3425], [3.4209, 5.0881, 1.3425]],
                 [[1.7877, -0.2689, 0.8605], [1.7877, -0.2689, 0.8605], [1.7877, -0.2689, 0.8605]],
                 [[-0.1820, 0.2400, 0.4410], [-0.1820, 0.2400, 0.4410], [-0.1820, 0.2400, 0.4410]],
                 [[-0.2377, -1.9862, -0.1270], [-0.2377, -1.9862, -0.1270], [-0.2377, -1.9862, -0.1270]],
                 [[0.3360, 0.3280, -2.8650], [0.3360, 0.3280, -2.8650], [0.3360, 0.3280, -2.8650]]],
                # node 24
                [[-15.3810, -83.3120, 1322.5750],
                 [[1.2897, 5.1605, -7.4745], [-3.8259,-9.7318,-12.5670], [3.5945,-5.3241,-15.4318]],
                 [[1.9470, 0.3927, -0.2459], [1.9470, 0.3927, -0.2459], [1.9470, 0.3927, -0.2459]],
                 [[0.2560, -0.0910, -0.8460], [0.2560, -0.0910, -0.8460], [0.2560, -0.0910, -0.8460]],
                 [[0.1910, -1.6471, -1.1179], [0.1910, -1.6471, -1.1179], [0.1910, -1.6471, -1.1179]],
                 [[-0.2740, -0.8230, 1.3390], [-0.2740, -0.8230, 1.3390], [-0.2740, -0.8230, 1.3390]]],
                # node 25
                [[-13.8579, -79.3161, 1311.6025],
                 [[0.9905, 4.4081, -12.6004], [-12.6446, -10.9879, -1.0703], [4.2813, -10.7567, -8.6762]],
                 [[1.9957, -0.0870, 0.1265], [1.9957, -0.0870, 0.1265], [1.9957, -0.0870, 0.1265]],
                 [[0.0400, -0.2550, 0.6020], [0.0400, -0.2550, 0.6020], [0.0400, -0.2550, 0.6020]],
                 [[-0.0402, -1.8867, -0.6632], [-0.0402, -1.8867, -0.6632], [-0.0402, -1.8867, -0.6632]],
                 [[-0.2250, 0.0160, -0.0980], [-0.2250, 0.0160, -0.0980], [-0.2250, 0.0160, -0.0980]]],
                # node 26
                [[-12.5080, -75.5580, 1297.4190],
                 [[0.5639, 4.0000, -11.9574], [-11.7317, 10.8921, 10.1764], [1.1566, 6.6489, -14.1297]],
                 [[1.9979, -0.1057, 0.0589], [1.9979, -0.1057, 0.0589], [1.9979, -0.1057, 0.0589]],
                 [[0.0400, -0.2550, 0.6020], [0.0400, -0.2550, 0.6020], [0.0400, -0.2550, 0.6020]],
                 [[-0.0814, -1.8942, -0.6375], [-0.0814, -1.8942, -0.6375], [-0.0814, -1.8942, -0.6375]],
                 [[-0.2250, 0.0160, -0.0980], [-0.2250, 0.0160, -0.0980], [-0.2250, 0.0160, -0.0980]]],
                # node 27
                [[-11.5080, -72.5580, 1287.4190],
                 [[1.8261, 3.3469, -9.0992], [-0.6605, 1.0168, -21.9033], [3.4030, 1.2979, -10.6624]],
                 [[1.9651, -0.0458, 0.3775], [1.9651, -0.0458, 0.3775], [1.9651, -0.0458, 0.3775]],
                 [[0.0400, -0.2550, 0.6020], [0.0400, -0.2550, 0.6020], [0.0400, -0.2550, 0.6020]],
                 [[0.0858, -1.8811, -0.6747], [0.0858, -1.8811, -0.6747], [0.0858, -1.8811, -0.6747]],
                 [[-0.2250, 0.0160, -0.0980], [-0.2250, 0.0160, -0.0980], [-0.2250, 0.0160, -0.0980]]],
                # node 28
                [[-10.0990, -69.8320, 1278.7190],
                 [[3.6105, 8.3689, -25.5474], [7.1929, -12.3601, 4.8043]],
                 [[-0.5359, 5.3321, 1.6710], [-0.5359, 5.3321, 1.6710]],
                 [[-0.1010, -0.2280, 0.5060], [-0.1010, -0.2280, 0.5060]],
                 [[1.9690, 0.1004, 0.3112], [1.9690, 0.1004, 0.3112]],
                 [[-0.0620, 0.0010, 0.0550], [-0.0620, 0.0010, 0.0550]]],
                [[-2.4900, -61.5860, 1235.2740], [1.3908, 0.5849, -38.5454], [1.9920, -0.0910, 0.0705],
                 [0.0280, 0.1510, -0.2710], [-0.0899, -1.9940, -0.0335], [0.0800, -0.0570, 0.9830]],
                [[-0.6830, -67.0610, 1203.9280], [-2.4770, -10.3190, -24.6840], [1.9960, -0.0431, -0.1823],
                 [-0.0200, -0.4160, -0.6730], [0.0304, -1.8478, 0.7694], [-0.1050, 0.1750, 0.4270]],
                [[-4.0630, -78.1020, 1185.9120], [-5.0851, -14.8734, -13.6864], [1.9291, -0.5217, -0.1498],
                 [-0.1580, -0.3380, -0.0810], [-0.2355, -1.3018, 1.5021], [0.0890, 0.5460, 0.4680]],
                [[-6.1060, -92.2070, 1172.1850], [5.9859, -13.5569, -14.9529], [1.9210, 0.3341, 0.4661],
                 [-0.3800, 0.7600, 1.2270], [-0.0628, -1.4949, 1.3302], [-0.1750, -0.3940, -0.4480]],
                # node 33
                [[0.9550, -104.6730, 1155.4800],
                 [[6.9862, -12.6883, -18.4944], [-11.3553, -6.4950, -12.7246]],
                 [[1.7640, -0.3171, 0.8839], [1.7640, -0.3171, 0.8839]],
                 [[-0.1610, -0.7130, 0.0410], [-0.1610, -0.7130, 0.0410]],
                 [[-0.7290, -1.6561, 0.8608], [-0.7290, -1.6561, 0.8608]],
                 [[-0.7680, 0.5040, 0.2670], [-0.7680, 0.5040, 0.2670]]],
                [[6.4440, -121.0200, 1137.4930], [5.5160, -13.6270, -14.0990], [1.4560, -0.6501, 1.1979],
                 [-0.2610, 0.1370, 0.4330], [-1.2568, -1.3379, 0.8015], [-0.1870, -0.0490, -0.3020]],
                [[11.7170, -133.0930, 1129.0270], [6.1912, -13.4394, -5.9732], [1.2151, -0.1402, 1.5749],
                 [0.0800, 0.3820, -0.0520], [-1.3859, -1.0713, 0.9739], [0.2440, -0.0900, 0.2190]],
                [[18.4430, -146.7640, 1123.7780], [4.7881, -12.2654, -3.1501], [1.5579, 0.2972, 1.2110],
                 [0.3720, -0.0780, -0.0360], [-1.0310, -0.7931, 1.5209], [-0.0330, 0.5390, 0.2690]],
                [[22.5070, -156.6210, 1121.3510], [4.8698, -9.0017, -1.9739], [1.6988, 0.5274, 1.7861],
                 [0.0410, 0.3570, -0.1810], [-1.1418, -0.9151, 1.3562], [-0.0010, 0.5740, 1.9810]],
                # node 38
                [[26.3640, -165.6170, 1120.4050],
                 [[5.8539, -6.5019, -2.1640], [-2.3876, 4.3531, -5.9170]],
                 [[1.5170, 1.2240, 0.4260], [1.5170, 1.2240, 0.4260]],
                 [[-0.6440, 1.0300, -1.1270], [-0.6440, 1.0300, -1.1270]],
                 [[-0.0315, -1.5045, 4.4352], [-0.0315, -1.5045, 4.4352]],
                 [[0.8370, -0.4390, 0.0390], [0.8370, -0.4390, 0.0390]]],
                [[31.3910, -171.9110, 1119.5460], [7.2892, -7.2172, -1.2610], [1.3669, 1.4291, -0.2780],
                 [-1.6120, 1.2410, -0.6450], [0.3693, 0.0293, 1.9669], [-0.2380, 1.1050, -1.3830]],
                [[42.7290, -177.0370, 1119.9160], [10.2890, -4.4640, -1.3210], [0.6769, 1.7600, -0.6750],
                 [-0.6480, 0.0170, -1.2370], [0.4731, 0.5363, 1.8729], [-0.0510, 1.2380, -0.1470]],
                [[52.4420, -178.8950, 1121.0780], [11.8290, -2.0450, 0.8670], [0.1202, -0.1500, -1.9940],
                 [-2.5910, -0.9530, -2.9480], [0.3240, 1.8240, -0.1177], [0.5550, 2.4640, -1.9680]],
                [[66.0320, -179.1300, 1118.5530], [9.3869, 3.1530, -4.6800], [1.0113, -1.2549, 1.1829],
                 [1.0170, 3.0100, -2.3180], [-0.1956, -1.4451, -1.3659], [0.9090, 1.7040, 1.9810]],
                [[72.6300, -177.7880, 1114.5210], [3.6279, 1.1160, -2.9269], [1.2102, -1.2019, 1.0418],
                 [-0.0940, -2.9070, 1.7810], [-0.4912, -1.5269, -1.1910], [-0.9180, -1.6900, -1.9640]],
                # ===== end of trunk =====
                # Meningeal branch of right vagus nerve
                [[-22.1444, -33.5139, 1488.0360], [-1.3678, 3.3758, -1.9364], [0.9082, -1.3299, 1.1870],
                 [1.1310, 0.2600, -0.3860], [-0.6468, 0.9924, 1.6068], [-0.4950, -1.0210, 0.4080]],
                # Communicating branch of right vagus nerve with right glossopharyngeal nerve
                [[-31.7319, -71.3429, 1488.1040], [-1.4445, 1.5427, -2.3678], [0.9082, -1.3299, 1.1870],
                 [1.1310, 0.2600, -0.3860], [-0.6468, 0.9924, 1.6068], [-0.4950, -1.0210, 0.4080]],
                # Auricular branch of right vagus nerve
                [[-33.9776, -72.8627, 1490.4112],
                 [[-2.8687, -1.3243, 1.8198], [-0.2136, -0.7729, -1.1655], [-4.2035, -2.6187, 3.7751]],
                 [[0.9082, -1.3299, 1.1870], [0.9082, -1.3299, 1.1870], [0.9082, -1.3299, 1.1870]],
                 [[1.1310, 0.2600, -0.3860], [1.1310, 0.2600, -0.3860], [1.1310, 0.2600, -0.3860]],
                 [[-0.6468, 0.9924, 1.6068], [-0.6468, 0.9924, 1.6068], [-0.6468, 0.9924, 1.6068]],
                 [[-0.4950, -1.0210, 0.4080], [-0.4950, -1.0210, 0.4080], [-0.4950, -1.0210, 0.4080]]],
                [[-44.2566, -86.6102, 1502.1724], [-4.7660, 1.4308, 0.2788], [0.9082, -1.3299, 1.1870],
                 [1.1310, 0.2600, -0.3860], [-0.6468, 0.9924, 1.6068], [-0.4950, -1.0210, 0.4080]],
                [[-65.5399, -79.7599, 1499.6229], [-4.0659, 3.4909, -1.3629], [0.9082, -1.3299, 1.1870],
                 [1.1310, 0.2600, -0.3860], [-0.6468, 0.9924, 1.6068], [-0.4950, -1.0210, 0.4080]],
                # Communicating branch of auricular branch of right vagus nerve with right posterior auricular nerve
                [[-34.1030, -73.7723, 1488.9116], [-0.7530, -2.6676, -3.5165], [0.9082, -1.3299, 1.1870],
                 [1.1310, 0.2600, -0.3860], [-0.6468, 0.9924, 1.6068], [-0.4950, -1.0210, 0.4080]],
                # Pharyngeal branch of right vagus nerve to pharyngeal nerve plexus
                [[-14.2395, -92.2317, 1451.6785],
                 [[7.9874, -1.0058, -3.0231], [5.2169, 0.1984, -6.4666], [1.8862, 3.1755, -5.6008]],
                 [[0.9082, -1.3299, 1.1870], [0.9082, -1.3299, 1.1870], [0.9082, -1.3299, 1.1870]],
                 [[1.1310, 0.2600, -0.3860], [1.1310, 0.2600, -0.3860], [1.1310, 0.2600, -0.3860]],
                 [[-0.6468, 0.9924, 1.6068], [-0.6468, 0.9924, 1.6068], [-0.6468, 0.9924, 1.6068]],
                 [[-0.4950, -1.0210, 0.4080], [-0.4950, -1.0210, 0.4080], [-0.4950, -1.0210, 0.4080]]],
                [[-0.4828, -89.1352, 1440.5015], [2.7068,0.2347,-1.3239], [0.9082, -1.3299, 1.1870],
                 [1.1310, 0.2600, -0.3860], [-0.6468, 0.9924, 1.6068], [-0.4950, -1.0210, 0.4080]],
                # Lingual branch of right vagus nerve
                [[-0.5421, -92.7409, 1439.0614], [3.6256, 0.1277, -4.5312], [0.9082, -1.3299, 1.1870],
                 [1.1310, 0.2600, -0.3860], [-0.6468, 0.9924, 1.6068], [-0.4950, -1.0210, 0.4080]],
                # Vagal branch to right carotid body
                [[-23.8143, -77.9044, 1483.7887],
                 [[-0.3413, -0.8168, -4.4901], [2.1322, -1.7917, -5.7626]],
                 [[0.9082, -1.3299, 1.1870], [0.9082, -1.3299, 1.1870]],
                 [[1.1310, 0.2600, -0.3860], [1.1310, 0.2600, -0.3860]],
                 [[-0.6468, 0.9924, 1.6068], [-0.6468, 0.9924, 1.6068]],
                 [[-0.4950, -1.0210, 0.4080], [-0.4950, -1.0210, 0.4080]]],
                [[-29.9918, -88.0597, 1410.7125], [1.8589, 0.0821, -5.9694], [0.9082, -1.3299, 1.1870],
                 [1.1310, 0.2600, -0.3860], [-0.6468, 0.9924, 1.6068], [-0.4950, -1.0210, 0.4080]],
                # Communicating branch of superior cervical ganglion with right vagus nerve
                [[-12.1696, -87.1200, 1440.5615], [-0.3878, -0.1822, -2.7406], [0.9082, -1.3299, 1.1870],
                 [1.1310, 0.2600, -0.3860], [-0.6468, 0.9924, 1.6068], [-0.4950, -1.0210, 0.4080]],
                # Right superior laryngeal nerve
                [[-27.0409, -84.5533, 1413.2634],
                 [[3.7670, -4.2878, -5.4732], [0.2471, -3.5608, -7.2638]],
                 [[0.9082, -1.3299, 1.1870], [0.9082, -1.3299, 1.1870]],
                 [[1.1310, 0.2600, -0.3860], [1.1310, 0.2600, -0.3860]],
                 [[-0.6468, 0.9924, 1.6068], [-0.6468, 0.9924, 1.6068]],
                 [[-0.4950, -1.0210, 0.4080], [-0.4950, -1.0210, 0.4080]]],
                # Right internal laryngeal nerve
                [[-7.4477, -97.3672, 1396.6904],
                 [[1.3141, -0.1163, -1.2024], [0.6875, -3.7874, 11.1195], [-2.3250, 1.3049, -0.0439]],
                 [[0.9082, -1.3299, 1.1870], [0.9082, -1.3299, 1.1870], [0.9082, -1.3299, 1.1870]],
                 [[1.1310, 0.2600, -0.3860], [1.1310, 0.2600, -0.3860], [1.1310, 0.2600, -0.3860]],
                 [[-0.6468, 0.9924, 1.6068], [-0.6468, 0.9924, 1.6068], [-0.6468, 0.9924, 1.6068]],
                 [[-0.4950, -1.0210, 0.4080], [-0.4950, -1.0210, 0.4080], [-0.4950, -1.0210, 0.4080]]],
                [[-6.0570, -97.3327, 1395.3406],
                 [[1.4365, 0.8063, -2.1395], [1.0835, -1.2291, 5.6215]],
                 [[0.9082, -1.3299, 1.1870], [0.9082, -1.3299, 1.1870]],
                 [[1.1310, 0.2600, -0.3860], [1.1310, 0.2600, -0.3860]],
                 [[-0.6468, 0.9924, 1.6068], [-0.6468, 0.9924, 1.6068]],
                 [[-0.4950, -1.0210, 0.4080], [-0.4950, -1.0210, 0.4080]]],
                # Right external laryngeal nerve
                [[-23.9526, -94.6998, 1406.3840],
                 [[4.2499, -1.4304, -6.1483], [-0.0846, 1.9919, -7.3417]],
                 [[0.9082, -1.3299, 1.1870], [0.9082, -1.3299, 1.1870]],
                 [[1.1310, 0.2600, -0.3860], [1.1310, 0.2600, -0.3860]],
                 [[-0.6468, 0.9924, 1.6068], [-0.6468, 0.9924, 1.6068]],
                 [[-0.4950, -1.0210, 0.4080], [-0.4950, -1.0210, 0.4080]]],
                [[-13.6401, -100.3235, 1398.2405], [2.7201, -4.0973, -1.6970], [0.9082, -1.3299, 1.1870],
                 [1.1310, 0.2600, -0.3860], [-0.6468, 0.9924, 1.6068], [-0.4950, -1.0210, 0.4080]],
                [[-11.3505, -109.1274, 1397.9287], [2.6814, -3.2101, -1.0240], [0.9082, -1.3299, 1.1870],
                 [1.1310, 0.2600, -0.3860], [-0.6468, 0.9924, 1.6068], [-0.4950, -1.0210, 0.4080]],
                # Superior ramus of right internal laryngeal nerve
                [[-0.6800, -112.5395, 1431.3417], [0.2336, -0.7792, 4.2956], [0.9082, -1.3299, 1.1870],
                 [1.1310, 0.2600, -0.3860], [-0.6468, 0.9924, 1.6068], [-0.4950, -1.0210, 0.4080]],
                # Middle ramus of right internal laryngeal nerve
                [[-0.6815, -113.0391, 1420.5067], [1.2498, 0.0316, 7.9522], [0.9082, -1.3299, 1.1870],
                 [1.1310, 0.2600, -0.3860], [-0.6468, 0.9924, 1.6068], [-0.4950, -1.0210, 0.4080]],
                # Inferior ramus of right internal laryngeal nerve
                [[-10.2406, -94.0103, 1398.1256],
                 [[2.4841, -3.0788, 2.2511], [-2.8825, 4.3236, -0.3708]],
                 [[0.9082, -1.3299, 1.1870], [0.9082, -1.3299, 1.1870]],
                 [[1.1310, 0.2600, -0.3860], [1.1310, 0.2600, -0.3860]],
                 [[-0.6468, 0.9924, 1.6068], [-0.6468, 0.9924, 1.6068]],
                 [[-0.4950, -1.0210, 0.4080], [-0.4950, -1.0210, 0.4080]]],
                [[-0.6957, -113.1037, 1409.8971], [2.7782, -1.2139, 2.4547], [0.9082, -1.3299, 1.1870],
                 [1.1310, 0.2600, -0.3860], [-0.6468, 0.9924, 1.6068], [-0.4950, -1.0210, 0.4080]],
                # Communicating branch of right internal laryngeal nerve with right recurrent laryngeal nerve
                [[-13.8866, -90.0086, 1398.6811], [-3.7135, -0.4671, 2.8166], [0.9082, -1.3299, 1.1870],
                 [1.1310, 0.2600, -0.3860], [-0.6468, 0.9924, 1.6068], [-0.4950, -1.0210, 0.4080]],
                # Communicating branch of right external laryngeal nerve with right superior cardiac nerve
                [[-24.2066, -94.8905, 1395.8497], [0.0883, -0.2380, -8.6768], [0.9082, -1.3299, 1.1870],
                 [1.1310, 0.2600, -0.3860], [-0.6468, 0.9924, 1.6068], [-0.4950, -1.0210, 0.4080]],
                # Cardiopulmonary branch A of right vagus nerve
                [[-20.1855, -138.8705, 1254.7068], [-1.8436, -8.5136, -10.3827], [0.9082, -1.3299, 1.1870],
                 [1.1310, 0.2600, -0.3860], [-0.6468, 0.9924, 1.6068], [-0.4950, -1.0210, 0.4080]],
                # Cardiopulmonary branch B of right vagus nerve
                [[-8.7655, -92.0825, 1294.0202], [0.0883, -0.2380, -8.6768], [0.9082, -1.3299, 1.1870],
                 [1.1310, 0.2600, -0.3860], [-0.6468, 0.9924, 1.6068], [-0.4950, -1.0210, 0.4080]],
                # Pulmonary branch A of right vagus nerve
                [[-59.0526, -117.8322, 1309.5348], [-7.0265, -3.8657, -0.7816], [0.9082, -1.3299, 1.1870],
                 [1.1310, 0.2600, -0.3860], [-0.6468, 0.9924, 1.6068], [-0.4950, -1.0210, 0.4080]],
                # Pulmonary branch B of right vagus nerve
                [[-6.9104, -95.5030, 1296.6562], [1.2696, -9.8832, -4.9091], [0.9082, -1.3299, 1.1870],
                 [1.1310, 0.2600, -0.3860], [-0.6468, 0.9924, 1.6068], [-0.4950, -1.0210, 0.4080]],
                # Pulmonary branch C of right vagus nerve
                [[-60.1316, -45.5255, 1314.4764], [-5.9485, 4.1157, 3.8990], [0.9082, -1.3299, 1.1870],
                 [1.1310, 0.2600, -0.3860], [-0.6468, 0.9924, 1.6068], [-0.4950, -1.0210, 0.4080]],
                # Pulmonary branch D of right vagus nerve
                [[-27.2479, -45.4445, 1225.1758], [0.6764, 3.9003, -8.8022], [0.9082, -1.3299, 1.1870],
                 [1.1310, 0.2600, -0.3860], [-0.6468, 0.9924, 1.6068], [-0.4950, -1.0210, 0.4080]],
                # Pulmonary branch E of right vagus nerve
                [[-34.5422, -48.0900, 1172.8458], [-2.5053, 3.5231, -16.7140], [0.9082, -1.3299, 1.1870],
                 [1.1310, 0.2600, -0.3860], [-0.6468, 0.9924, 1.6068], [-0.4950, -1.0210, 0.4080]],
                # Superior cervical cardiac branch of right vagus nerve
                [[0.3693, -92.7785, 1285.7139], [3.0457, 0.7998, -17.7702], [0.9082, -1.3299, 1.1870],
                 [1.1310, 0.2600, -0.3860], [-0.6468, 0.9924, 1.6068], [-0.4950, -1.0210, 0.4080]],
                # Right recurrent laryngeal nerve
                [[-27.1286, -90.7006, 1344.3919],
                 [[14.6914,-10.0465,11.2877], [5.7055,-4.3649,-6.4822]],
                 [[0.9082, -1.3299, 1.1870], [0.9082, -1.3299, 1.1870]],
                 [[1.1310, 0.2600, -0.3860], [1.1310, 0.2600, -0.3860]],
                 [[-0.6468, 0.9924, 1.6068], [-0.6468, 0.9924, 1.6068]],
                 [[-0.4950, -1.0210, 0.4080], [-0.4950, -1.0210, 0.4080]]],
                [[-11.8078, -101.8302, 1356.9242], [-0.1272,7.8288,13.3584], [0.9082, -1.3299, 1.1870],
                 [1.1310, 0.2600, -0.3860], [-0.6468, 0.9924, 1.6068], [-0.4950, -1.0210, 0.4080]],
                [[-13.5273, -95.0705, 1379.4589],
                 [[-1.7610,2.1082,6.2991], [1.0174,2.3948,-0.2418]],
                 [[0.9082, -1.3299, 1.1870], [0.9082, -1.3299, 1.1870]],
                 [[1.1310, 0.2600, -0.3860], [1.1310, 0.2600, -0.3860]],
                 [[-0.6468, 0.9924, 1.6068], [-0.6468, 0.9924, 1.6068]],
                 [[-0.4950, -1.0210, 0.4080], [-0.4950, -1.0210, 0.4080]]],
                [[-13.5931, -94.8626, 1390.0386],
                 [[1.5310,-0.1501,2.2554], [0.7202, 4.0612, 6.7217], [1.6457,-3.9320,-2.9385]],
                 [[0.9082, -1.3299, 1.1870], [0.9082, -1.3299, 1.1870], [0.9082, -1.3299, 1.1870]],
                 [[1.1310, 0.2600, -0.3860], [1.1310, 0.2600, -0.3860], [1.1310, 0.2600, -0.3860]],
                 [[-0.6468, 0.9924, 1.6068], [-0.6468, 0.9924, 1.6068], [-0.6468, 0.9924, 1.6068]],
                 [[-0.4950, -1.0210, 0.4080], [-0.4950, -1.0210, 0.4080], [-0.4950, -1.0210, 0.4080]]],
                [[-10.1346,-94.5269,1392.5007],
                  [[4.0683,0.1702,2.7227], [-1.3224,1.1650,2.3651], [-0.0059,0.7669,4.6239]],
                  [[0.9082,-1.3299,1.1870], [0.9082,-1.3299,1.1870], [-0.0832,0.0555,0.0000]],
                  [[1.1310,0.2600,-0.3860], [1.1310,0.2600,-0.3860], [0.0000,0.0000,0.0000]],
                  [[-0.6468,0.9924,1.6068], [-0.6468,0.9924,1.6068], [0.0000,0.0000,0.1000]],
                  [[-0.4950,-1.0210,0.4080], [-0.4950,-1.0210,0.4080], [0.0000,0.0000,0.0000]]],
                # Extra-laryngeal branch of right recurrent laryngeal nerve to larynx
                [[-12.4845, -89.8572, 1398.2492], [-0.1516, 2.9884, 4.3930], [0.9082, -1.3299, 1.1870],
                 [1.1310, 0.2600, -0.3860], [-0.6468, 0.9924, 1.6068], [-0.4950, -1.0210, 0.4080]],
                # Branch of right recurrent laryngeal nerve to muscle of larynx
                [[-12.3582, -91.7583, 1399.8844], [-0.7341,1.4625,4.3772], [0.9082, -1.3299, 1.1870],
                 [1.1310, 0.2600, -0.3860], [-0.6468, 0.9924, 1.6068], [-0.4950, -1.0210, 0.4080]],
                # Oesophageal branch of right recurrent laryngeal nerve
                [[-10.6000, -92.0904, 1381.4441], [4.0163,1.5028,3.7749], [0.9082, -1.3299, 1.1870],
                 [1.1310, 0.2600, -0.3860], [-0.6468, 0.9924, 1.6068], [-0.4950, -1.0210, 0.4080]],
                # Tracheal branch of right recurrent laryngeal nerve
                [[-11.2206, -99.4768, 1385.4265], [1.8506,-2.0153,-4.2530], [0.9082, -1.3299, 1.1870],
                 [1.1310, 0.2600, -0.3860], [-0.6468, 0.9924, 1.6068], [-0.4950, -1.0210, 0.4080]],
                # Right inferior laryngeal nerve
                [[-10.0449, -96.9982, 1393.1024],
                 [[-0.4179, 0.2646,-0.5122],[ 1.1148, 1.8728, 2.9545]],
                 [[0.9082, -1.3299, 1.1870], [0.9082, -1.3299, 1.1870]],
                 [[1.1310, 0.2600, -0.3860], [1.1310, 0.2600, -0.3860]],
                 [[-0.6468, 0.9924, 1.6068], [-0.6468, 0.9924, 1.6068]],
                 [[-0.4950, -1.0210, 0.4080], [-0.4950, -1.0210, 0.4080]]],
                [[-10.3784, -96.8413, 1393.7336],
                 [[2.5645, -0.8742, -1.0614], [-0.9326, 1.0389, 3.1367]],
                 [[0.9082, -1.3299, 1.1870], [0.9082, -1.3299, 1.1870]],
                 [[1.1310, 0.2600, -0.3860], [1.1310, 0.2600, -0.3860]],
                 [[-0.6468, 0.9924, 1.6068], [-0.6468, 0.9924, 1.6068]],
                 [[-0.4950, -1.0210, 0.4080], [-0.4950, -1.0210, 0.4080]]],
                # External branch of right inferior laryngeal nerve
                [[-7.8108, -92.8874, 1399.4857], [1.2521,1.7664,2.7335], [0.9082, -1.3299, 1.1870],
                 [1.1310, 0.2600, -0.3860], [-0.6468, 0.9924, 1.6068], [-0.4950, -1.0210, 0.4080]],
                # Anterior branch of right inferior laryngeal nerve
                [[-6.0304, -110.4032, 1397,7611], [3.9973,0.1813,-0.8623], [0.9082, -1.3299, 1.1870],
                 [1.1310, 0.2600, -0.3860], [-0.6468, 0.9924, 1.6068], [-0.4950, -1.0210, 0.4080]],
                # Posterior branch of right inferior laryngeal nerve
                [[-13.6526, -92.5799, 1406.6824], [-0.7612,2.0212,2.4662], [0.9082, -1.3299, 1.1870],
                 [1.1310, 0.2600, -0.3860], [-0.6468, 0.9924, 1.6068], [-0.4950, -1.0210, 0.4080]],
                # Communicating branch of right recurrent laryngeal nerve with superior cervical ganglion
                [[-9.7155, -86.2403, 1441.1216], [-0.7612, 2.0212, 2.4662], [0.9082, -1.3299, 1.1870],
                 [1.1310, 0.2600, -0.3860], [-0.6468, 0.9924, 1.6068], [-0.4950, -1.0210, 0.4080]],
                # Inferior cervical cardiac branch of right recurrent laryngeal nerve
                [[0.7866, -92.1826, 1287.8080], [-0.7612, 2.0212, 2.4662], [0.9082, -1.3299, 1.1870],
                 [1.1310, 0.2600, -0.3860], [-0.6468, 0.9924, 1.6068], [-0.4950, -1.0210, 0.4080]],
                # Inferior cervical cardiac branch of right vagus nerve
                [[0.8676, -92.7716, 1285.6213], [0.1546, -4.0101, -0.6152], [0.9082, -1.3299, 1.1870],
                 [1.1310, 0.2600, -0.3860], [-0.6468, 0.9924, 1.6068], [-0.4950, -1.0210, 0.4080]],
                # Thoracic cardiac branch of right vagus nerve
                [[0.7736, -92.7765, 1285.5797], [0.6035, -0.6233, -4.3442], [0.9082, -1.3299, 1.1870],
                [1.1310, 0.2600, -0.3860], [-0.6468, 0.9924, 1.6068], [-0.4950, -1.0210, 0.4080]],
                # Branch of right vagus nerve to oesophageal nerve plexus
                [[1.2031, -61.8129, 1252.7528], [0.7236, -0.4917, -5.4623], [0.9082, -1.3299, 1.1870],
                 [1.1310, 0.2600, -0.3860], [-0.6468, 0.9924, 1.6068], [-0.4950, -1.0210, 0.4080]],
                # Hepatic branch of anterior vagal trunk
                [[-37.2764, -135.7732,  1115.2733], [0.7236, -0.4917, -5.4623], [0.9082, -1.3299, 1.1870],
                 [1.1310, 0.2600, -0.3860], [-0.6468, 0.9924, 1.6068], [-0.4950, -1.0210, 0.4080]],
                # Greater anterior gastric nerve
                [[22.7701, -150.8457, 1101.8904],
                 [[-1.1587, -12.4860, -11.8280], [-6.2678, 4.1068, -6.6766]],
                 [[0.9082, -1.3299, 1.1870], [0.9082, -1.3299, 1.1870]],
                 [[1.1310, 0.2600, -0.3860], [1.1310, 0.2600, -0.3860]],
                 [[-0.6468, 0.9924, 1.6068], [-0.6468, 0.9924, 1.6068]],
                 [[-0.4950, -1.0210, 0.4080], [-0.4950, -1.0210, 0.4080]]],
                [[39.9622, -181.1921, 1096.8854], [3.1742, -11.8583, 4.9180], [0.9082, -1.3299, 1.1870],
                 [1.1310, 0.2600, -0.3860], [-0.6468, 0.9924, 1.6068], [-0.4950, -1.0210, 0.4080]],
                # Branch of greater anterior gastric nerve to coeliac nerve plexus
                [[7.8961, -132.9697, 1081.4835], [-7.1733, 8.8994, -2.0408], [0.9082, -1.3299, 1.1870],
                 [1.1310, 0.2600, -0.3860], [-0.6468, 0.9924, 1.6068], [-0.4950, -1.0210, 0.4080]],
                # Communicating branch of auricular branch of right vagus nerve with right facial nerve
                [[-52.0877, -81.5070, 1501.7519], [-10.9367, -5.8213, 3.1473], [0.9082, -1.3299, 1.1870],
                 [1.1310, 0.2600, -0.3860], [-0.6468, 0.9924, 1.6068], [-0.4950, -1.0210, 0.4080]],
                # Recurrent meningeal branch of right vagus nerve
                [[-27.0307, -37.7389, 1487.2719], [1.1450, 8.9687, -0.8818], [0.9082, -1.3299, 1.1870],
                 [1.1310, 0.2600, -0.3860], [-0.6468, 0.9924, 1.6068], [-0.4950, -1.0210, 0.4080]],
                # Right vagus trunk point - node 101
                [[-17.4290, -87.9040, 1332.8140],
                 [[2.5565, 2.9584, -7.2148], [2.8953, -1.2797, -10.8119]],
                 [[1.9690, 0.2646, -0.2400], [1.9690, 0.2646, -0.2400]],
                 [[-0.3820, -0.1080, -0.7480], [-0.3820, -0.1080, -0.7480]],
                 [[0.3256, -1.8748, 0.6036], [0.3256, -1.8748, 0.6036]],
                 [[0.0780, -0.4940, -0.2900], [0.0780, -0.4940, -0.2900]]],
                # Right cardiac branch to deep cardiac nerve plexus
                [[1.8271, -93.0516, 1287.5276], [1.9244, -1.4241, -6.7103], [0.9082, -1.3299, 1.1870],
                 [1.1310, 0.2600, -0.3860], [-0.6468, 0.9924, 1.6068], [-0.4950, -1.0210, 0.4080]],
                # Communicating branch of pharyngeal branch of right vagus nerve with superior cervical ganglion
                [[-11.7954, -87.0569, 1441.0299], [-0.1166, 2.4764, -6.3544], [0.9082, -1.3299, 1.1870],
                 [1.1310, 0.2600, -0.3860], [-0.6468, 0.9924, 1.6068], [-0.4950, -1.0210, 0.4080]],
            ]

            bifurcating_nodes = [5, 6, 7, 8, 22, 23, 24, 25, 26, 27, 28, 33, 38,
                                 46, 50, 53, 56, 57, 58, 59, 64, 76, 78, 79, 80, 85, 86, 96, 101]

            nodesByGroup = [
                ['right vagus X nerve trunk', [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
                                               21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38,
                                               39, 40, 41, 42, 43, 101]],
                ['Meningeal branch of right vagus nerve', [5, 44]],
                ['Communicating branch of right vagus nerve with right glossopharyngeal nerve', [6, 45]],
                ['Auricular branch of right vagus nerve', [8, 46, 47, 48]],
                ['Communicating branch of auricular branch of right vagus nerve with right facial nerve', [46, 99]],
                ['Communicating branch of auricular branch of right vagus nerve with right posterior auricular nerve', [46, 49]],
                ['Pharyngeal branch of right vagus nerve to pharyngeal nerve plexus', [8, 50, 51]],
                ['Lingual branch of right vagus nerve', [50, 52]],
                ['Branch of right vagus nerve to carotid body', [7, 53, 54]],
                ['Communicating branch of superior cervical ganglion with right vagus nerve', [53, 55]],
                ['Right superior laryngeal nerve', [7, 56]],
                ['Right internal laryngeal nerve', [56, 57, 58]],
                ['Right external laryngeal nerve', [56, 59, 60, 61]],
                ['Superior ramus of right internal laryngeal nerve', [57, 62]],
                ['Middle ramus of right internal laryngeal nerve', [58, 63]],
                ['Inferior ramus of right internal laryngeal nerve', [57, 64, 65]],
                ['Communicating branch of right internal laryngeal nerve with right recurrent laryngeal nerve', [64, 66]],
                ['Communicating branch of right external laryngeal nerve with right superior cardiac nerve', [59, 67]],
                ['Cardiopulmonary branch A of right vagus nerve', [24, 68]],
                ['Cardiopulmonary branch B of right vagus nerve', [24, 69]],
                ['Pulmonary branch A of right vagus nerve', [25, 70]],
                ['Pulmonary branch B of right vagus nerve', [25, 71]],
                ['Pulmonary branch C of right vagus nerve', [26, 72]],
                ['Pulmonary branch D of right vagus nerve', [26, 73]],
                ['Pulmonary branch E of right vagus nerve', [27, 74]],
                ['Superior cervical cardiac branch of right vagus nerve', [22, 75]],
                ['Right recurrent laryngeal nerve', [23, 76, 77, 78, 79, 80]],
                ['Extra-laryngeal branch of right recurrent laryngeal nerve to larynx', [79, 81]],
                ['Branch of right recurrent laryngeal nerve to muscle of larynx', [80, 82]],
                ['Oesophageal branch of right recurrent laryngeal nerve', [78, 83]],
                ['Tracheal branch of right recurrent laryngeal nerve', [79, 84]],
                ['Right inferior laryngeal nerve', [80, 85, 86]],
                ['External branch of right inferior laryngeal nerve', [85, 87]],
                ['Anterior branch of right inferior laryngeal nerve', [86, 88]],
                ['Posterior branch of right inferior laryngeal nerve', [86, 89]],
                ['Communicating branch of right recurrent laryngeal nerve with superior cervical ganglion', [80, 90]],
                ['Inferior cervical cardiac branch of right recurrent laryngeal nerve', [76, 91]],
                ['Inferior cervical cardiac branch of right vagus nerve', [28, 92]],
                ['Thoracic cardiac branch of right vagus nerve', [23, 93]],
                ['Branch of right vagus nerve to oesophageal nerve plexus', [27, 94]],
                ['Hepatic branch of anterior vagal trunk', [33, 95]],
                ['Greater anterior gastric nerve', [38, 96, 97]],
                ['Branch of greater anterior gastric nerve to coeliac nerve plexus', [96, 98]],
                ['Communicating branch of auricular branch of right vagus nerve with right facial nerve', [46, 99]],
                ['Recurrent meningeal branch of right vagus nerve', [5, 100]],
                ['Right cardiac branch to deep cardiac nerve plexus', [101, 102]],
                ['Communicating branch of pharyngeal branch of right vagus nerve with superior cervical ganglion', [50, 103]],
            ]

        elif "Right vagus nerve 1" in parameterSetName:
            outerPoints = [
                [[-11.933, -70.156, 1499.057], [-3.097, 0.606, -0.529], [0.335, 1.953, 0.277], [-1.527, 0.347, -0.971],
                 [0.376, 0.213, -1.958], [-0.059, -1.652, -0.316]],
                [[-15.166, -69.390, 1498.361], [-3.073, 1.315, -1.404], [0.842, 1.799, -0.159], [1.280, -0.719, 0.023],
                 [0.642, -0.463, -1.840], [-0.612, 0.410, -0.133]],
                [[-18.534, -67.718, 1497.853], [-3.558, 0.336, -0.953], [0.245, 1.966, -0.221], [1.257, 5.566, -1.272],
                 [0.489, -0.277, -1.923], [0.512, -0.971, -6.700]],
                [[-21.965, -67.307, 1497.407], [-2.728, -1.531, -0.536], [0.763, -1.651, 0.833], [4.047, 4.372, -3.802],
                 [-0.679, 0.586, 1.783], [-1.715, -1.851, -6.928]],
                [[-24.365, -68.632, 1496.944], [-2.578, -1.732, 0.032], [0.908, -1.330, 1.187], [1.131, 0.260, -0.386],
                 [-0.647, 0.992, 1.607], [-0.495, -1.021, 0.408]],
                [[-26.568, -70.920, 1495.855], [-2.105, -1.818, -2.109], [1.564, -1.057, -0.650],
                 [0.084, 0.804, -0.888], [-0.301, -1.342, 1.458], [0.893, -0.579, -0.563]],
                [[-28.595, -72.538, 1493.540], [-1.952, 0.048, -3.429], [1.741, 0.092, -0.990], [0.262, 0.807, 0.435],
                 [0.068, -1.999, -0.067], [-0.421, -0.067, -1.349]],
                [[-30.562, -73.047, 1489.729], [-1.243, -0.584, -4.000], [1.912, -0.088, -0.581], [0.275, 0.009, 1.331],
                 [-0.003, -1.980, 0.290], [-0.158, -0.030, -0.162]],
                [[-31.843, -73.681, 1485.911], [-2.788, -0.763, -3.076], [1.503, -0.315, -1.284],
                 [-0.231, -0.221, -0.315], [0.003, -1.940, 0.479], [-0.252, -0.011, -0.250]],
                [[-33.630, -74.347, 1482.072], [-1.806, -1.381, -3.775], [1.822, -0.240, -0.784], [0.190, 0.159, 0.361],
                 [0.040, -1.886, 0.671], [0.091, 0.074, 0.301]],
                [[-34.533, -75.432, 1477.820], [-1.418, -1.717, -6.328], [1.957, -0.066, -0.421],
                 [-0.068, -0.062, -0.531], [0.045, -1.931, 0.514], [0.045, 0.049, 0.219]],
                [[-36.165, -77.560, 1469.323], [-0.686, -1.658, -8.729], [1.996, 0.018, -0.160], [0.030, 0.084, 0.301],
                 [0.047, -1.970, 0.370], [-0.006, -0.024, -0.114]],
                [[-37.057, -79.450, 1460.670], [-0.949, -2.083, -9.016], [1.988, 0.013, -0.212], [0.004, -0.035, 0.048],
                 [0.060, -1.948, 0.444], [0.023, 0.093, 0.336]],
                [[-37.371, -82.073, 1451.356], [0.927, -2.058, -10.047], [1.996, 0.033, 0.177], [-0.022, 0.068, 0.234],
                 [-0.003, -1.963, 0.402], [0.014, -0.109, -0.496]],
                [[-36.317, -84.402, 1440.777], [1.771, -3.396, -10.660], [1.978, 0.116, 0.292], [-0.008, 0.022, -0.025],
                 [0.022, -1.905, 0.610], [0.032, -0.058, -0.255]],
                [[-34.553, -86.374, 1429.340], [3.088, -2.275, -12.013], [1.940, 0.127, 0.475], [-0.064, -0.052, 0.300],
                 [0.035, -1.965, 0.381], [-0.089, 0.004, 0.112]],
                [[-31.446, -87.600, 1416.322], [2.925, 0.363, -11.409], [1.938, -0.004, 0.497], [-0.017, -0.101, 0.078],
                 [0.011, -1.998, -0.061], [-0.077, 0.015, -0.102]],
                [[-28.935, -87.247, 1406.555], [2.580, 1.851, -9.576], [1.939, -0.074, 0.508], [-0.182, 0.013, 0.529],
                 [0.023, -1.968, -0.374], [-0.092, 0.008, 0.065]],
                [[-26.318, -86.677, 1396.887], [1.127, 1.478, -12.159], [1.989, 0.083, 0.194], [1.239, -1.439, -0.048],
                 [0.105, -1.982, -0.231], [-0.429, 0.085, -0.884]],
                [[-24.009, -85.452, 1382.698], [0.761, -3.243, -11.344], [3.236, -2.891, 1.044],
                 [-0.130, -0.353, 0.879], [-1.369, -1.419, 0.314], [0.009, 0.648, 0.447]],
                [[-23.362, -86.727, 1373.757], [-1.461, -2.961, -8.848], [2.393, -0.803, -0.126],
                 [-0.675, 1.813, -0.366], [-0.333, -1.057, 0.409], [0.916, -0.123, 0.709]],
                [[-23.525, -89.779, 1364.490], [-0.308, -4.922, -15.315], [1.974, 0.299, -0.136],
                 [-0.382, -0.108, -0.748], [0.325, -1.877, 0.597], [0.078, -0.494, -0.290]],
                [[-22.429, -93.904, 1342.814], [10.112, -0.809, -21.026], [1.784, -0.269, 0.868],
                 [-0.182, 0.240, 0.441], [-0.273, -1.985, -0.055], [0.336, 0.328, -2.865]],
                [[-15.381, -83.312, 1322.575], [11.245, 9.106, -20.974], [1.794, -0.264, 0.847],
                 [0.256, -0.091, -0.846], [0.085, -1.849, -0.757], [-0.274, -0.823, 1.339]],
                [[-12.508, -75.558, 1297.419], [[4.294, 7.870, -21.396], [-4.350, -5.007, -7.075]],
                 [[1.965, -0.046, 0.378], [1.253, -0.875, -0.151]], [[0.040, -0.255, 0.602], [0.253, -0.337, -0.899]],
                 [[0.086, -1.881, -0.675], [-0.730, -1.279, 1.354]],
                 [[-0.225, 0.016, -0.098], [-0.246, -0.870, -1.172]]],
                [[-10.099, -69.832, 1278.719], [4.309, 9.988, -30.490], [1.964, -0.303, 0.178], [-0.101, -0.228, 0.506],
                 [-0.231, -1.874, -0.647], [-0.062, 0.001, 0.055]],
                [[-2.490, -61.586, 1235.274], [1.391, 0.585, -38.551], [1.992, -0.091, 0.070], [0.028, 0.151, -0.271],
                 [-0.090, -1.994, -0.034], [0.080, -0.057, 0.983]],
                [[-0.683, -67.061, 1203.928], [-2.477, -10.319, -24.684], [1.996, -0.043, -0.182],
                 [-0.020, -0.416, -0.673], [0.030, -1.848, 0.769], [-0.105, 0.175, 0.427]],
                [[-4.063, -78.102, 1185.912], [-5.085, -14.873, -13.686], [1.929, -0.522, -0.150],
                 [-0.158, -0.338, -0.081], [-0.235, -1.302, 1.502], [0.089, 0.546, 0.468]],
                [[-6.106, -92.207, 1172.185], [5.986, -13.557, -14.953], [1.921, 0.334, 0.466], [-0.380, 0.760, 1.227],
                 [-0.063, -1.495, 1.330], [-0.175, -0.394, -0.448]],
                [[0.955, -104.673, 1155.480], [6.986, -12.688, -18.494], [1.764, -0.317, 0.884],
                 [-0.161, -0.713, 0.041], [-0.729, -1.656, 0.861], [-0.768, 0.504, 0.267]],
                [[6.444, -121.020, 1137.493], [5.516, -13.627, -14.099], [1.456, -0.650, 1.198], [-0.261, 0.137, 0.433],
                 [-1.257, -1.338, 0.801], [-0.187, -0.049, -0.302]],
                [[11.717, -133.093, 1129.027], [6.191, -13.439, -5.973], [1.215, -0.140, 1.575], [0.080, 0.382, -0.052],
                 [-1.386, -1.071, 0.974], [0.244, -0.090, 0.219]],
                [[18.443, -146.764, 1123.778], [4.788, -12.265, -3.150], [1.558, 0.297, 1.211], [0.372, -0.078, -0.036],
                 [-1.031, -0.793, 1.521], [-0.033, 0.539, 0.269]],
                [[22.507, -156.621, 1121.351], [4.870, -9.002, -1.974], [1.699, 0.527, 1.786], [0.041, 0.357, -0.181],
                 [-1.142, -0.915, 1.356], [-0.001, 0.574, 1.981]],
                [[26.364, -165.617, 1120.405], [[5.854, -6.502, -2.164], [4.915, -2.862, 9.936]],
                 [[1.517, 1.224, 0.426], [1.219, 1.573, -0.150]], [[-0.644, 1.030, -1.127], [0.619, -0.725, -0.048]],
                 [[-0.032, -1.505, 4.435], [-3.116, 2.634, 2.300]], [[0.837, -0.439, 0.039], [0.850, 2.118, -2.091]]],
                [[31.391, -171.911, 1119.546], [7.289, -7.217, -1.261], [1.367, 1.429, -0.278], [-1.612, 1.241, -0.645],
                 [0.369, 0.029, 1.967], [-0.238, 1.105, -1.383]],
                [[42.729, -177.037, 1119.916], [[10.289, -4.464, -1.321], [6.684, 4.098, 8.100]],
                 [[0.677, 1.760, -0.675], [0.361, 1.622, -1.119]], [[-0.648, 0.017, -1.237], [0.422, 0.013, 0.204]],
                 [[0.473, 0.536, 1.873], [-1.573, 0.924, 0.831]], [[-0.051, 1.238, -0.147], [-0.106, 0.546, 0.986]]],
                [[52.442, -178.895, 1121.078], [11.829, -2.045, 0.867], [0.120, -0.150, -1.994],
                 [-2.591, -0.953, -2.948], [0.324, 1.824, -0.118], [0.555, 2.464, -1.968]],
                [[66.032, -179.130, 1118.553], [9.387, 3.153, -4.680], [1.011, -1.255, 1.183], [1.017, 3.010, -2.318],
                 [-0.196, -1.445, -1.366], [0.909, 1.704, 1.981]],
                [[72.630, -177.788, 1114.521], [3.628, 1.116, -2.927], [1.210, -1.202, 1.042], [-0.094, -2.907, 1.781],
                 [-0.491, -1.527, -1.191], [-0.918, -1.690, -1.964]],
                [[-16.760, -79.638, 1290.726], [-3.965, -4.486, -5.535], [1.707, -0.915, -0.481],
                 [0.526, 0.109, -0.018], [-0.357, -1.393, 1.385], [0.568, 0.264, 0.456]],
                [[-20.477, -83.829, 1285.922], [[-6.996, -7.396, -8.563], [-8.359, -3.312, -11.370]],
                 [[1.967, -1.038, -0.710], [1.802, -1.088, -1.008]], [[0.041, -0.027, 0.233], [-1.625, -5.998, -9.083]],
                 [[-0.234, -1.402, 1.402], [-0.533, -1.706, 0.889]],
                 [[-0.378, -0.992, -1.217], [0.960, -7.967, 6.676]]],
                [[-22.855, -86.704, 1268.186], [8.257, 3.815, -23.443], [1.866, -0.378, 0.596], [-0.814, 1.711, 2.070],
                 [-0.262, -1.937, -0.408], [-0.297, -0.112, 0.047]],
                [[-33.437, -85.831, 1283.104], [-13.132, 2.537, 5.590], [0.783, 0.009, 1.835], [5.508, 1.802, -9.682],
                 [0.318, 1.965, -0.145], [2.524, -10.069, 0.627]],
                [[31.844, -165.523, 1129.780], [6.810, 2.318, 7.710], [0.817, 1.414, -1.147], [-1.037, 0.087, -0.854],
                 [-3.018, 3.140, 1.722], [-0.782, -0.823, 0.926]],
                [[39.797, -163.042, 1135.160], [[10.389, 0.790, 2.740], [5.943, 6.423, 12.965]],
                 [[-0.153, 1.989, 0.006], [-0.480, 1.814, -0.679]], [[1.192, 0.113, 0.818], [-0.545, -0.154, -0.088]],
                 [[-1.187, -0.105, 4.529], [-4.183, -0.328, 2.080]], [[0.972, -0.654, -0.232], [3.804, 0.889, 1.989]]],
                [[50.828, -163.561, 1138.034], [12.064, -0.945, 0.797], [0.198, 1.956, -0.684], [-0.311, 0.179, 0.266],
                 [-0.169, 1.560, 4.413], [1.221, -0.953, 0.494]],
                [[63.566, -164.194, 1139.084], [14.608, -0.004, 1.068], [-0.065, 1.781, 0.896], [-1.601, -0.507, 1.784],
                 [-0.305, -2.109, 4.170], [1.252, -3.695, -0.155]],
                [[78.127, -157.461, 1140.758], [13.318, 12.262, 2.927], [0.264, -0.726, 1.839], [5.020, -2.875, -1.615],
                 [3.159, -3.037, -1.652], [-0.017, 6.368, -14.246]],
                [[49.485, -156.288, 1144.496], [11.244, 5.767, 7.721], [-0.695, 1.835, -0.359], [-0.300, -0.108, 0.136],
                 [-1.888, -0.155, 2.864], [1.164, 0.079, 0.775]],
                [[61.197, -149.401, 1149.093], [11.373, 6.256, 5.180], [-0.843, 1.783, -0.302], [0.694, 0.429, 0.132],
                 [-1.868, -0.157, 4.291], [-4.388, -2.109, 1.285]],
                [[51.017, -173.758, 1126.972], [9.116, 3.233, 6.295], [0.165, 1.668, -1.096], [-0.609, 0.142, 0.104],
                 [-1.441, 1.132, 1.506], [0.229, -0.133, 0.316]],
                [[61.388, -170.170, 1130.150], [11.054, 3.810, -1.649], [-0.703, 1.760, -0.648], [-0.308, 0.143, 0.894],
                 [0.037, 0.705, 1.876], [2.376, -1.266, -0.218]],
            ]

            bifurcating_nodes = [25, 36, 38, 43, 47]

            nodesByGroup = [
                ['right vagus X nerve trunk', [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
                                              21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38,
                                              39, 40, 41]],
                ['pulmonary branch of right vagus nerve', [25, 42, 43]],
                ['right medial pulmonary branch of vagus nerve', [43, 44]],
                ['right lateral pulmonary branch of vagus nerve', [43, 45]],
                ['posterior A gastric branch of vagus nerve', [36, 46, 47, 48, 49, 50]],
                ['posterior B gastric branch of vagus nerve', [47, 51, 52]],
                ['posterior C gastric branch of vagus nerve', [38, 53, 54]]
            ]

        elif "Left vagus nerve 1" in parameterSetName:
            outerPoints = [[[10.900,-70.490,1499.510], [3.058,1.607,-2.565], [0.350,1.950,0.280], [1.530,-0.360,-0.370], [0.890,-0.410,1.750], [-2.080,1.850,1.180]],
                            [[15.210,-68.890,1497.320], [5.470,1.545,-1.738], [1.490,1.310,0.190], [0.760,-0.910,0.200], [-0.350,0.110,1.970], [-0.400,-0.820,-0.740]],
                            [[21.640,-67.580,1496.360], [7.078,-1.968,-2.119], [1.490,1.310,0.190], [0.760,-0.910,0.200], [-0.350,0.110,1.970], [-0.400,-0.820,-0.740]],
                            [[27.230,-73.040,1493.470], [4.913,-3.320,-5.768], [1.880,0.140,0.670], [0.210,-0.590,0.150], [0.040,-1.970,0.320], [0.170,-1.010,-0.750]],
                            [[30.430,-73.620,1486.260], [3.272,-1.026,-8.446], [1.880,0.140,0.670], [0.210,-0.590,0.150], [0.040,-1.970,0.320], [0.170,-1.010,-0.750]],
                            [[33.620,-75.160,1476.690], [2.810,-2.377,-10.701], [1.930,0.110,0.500], [0.060,-0.040,-0.220], [0.000,-1.960,0.420], [-0.020,0.020,0.100]],
                            [[35.880,-78.480,1464.950], [1.174,-2.874,-10.412], [1.990,0.060,0.230], [0.030,-0.060,-0.240], [-0.000,-1.930,0.530], [-0.000,0.010,0.030]],
                            [[36.190,-80.900,1455.970], [0.077,-2.012,-7.865], [2.000,0.000,0.020], [0.000,-0.040,-0.150], [-0.010,-1.940,0.490], [0.000,-0.010,-0.030]],
                            [[36.090,-82.530,1449.240], [-0.273,-1.468,-5.977], [2.000,-0.020,-0.090], [-0.010,-0.030,-0.140], [0.000,-1.940,0.480], [0.000,-0.010,-0.050]],
                            [[35.690,-83.830,1444.020], [-0.459,-0.978,-4.847], [1.980,-0.050,-0.260], [-0.010,-0.010,-0.130], [0.000,-1.960,0.410], [-0.000,-0.020,-0.110]],
                            [[35.190,-84.520,1439.570], [-1.535,-1.266,-9.722], [1.970,-0.050,-0.360], [-0.010,0.000,-0.090], [-0.000,-1.980,0.270], [-0.000,-0.020,-0.140]],
                            [[32.150,-86.090,1424.650], [-3.898,-1.195,-17.097], [1.960,-0.030,-0.410], [-0.010,0.010,-0.040], [-0.000,-2.000,0.140], [0.000,-0.010,-0.040]],
                            [[27.300,-86.750,1405.430], [-4.991,-2.075,-21.658], [1.950,-0.040,-0.440], [0.010,-0.000,0.100], [0.000,-1.990,0.190], [0.000,0.020,0.130]],
                            [[22.310,-90.520,1381.490], [-1.732,-6.353,-25.914], [2.000,-0.030,-0.130], [0.000,0.100,0.430], [0.000,-1.950,0.460], [-0.010,0.070,0.280]],
                            [[24.420,-99.580,1354.430], [3.271,-8.211,-23.148], [1.950,0.160,0.430], [-0.010,0.050,0.170], [-0.010,-1.850,0.760], [-0.000,0.020,0.060]],
                            [[28.380,-106.780,1335.240], [2.320,-5.265,-15.766], [1.980,0.090,0.280], [0.020,-0.080,-0.210], [-0.000,-1.900,0.630], [0.010,-0.050,-0.170]],
                            [[29.470,-110.340,1323.140], [0.149,-3.408,-15.340], [2.000,0.010,0.040], [0.010,-0.030,-0.220], [0.000,-1.950,0.440], [0.020,-0.050,-0.250]],
                            [[28.210,-113.130,1304.780], [-3.637,2.138,-20.620], [2.000,0.050,-0.140], [-0.030,0.120,-0.210], [0.060,-2.000,0.100], [-0.040,0.250,-0.880]],
                            [[22.080,-105.130,1283.990], [[-6.244,13.100,-18.015],[-0.718,13.905,-13.121]],
                             [[1.940,0.280,-0.400],[1.940,0.280,-0.400]],
                             [[-0.020,0.110,-0.080],[-0.020,0.110,-0.080]],
                             [[-0.110,-1.360,-1.460],[-0.110,-1.360,-1.460]],
                             [[-0.030,0.250,-0.700],[-0.030,0.250,-0.700]]],
                            [[16.200,-88.020,1270.070], [-4.734,14.710,-14.740], [1.960,0.270,-0.300], [0.030,-0.100,0.110], [-0.000,-1.480,-1.340], [0.060,-0.250,0.390]],
                            [[12.590,-75.800,1255.040], [-2.455,9.070,-17.173], [1.960,0.270,-0.300], [0.030,-0.100,0.110], [-0.000,-1.480,-1.340], [0.060,-0.250,0.390]],
                            [[11.390,-70.270,1236.640], [-0.968,2.075,-17.928], [1.960,0.270,-0.300], [0.030,-0.100,0.110], [-0.000,-1.480,-1.340], [0.060,-0.250,0.390]],
                            [[10.670,-71.290,1219.990], [-0.754,-4.029,-18.499], [2.000,-0.020,-0.100], [0.010,-0.010,0.120], [-0.000,-1.970,0.370], [0.010,0.030,0.750]],
                            [[9.920,-78.850,1200.330], [-0.604,-7.415,-17.005], [2.000,0.050,0.060], [-0.030,-0.040,-0.200], [0.020,-1.810,0.850], [-0.000,-0.010,-0.050]],
                            [[9.450,-85.880,1185.970], [-1.682,-5.454,-14.731], [2.000,0.050,0.060], [-0.030,-0.040,-0.200], [0.020,-1.810,0.850], [-0.000,-0.010,-0.050]],
                            [[6.620,-89.700,1171.150], [-3.136,-3.360,-15.171], [1.940,-0.080,-0.460], [-0.000,0.040,0.080], [-0.010,-1.970,0.320], [-0.010,0.040,0.080]],
                            [[3.180,-92.570,1155.680], [-1.953,-4.067,-14.129], [1.940,-0.080,-0.460], [-0.000,0.040,0.080], [-0.010,-1.970,0.320], [-0.010,0.040,0.080]],
                            [[2.540,-97.510,1143.140], [0.861,-6.135,-11.183], [1.990,0.120,0.210], [-0.140,0.070,0.790], [0.000,-1.740,0.990], [0.000,-0.020,-0.100]],
                            [[4.700,-104.460,1133.610], [3.004,-6.082,-9.175], [1.990,0.120,0.210], [-0.140,0.070,0.790], [0.000,-1.740,0.990], [0.000,-0.020,-0.100]],
                            [[8.400,-109.640,1124.940], [5.234,-3.868,-9.301], [1.990,0.120,0.210], [-0.140,0.070,0.790], [0.000,-1.740,0.990], [0.000,-0.020,-0.100]],
                            [[15.040,-111.850,1115.450], [7.442,1.216,-8.984], [1.660,0.070,1.110], [-0.230,-0.500,0.360], [-0.000,-2.000,0.130], [0.000,0.100,-1.090]],
                            [[22.470,-107.440,1107.910], [6.570,4.713,-6.419], [1.490,-0.740,1.100], [0.010,-0.390,-0.160], [0.000,-1.660,-1.120], [-0.000,0.280,-0.710]],
                            [[28.110,-102.670,1102.620], [5.393,3.779,-5.902], [1.490,-0.740,1.100], [0.010,-0.390,-0.160], [0.000,-1.660,-1.120], [-0.000,0.280,-0.710]],
                            [[33.150,-99.910,1096.270], [[4.630,1.720,-6.715],[9.276,20.368,-11.397],[8.794,-0.387,-13.708]],
                             [[1.630,-0.810,0.820],[1.630,-0.810,0.820],[1.630,-0.810,0.820]],
                             [[0.010,0.610,0.020],[0.010,0.610,0.020],[0.010,0.610,0.020]],
                             [[-0.000,-1.430,-1.400],[-0.000,-1.430,-1.400],[-0.000,-1.430,-1.400]],
                             [[-0.000,-0.020,0.890],[-0.000,-0.020,0.890],[-0.000,-0.020,0.890]]],
                            [[45.239,-93.595,1085.478], [7.044,-0.868,-7.462], [2.026,-0.129,1.495], [0.100,0.770,-0.270], [-0.000,-1.760,0.940], [0.000,0.350,1.570]],
                            [[54.360,-102.450,1077.350], [1.669,-10.067,-4.216], [1.790,0.810,0.350], [0.550,-0.430,-1.430], [0.000,-0.800,1.830], [0.000,1.570,0.210]],
                            [[23.330,-88.250,1275.900], [3.463,14.329,-4.449], [1.980,-0.050,-0.260], [-0.010,-0.010,-0.130], [0.000,-1.960,0.410], [-0.000,-0.020,-0.110]],
                            [[32.287,-79.285,1268.902], [[11.678,3.730,-9.609],[5.310,-2.835,-11.763],[7.040,5.114,-10.458]],
                             [[1.970,-0.050,-0.360],[1.970,-0.050,-0.360],[1.970,-0.050,-0.360]],
                             [[-0.010,0.000,-0.090],[-0.010,0.000,-0.090],[-0.010,0.000,-0.090]],
                             [[-0.000,-1.980,0.270],[-0.000,-1.980,0.270],[-0.000,-1.980,0.270]],
                             [[-0.000,-0.020,-0.140],[-0.000,-0.020,-0.140],[-0.000,-0.020,-0.140]]],
                            [[39.200,-80.300,1257.430], [9.220,1.186,-9.464], [1.960,-0.030,-0.410], [-0.010,0.010,-0.040], [-0.000,-2.000,0.140], [0.000,-0.010,-0.040]],
                            [[49.150,-77.930,1247.120], [11.111,4.117,-9.268], [1.960,-0.030,-0.410], [-0.010,0.010,-0.040], [-0.000,-2.000,0.140], [0.000,-0.010,-0.040]],
                            [[42.582,-77.775,1260.806], [5.396,-1.511,-1.137], [1.950,-0.040,-0.440], [0.010,-0.000,0.100], [0.000,-1.990,0.190], [0.000,0.020,0.130]],
                            [[52.020,-83.330,1261.290], [8.778,-8.775,5.301], [1.950,-0.040,-0.440], [0.010,-0.000,0.100], [0.000,-1.990,0.190], [0.000,0.020,0.130]],
                            [[39.570, -106.360, 1081.580], [[1.676, -6.540, -9.622], [-4.285, -3.707, -2.507]],
                             [[1.470, 0.640, 1.200], [1.470, 0.640, 1.200]],
                             [[0.100, 0.770, -0.270], [0.100, 0.770, -0.270]],
                             [[-0.000, -1.760, 0.940], [-0.000, -1.760, 0.940]],
                             [[0.000, 0.350, 1.570], [0.000, 0.350, 1.570]]],
                            [[45.981, -110.526, 1067.815], [8.047, 0.871, -12.742], [1.790, 0.810, 0.350], [0.550, -0.430, -1.430], [0.000, -0.800, 1.830], [0.000, 1.570, 0.210]],
                            [[39.021, -111.664, 1076.034], [1.344, -5.047, -5.083], [1.790, 0.810, 0.350], [0.550, -0.430, -1.430], [0.000, -0.800, 1.830], [0.000, 1.570, 0.210]],
                            [[38.728, -119.318, 1072.496], [-4.649, -7.186, 1.582], [1.790, 0.810, 0.350], [0.550, -0.430, -1.430], [0.000, -0.800, 1.830], [0.000, 1.570, 0.210]]]

            bifurcating_nodes = [19, 34, 38, 43]
            nodesByGroup = [
                ['left vagus X nerve trunk', [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
                                              21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 43, 44]],
                ['left A lateral pulmonary branch of vagus nerve', [43, 45, 46]],
                ['left A medial pulmonary branch of vagus nerve', [34, 35, 36]],
                ['left A thoracic cardiac branch of vagus nerve', [19, 37, 38, 41, 42]],
                ['left B thoracic cardiac branch of vagus nerve', [38, 39, 40]]
            ]

        elif "Left vagus nerve 2" in parameterSetName:
            outerPoints = [
                [[10.900, -70.490, 1499.510], [3.064, 1.610, -2.570], [-0.247, 1.802, 0.834], [1.904, 0.271, 0.361],
                 [1.389, -0.447, 1.376], [-0.118, -0.873, -0.187]],
                [[15.210, -68.890, 1497.320], [[5.462, 1.543, -1.736], [2.689, -4.177, -8.120]],
                 [[-0.061, 1.581, 1.212], [0.894, 1.687, -0.572]], [[-1.193, -0.508, 0.194], [-0.188, 0.017, 1.245]],
                 [[0.782, -1.104, 1.479], [1.700, -0.605, 0.874]], [[-0.677, -0.288, 0.165], [0.435, -0.971, -4.723]]],
                [[21.640, -67.580, 1496.360], [[7.059, -1.589, -2.461], [-1.297, -6.143, -5.533]],
                 [[0.603, 1.817, 0.556], [0.855, 1.102, -1.424]], [[3.770, -1.562, -0.400], [-1.512, 1.609, 1.573]],
                 [[0.472, -0.711, 1.813], [1.784, -0.790, 0.459]], [[-0.710, 0.404, 0.093], [-0.576, 1.416, -0.376]]],
                [[27.230, -73.040, 1493.470], [4.914, -3.321, -5.769], [1.600, 0.396, 1.135], [0.724, -0.838, -0.448],
                 [-0.179, -1.785, 0.875], [1.600, -1.998, -3.288]],
                [[30.430, -73.620, 1486.260], [[3.647, -1.670, -8.164], [-4.676, 2.544, -3.676]],
                 [[1.833, 0.160, 0.786], [1.207, 1.522, -0.482]], [[-0.032, -0.226, 0.233], [2.517, -2.911, -0.501]],
                 [[-0.000, -1.955, 0.400], [0.673, -1.031, -1.571]],
                 [[-0.109, -0.052, 0.802], [-3.161, 0.695, -0.364]]],
                [[33.608, -75.101, 1476.718], [2.812, -2.378, -10.706], [1.934, 0.107, 0.484], [0.066, -0.052, -0.257],
                 [-0.000, -1.957, 0.435], [-0.120, 0.115, 0.547]],
                [[35.880, -78.480, 1464.950], [[1.176, -2.880, -10.433], [-16.410, -14.557, -29.867]],
                 [[1.992, 0.054, 0.210], [1.796, -0.435, -0.775]], [[0.052, -0.111, -0.429], [0.508, 0.777, 1.081]],
                 [[-0.004, -1.929, 0.532], [-0.046, -1.788, 0.897]], [[0.019, -0.040, -0.135], [0.113, 0.125, 0.235]]],
                [[36.190, -80.900, 1455.970], [[0.077, -2.012, -7.865], [-0.901, -2.310, -1.040]],
                 [[2.000, -0.000, 0.020], [-1.496, 1.965, -3.070]], [[0.002, 0.018, 0.059], [17.557, 0.147, -4.345]],
                 [[-0.005, -1.939, 0.496], [1.725, -0.229, -0.987]],
                 [[0.003, -0.021, -0.087], [2.323, -3.445, 13.325]]],
                [[36.090, -82.530, 1449.240], [-0.273, -1.468, -5.977], [2.000, -0.019, -0.087],
                 [-0.008, -0.027, -0.138], [0.002, -1.941, 0.477], [0.012, 0.033, 0.131]],
                [[35.690, -83.830, 1444.020], [-0.459, -0.978, -4.847], [1.989, -0.034, -0.181], [0.029, 0.082, 0.365],
                 [0.002, -1.963, 0.396], [-0.006, -0.034, -0.126]],
                [[35.190, -84.520, 1439.570], [-1.535, -1.266, -9.722], [1.979, -0.043, -0.307],
                 [-0.028, 0.017, -0.106], [-0.003, -1.982, 0.259], [0.023, 0.013, 0.079]],
                [[32.150, -86.090, 1424.650], [-3.898, -1.195, -17.096], [1.953, -0.032, -0.443],
                 [-0.049, 0.002, -0.203], [-0.001, -2.000, 0.140], [-0.090, -0.017, -0.393]],
                [[27.300, -86.750, 1405.430], [[-4.991, -2.075, -21.658], [-12.360, 0.338, -0.352]],
                 [[1.949, -0.040, -0.445], [0.058, 0.051, -1.998]], [[-0.035, -0.023, -0.097], [-1.129, 0.604, 0.394]],
                 [[0.003, -1.990, 0.190], [-0.053, -1.998, -0.053]], [[0.037, 0.026, 0.326], [-0.953, -0.536, -1.464]]],
                [[22.310, -90.520, 1381.490], [-1.732, -6.353, -25.914], [2.000, -0.029, -0.127], [0.063, 0.229, 0.956],
                 [0.002, -1.946, 0.477], [0.011, 0.134, 0.524]],
                [[24.420, -99.580, 1354.430], [3.271, -8.211, -23.148], [1.986, 0.095, 0.247], [-0.038, 0.083, 0.273],
                 [0.007, -1.885, 0.670], [0.003, 0.013, 0.042]],
                [[28.380, -106.780, 1335.240], [2.320, -5.265, -15.766], [1.983, 0.084, 0.264], [0.065, -0.125, -0.302],
                 [-0.004, -1.899, 0.634], [0.012, -0.041, -0.110]],
                [[29.470, -110.340, 1323.140], [0.149, -3.408, -15.340], [2.000, 0.005, 0.018], [-0.005, 0.043, -0.169],
                 [0.001, -1.951, 0.433], [-0.008, 0.087, 0.200]],
                [[28.210, -113.130, 1304.780], [[-3.637, 2.138, -20.620], [-12.784, 7.847, -17.031]],
                 [[1.975, 0.071, -0.341], [1.655, 0.394, -1.061]], [[-0.118, 0.196, -0.597], [-0.517, -0.041, 2.653]],
                 [[0.035, -1.992, -0.213], [-0.071, -1.838, -0.794]],
                 [[-0.119, 0.144, -1.463], [5.424, -0.572, 3.445]]],
                [[22.080, -105.130, 1283.990], [[-6.244, 13.100, -18.015], [-0.787, 15.239, -14.380]],
                 [[1.926, 0.310, -0.442], [1.997, -0.015, -0.125]], [[0.019, 0.061, 0.122], [-0.115, 1.147, -1.434]],
                 [[-0.009, -1.618, -1.173], [-0.101, -1.372, -1.449]],
                 [[-0.356, 1.096, -1.336], [-0.325, 1.866, -1.521]]],
                [[16.200, -88.020, 1270.070], [-4.734, 14.710, -14.740], [1.951, 0.299, -0.329], [0.042, -0.099, 0.151],
                 [-0.020, -1.416, -1.407], [0.238, -0.695, 0.535]],
                [[12.590, -75.800, 1255.040], [-2.455, 9.070, -17.173], [1.983, 0.205, -0.175], [0.037, -0.121, 0.312],
                 [0.098, -1.757, -0.942], [0.173, -0.477, 0.907]],
                [[11.390, -70.270, 1236.640], [-0.968, 2.075, -17.928], [1.984, 0.246, -0.079], [0.009, -0.087, -0.156],
                 [0.234, -1.968, -0.240], [-0.049, -0.106, 0.616]],
                [[10.670, -71.290, 1219.990], [-0.754, -4.029, -18.499], [2.001, -0.015, -0.078],
                 [0.000, -0.119, 0.029], [0.002, -1.959, 0.427], [-0.098, 0.191, 0.724]],
                [[9.920, -78.850, 1200.330], [-0.604, -7.415, -17.005], [2.000, -0.006, -0.068], [-0.002, 0.094, 0.136],
                 [0.022, -1.833, 0.799], [-0.005, 0.129, 0.270]],
                [[9.450, -85.880, 1185.970], [-1.682, -5.454, -14.731], [1.990, -0.049, -0.209],
                 [-0.061, -0.188, -0.541], [0.026, -1.876, 0.692], [-0.053, -0.316, -0.801]],
                [[6.620, -89.700, 1171.150], [-3.136, -3.360, -15.171], [1.956, -0.064, -0.390],
                 [-0.031, 0.007, -0.113], [0.021, -1.949, 0.427], [-0.031, -0.035, -0.216]],
                [[3.180, -92.570, 1155.680], [-1.953, -4.067, -14.129], [1.977, -0.024, -0.266], [0.079, 0.101, 0.466],
                 [0.050, -1.919, 0.545], [0.062, 0.145, 0.585]],
                [[2.540, -97.510, 1143.140], [0.861, -6.135, -11.183], [2.000, 0.069, 0.116], [-0.032, 0.241, 0.504],
                 [0.005, -1.755, 0.963], [-0.078, 0.437, 0.751]],
                [[4.700, -104.460, 1133.610], [3.004, -6.082, -9.175], [1.934, 0.278, 0.449], [-0.034, -0.004, 0.155],
                 [-0.016, -1.671, 1.103], [0.100, -0.212, -0.274]],
                [[8.400, -109.640, 1124.940], [5.234, -3.868, -9.301], [1.779, 0.385, 0.841], [-0.254, -0.049, 0.552],
                 [0.029, -1.843, 0.783], [0.033, -0.182, -0.465]],
                [[15.040, -111.850, 1115.450], [7.442, 1.216, -8.984], [1.535, 0.048, 1.278], [-0.276, -0.663, 0.331],
                 [0.170, -1.993, -0.129], [0.790, 0.202, -1.871]],
                [[22.470, -107.440, 1107.910], [6.570, 4.713, -6.419], [1.538, -0.707, 1.055], [0.011, -0.268, -0.210],
                 [0.042, -1.634, -1.157], [-0.130, 0.248, -0.355]],
                [[28.110, -102.670, 1102.620], [5.393, 3.779, -5.902], [1.580, -0.681, 1.008], [0.043, -0.051, -0.100],
                 [-0.024, -1.676, -1.095], [-0.672, -0.430, 0.579]],
                [[33.150, -99.910, 1096.270],
                 [[4.630, 1.720, -6.715], [7.150, 15.699, -8.784], [9.921, -0.437, -15.464]],
                 [[1.588, -0.827, 0.883], [1.830, -0.475, 0.641], [1.525, -0.809, 1.001]],
                 [[-0.089, -0.260, -0.074], [-0.349, -1.022, 2.920], [0.458, 1.220, 0.579]],
                 [[-0.485, -1.774, -0.789], [0.305, -1.070, -1.663], [-0.707, -1.829, -0.402]],
                 [[0.029, 0.253, -0.446], [1.121, -0.173, 0.219], [-0.086, -0.563, 3.343]]],
                [[45.239, -93.595, 1085.478], [11.651, -1.436, -12.342], [1.826, -0.103, 1.736], [-0.213, 0.468, 0.272],
                 [-0.175, -1.987, 0.066], [-0.770, 0.034, 2.213]],
                [[54.360, -102.450, 1077.350], [2.223, -13.411, -5.616], [1.973, 0.274, 0.126], [0.356, -2.278, -4.988],
                 [-0.010, -0.773, 1.842], [2.928, -1.202, -0.482]],
                [[23.330, -88.250, 1275.900], [3.831, 15.852, -4.922], [1.928, -0.505, -0.127], [-0.418, -1.698, 1.100],
                 [-0.265, -0.530, -1.913], [-0.059, -0.464, 0.056]],
                [[32.287, -79.285, 1268.902],
                 [[9.823, 3.137, -8.082], [5.248, -2.802, -11.626], [7.739, 5.622, -11.497]],
                 [[1.308, -0.842, 1.262], [1.834, 0.231, 0.772], [1.699, -0.688, 0.807]],
                 [[2.146, 1.856, -0.419], [0.109, -0.816, -0.169], [-5.176, 10.836, 7.363]],
                 [[-0.217, -1.749, -0.942], [0.040, -1.938, 0.485], [-0.225, -1.720, -0.992]],
                 [[0.825, -1.334, 2.130], [-0.423, -0.029, -0.107], [11.373, -0.926, 5.859]]],
                [[39.200, -80.300, 1257.430], [9.770, 1.257, -10.029], [1.436, -0.314, 1.360], [-0.294, -0.568, 0.179],
                 [-0.103, -1.972, -0.347], [-0.113, 0.141, -0.811]],
                [[49.150, -77.930, 1247.120], [11.120, 4.120, -9.275], [1.328, -0.922, 1.182], [-0.170, -0.710, -0.365],
                 [-0.245, -1.693, -1.045], [-0.112, 0.433, -0.646]],
                [[42.582, -77.775, 1260.806], [11.777, -3.298, -2.481], [0.492, 1.925, -0.222], [2.006, -2.249, -1.967],
                 [0.441, 0.112, 1.946], [-2.412, 1.643, -1.599]],
                [[52.020, -83.330, 1261.290], [6.505, -6.503, 3.928], [1.474, 0.832, -1.064], [0.283, 1.656, -1.072],
                 [0.365, 1.271, 1.500], [2.315, 0.920, 1.296]],
                [[39.570, -106.360, 1081.580], [[2.405, -9.386, -13.810], [-5.193, -4.493, -3.038]],
                 [[1.975, 0.014, 0.334], [0.493, -1.446, 1.295]], [[-0.027, 0.596, -0.178], [6.542, -0.777, -3.568]],
                 [[-0.174, -1.658, 1.097], [-1.355, 0.694, 1.290]], [[0.913, -0.299, -0.389], [0.943, -11.695, 0.663]]],
                [[45.981, -110.526, 1067.815], [8.189, 0.886, -12.967], [1.512, 0.822, 1.011], [-0.494, 0.955, 0.159],
                 [0.753, -1.816, 0.351], [0.298, -0.005, -0.334]],
                [[39.021, -111.664, 1076.034], [1.568, -5.887, -5.929], [1.933, 0.495, 0.019], [-0.560, -0.081, -0.344],
                 [0.332, -1.353, 1.431], [-0.460, 1.100, 0.178]],
                [[38.728, -119.318, 1072.496], [-5.071, -7.838, 1.726], [1.535, -0.769, 1.017], [-1.382, -0.287, 2.451],
                 [-0.700, 0.823, 1.679], [-1.088, 5.058, -1.024]],
                [[35.804, -84.112, 1455.005], [-0.576, -3.983, -0.749], [1.953, -0.335, 0.277], [-5.200, -4.237, 1.154],
                 [-0.330, -0.318, 1.943], [-1.853, 0.769, -2.750]],
                [[31.975, -86.274, 1454.043], [[-4.275, -4.947, 1.487], [2.974, -6.657, -10.412]],
                 [[1.245, -1.048, 0.093], [1.124, 1.522, -0.652]], [[0.098, 0.191, 0.014], [0.119, -2.649, -1.545]],
                 [[0.201, 0.411, 1.943], [1.270, -0.614, 0.755]], [[0.867, 0.207, -0.285], [-0.022, 7.986, -7.800]]],
                [[24.305, -89.588, 1454.584], [-2.711, -6.152, -1.137], [1.819, -0.825, 0.126], [2.402, 1.612, 0.520],
                 [-0.251, -0.253, 1.964], [0.062, 0.840, -0.468]],
                [[21.528, -93.020, 1453.217], [[-0.263, -1.233, -5.029], [-8.435, -1.604, 1.821]],
                 [[1.555, -1.239, 0.222], [0.179, -1.318, -0.333]], [[0.802, 0.386, -0.707], [-1.454, -0.627, 1.820]],
                 [[-1.252, -1.494, 0.432], [0.487, -0.412, 1.891]], [[-2.207, -0.832, -5.501], [-1.622, 1.418, 0.824]]],
                [[34.223, -97.924, 1449.299], [-6.654, -9.589, -8.194], [-0.111, 1.343, -1.481],
                 [-1.102, 1.801, -0.597], [1.402, -0.497, -0.556], [-0.093, -4.240, 4.939]],
                [[26.920, -110.058, 1444.870], [-11.705, -9.920, -3.813], [1.330, -1.475, -0.246],
                 [2.392, -9.039, 11.711], [-0.559, -1.395, 5.346], [-5.784, -1.116, 8.776]],
                [[19.543, -92.025, 1448.644], [[-4.977, -0.046, -3.476], [0.047, -0.110, -3.765]],
                 [[0.514, -1.798, -0.713], [1.324, 1.500, -0.027]], [[1.154, -0.049, 0.712], [3.380, -3.318, 2.199]],
                 [[-1.021, -0.876, 1.474], [1.496, -1.319, 0.057]], [[2.259, -0.758, 1.178], [-3.476, -3.711, -0.740]]],
                [[14.362, -93.463, 1452.618], [-4.823, -3.414, -0.601], [1.167, -1.614, -0.196], [0.671, 0.048, -1.136],
                 [-0.056, -0.308, 2.202], [0.016, -1.081, 0.139]],
                [[10.351, -93.689, 1450.914], [-2.952, -0.339, -0.891], [0.612, -0.491, -1.841],
                 [-1.546, 1.610, -0.274], [0.059, -1.887, 0.523], [6.470, -1.805, -2.289]],
                [[13.944, -92.924, 1444.915], [-5.905, -1.040, -4.332], [1.185, -0.718, -1.443],
                 [-0.610, -1.873, -0.780], [-0.217, -1.841, 0.738], [2.547, -0.522, 2.172]],
                [[7.113, -96.642, 1443.793], [-7.469, -4.071, -1.296], [0.308, -1.113, 1.722], [-4.915, 5.845, 7.174],
                 [-0.945, 1.394, 1.070], [-8.071, 5.747, -6.963]],
                [[19.719, -92.086, 1444.022], [-0.865, -0.016, -5.446], [1.805, -0.814, -0.284],
                 [-0.622, -0.588, -0.570], [-0.801, -1.822, 0.133], [-0.568, 0.588, 1.399]],
                [[17.076, -92.902, 1438.419], [-5.409, -0.084, -4.845], [1.292, -0.530, -1.434],
                 [-0.986, 1.284, -1.772], [-0.336, -1.924, 0.408], [0.038, -1.146, -2.648]],
                [[22.950, -93.181, 1442.954], [-12.520, -10.500, -14.707], [1.645, -0.628, -0.952],
                 [-0.593, -0.705, -0.589], [0.035, -1.640, 1.142], [0.134, 0.282, 0.453]],
                [[13.405, -101.847, 1436.890], [-5.955, -2.558, -2.397], [1.015, -1.194, -1.247],
                 [-0.393, -0.241, -0.058], [0.047, -1.424, 1.402], [-3.157, -2.203, -0.998]],
                [[11.430, -105.753, 1294.243], [-20.116, 5.885, 0.049], [0.475, 1.632, -1.061], [-2.094, 1.832, -1.186],
                 [-0.301, -1.016, -1.698], [-5.116, 3.855, -1.751]],
                [[1.899, -97.340, 1307.104], [2.762, -0.537, 15.730], [1.857, -0.951, -0.359], [-2.253, -2.273, -4.196],
                 [0.896, 1.786, -0.096], [-2.686, -0.745, -0.662]],
                [[5.630, -96.081, 1318.236], [[3.384, 2.172, 13.158], [-2.442, -9.203, -5.833]],
                 [[1.842, -0.997, -0.309], [1.815, -0.885, 0.637]], [[0.209, 0.131, 0.647], [-3.079, -3.950, 0.338]],
                 [[0.855, 1.737, -0.507], [-0.933, -0.765, 1.597]], [[0.218, -0.020, 0.141], [0.283, 1.413, -0.069]]],
                [[9.366, -91.605, 1332.729], [1.968, 4.629, 11.857], [1.876, -0.979, 0.071], [-0.003, 1.712, 2.548],
                 [0.876, 1.622, -0.779], [0.347, -0.517, -0.524]],
                [[-4.549, -100.091, 1319.167], [-10.926, 0.955, 7.843], [0.694, -1.626, 1.165],
                 [-2.309, -1.236, -0.055], [0.972, 1.274, 1.199], [2.137, 1.031, -1.051]],
                [[-10.290, -91.027, 1325.625], [11.032, 10.709, 3.642], [1.338, -1.555, 0.520], [4.470, -7.531, -9.879],
                 [0.673, -0.052, -1.886], [-6.997, -1.209, -1.441]],
                [[9.123, -86.197, 1341.031], [[3.738, 6.066, 16.082], [-1.981, 11.269, -1.547]],
                 [[1.832, -1.182, 0.020], [1.658, 0.111, -1.312]], [[-0.633, -0.914, -0.165], [-8.241, -1.131, -3.349]],
                 [[0.998, 1.534, -0.811], [-1.196, -0.423, -1.548]], [[-1.339, 1.096, 4.023], [-0.672, 9.560, 22.028]]],
                [[8.883, -76.652, 1336.542], [-8.363, 6.132, -2.114], [-1.280, -1.673, 0.210], [2.286, -2.780, 5.753],
                 [-0.433, 0.859, 4.204], [-0.968, -4.075, -0.192]],
                [[2.238, -95.566, 1397.703], [[-0.952, -20.894, 10.117], [-1.315, 2.461, 12.704]],
                 [[2.434, -1.583, -3.040], [1.963, -2.507, 0.689]], [[-0.668, -0.556, -6.609], [-0.163, 2.046, 1.387]],
                 [[1.630, 0.445, 1.073], [1.584, 1.221, -0.072]], [[1.607, -2.254, 2.713], [1.294, 4.674, 2.405]]],
                [[-2.831, -103.202, 1403.384], [0.358, 0.026, -0.088], [0.989, -2.224, 3.355], [-2.837, 15.423, 23.906],
                 [-0.140, -1.682, -1.074], [-4.047, 3.542, -12.444]],
                [[-1.650, -97.506, 1409.467], [-0.094, -8.016, 10.243], [2.115, -0.087, -0.049],
                 [-0.695, 3.654, -2.188], [0.287, 4.844, 3.794], [-3.195, -0.140, 8.128]],
                [[-0.456, -75.917, 1335.936], [-7.226, -6.348, 0.235], [1.397, -1.590, 0.008], [-0.876, 0.399, -5.515],
                 [0.032, 0.038, 2.000], [-2.843, 0.828, -3.455]],
                [[2.430, -90.847, 1364.054], [2.905, -2.801, 29.782], [2.057, -0.437, -0.242], [1.144, 1.436, -1.841],
                 [0.431, 1.950, 0.141], [0.739, 0.321, -1.550]],
                [[15.511, -86.921, 1401.966], [-8.513, 1.418, -9.694], [1.507, 0.073, -1.312], [0.581, -0.730, 0.561],
                 [-0.089, -1.986, -0.213], [1.777, 0.395, 0.901]],
                [[8.746, -89.793, 1391.518], [-3.428, 1.419, -19.786], [1.969, -0.047, -0.345], [-0.004, -0.060, 1.110],
                 [-0.071, -1.994, -0.131], [-0.162, -0.147, -0.888]],
                [[8.983, -91.907, 1364.836], [7.097, 0.518, -30.649], [1.947, -0.060, 0.450], [-0.218, 0.222, 0.814],
                 [-0.051, -1.998, -0.046], [-0.447, 0.217, 0.737]],
                [[13.525, -96.489, 1330.038], [-5.839, 8.309, -39.141], [1.974, -0.069, -0.309],
                 [-0.231, -0.256, -2.744], [-0.130, -1.955, -0.396], [0.220, -0.094, -3.755]],
                [[12.340, -76.224, 1483.540], [-4.729, -17.330, -14.359], [-0.018, 1.274, -1.532],
                 [-1.296, -0.227, -0.405], [1.962, -0.306, -0.277], [0.301, 0.603, -0.892]],
                [[-1.017, -97.928, 1470.130], [-22.737, -28.512, 0.734], [-1.551, 1.231, -0.222],
                 [-0.440, 0.475, 4.300], [0.150, -0.171, -1.992], [-5.482, -0.294, -0.826]],
                [[18.707, -75.125, 1484.548], [-9.962, -10.481, -14.726], [-0.204, 1.678, -1.057],
                 [-0.468, 1.333, 0.881], [1.743, -0.367, -0.918], [0.746, 0.079, -1.002]],
                [[4.075, -89.317, 1469.104], [-20.306, -25.862, 1.334], [-1.059, 0.905, 1.426], [4.014, -3.265, 6.956],
                 [-1.164, 0.841, -1.398], [-10.156, -0.307, 4.550]],
                [[26.644, -71.020, 1480.334], [-4.180, -1.972, -7.776], [1.774, -0.277, -0.883], [0.248, -1.588, 0.798],
                 [-0.044, -1.878, 0.500], [-0.068, 0.395, 2.845]],
                [[21.103, -75.701, 1473.247], [-11.169, -9.328, -8.079], [1.359, -1.456, -0.197],
                 [-0.147, -0.308, 1.202], [-0.595, -0.790, 1.734], [-0.861, 0.888, 0.042]],
                [[5.148, -89.911, 1466.179], [-23.689, -17.031, 2.272], [0.971, -1.179, 1.293], [-0.247, 1.662, 1.934],
                 [-0.659, 1.119, 1.515], [1.174, 2.726, -1.387]],
            ]

            bifurcating_nodes = [2, 3, 5, 7, 8, 13, 18, 19, 34, 38, 43, 48, 50, 53, 64, 68, 70]

            nodesByGroup = [
                ['left vagus X nerve trunk', [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
                                              21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 43, 44]],
                ['left A lateral pulmonary branch of vagus nerve', [19, 37, 38, 41, 42]],
                ['ILX:0794289', [19, 37, 38, 41, 42]],
                ['left B lateral pulmonary branch of vagus nerve', [38, 39, 40]],
                ['ILX:0794290', [38, 39, 40]],
                ['posterior A gastric branch of vagus nerve', [43, 45, 46]],
                ['ILX:0794398', [43, 45, 46]],
                ['posterior B gastric branch of vagus nerve', [34, 35, 36]],
                ['ILX:0794399', [34, 35, 36]],
                # superior laryngeal nerve network
                ['left superior laryngeal nerve', [8, 47, 48]],
                ['FMA:53536', [8, 47, 48]],
                ['ILX:0788780', [8, 47, 48]],
                ['left internal branch of superior laryngeal nerve', [48, 49, 50, 53]],
                ['FMA:53540', [48, 49, 50, 53]],
                ['ILX:0791167', [48, 49, 50, 53]],
                ['left superior/upper ramus of Internal branch of L Superior laryngeal nerve', [50, 54, 55]], # not in scicrunch
                ['left middle ramus of Internal branch of L Superior laryngeal nerve', [53, 56, 57]], # not in scicrunch
                ['left inferior ramus of Internal branch of L Superior laryngeal nerve', [53, 58, 59]], # not in scicrunch
                ['left external branch of superior laryngeal nerve', [48, 51, 52]],
                ['FMA:53538', [48, 51, 52]],
                ['	ILX:0789760', [48, 51, 52]],
                # branch to carotid body
                ['left branch of vagus nerve to ipsilateral carotid body', [7, 60, 61]],
                ['FMA:53607', [7, 60, 61]],
                ['ILX:0791085', [7, 69, 61]],
                # recurrent laryngeal nerve network
                ['left recurrent laryngeal nerve', [18, 62, 63, 64, 65, 68, 70, 74]],
                ['ILX:0794226', [18, 62, 63, 64, 65, 68, 70, 74]],
                ['tracheal branch of left recurrent laryngeal nerve', [64, 66, 67]],
                ['FMA:53611', [64, 66, 67]],
                ['ILX:0785091', [64, 66, 67]],
                ['esophageal branch of left recurrent laryngeal nerve', [68, 69, 73]],
                ['FMA:53609', [68, 69, 73]],
                ['ILX:0791513', [68, 69, 73]],
                ['branch of recurrent laryngeal nerve to muscle of larynx', [70, 71]], # note! no left / right terminology
                ['FMA:6250', [70, 71]],
                ['ILX:0791463', [70, 71]],
                ['extra-laryngeal branch of recurrent laryngeal nerve to larynx', [70, 72]], # note! no left / right terminology
                ['FMA:6710', [70, 72]],
                ['ILX:0792328', [70, 72]],
                # cardiac branches
                ['Superior cervical cardiac branch of left vagus nerve', [13, 75, 76, 77, 78]],
                ['FMA:53599', [13, 75, 76, 77, 78]],
                ['ILX:0791998', [13, 75, 76, 77, 78]],
                # upper branches - medulla level
                ['Left glossopharyngeal nerve', [2, 79, 80]],
                ['FMA:50894', [2, 79, 80]],
                ['ILX:0789473', [2, 79, 80]],
                ['left auricular branch of left vagus nerve', [3, 81, 82]],
                ['FMA:53535', [3, 81, 82]],
                ['ILX:0789344', [3, 81, 82]],
                ['left pharyngeal branch of vagus nerve', [5, 83, 84, 85]],
                ['ILX:0793988', [5, 83, 84, 85]],
            ]

        elif "Left vagus nerve trunk 1" in parameterSetName:
            outerPoints = [
                [[10.9000, -70.4900, 1499.5100], [3.0580, 1.6070, -2.5650], [0.3500, 1.9500, 0.2800],
                 [1.5300, -0.3600, -0.3700], [0.8900, -0.4100, 1.7500], [-2.0800, 1.8500, 1.1800]],
                [[15.2100, -68.8900, 1497.3200], [5.4700, 1.5450, -1.7380], [1.4900, 1.3100, 0.1900],
                 [0.7600, -0.9100, 0.2000], [-0.3500, 0.1100, 1.9700], [-0.4000, -0.8200, -0.7400]],
                [[21.6400, -67.5800, 1496.3600], [4.2974, -4.1607, 0.0965], [1.4900, 1.3100, 0.1900],
                 [0.7600, -0.9100, 0.2000], [-0.3500, 0.1100, 1.9700], [-0.4000, -0.8200, -0.7400]],
                [[27.2300, -73.0400, 1493.4700], [3.6994, -1.1316, -5.2353], [1.4987, 0.4126, 1.2596],
                 [0.2100, -0.5900, 0.1500], [-0.1349, -1.8397, 0.7632], [0.1700, -1.0100, -0.7500]],
                [[28.2300, -73.3400, 1489.4700], [2.0523, 0.4427, -2.1600], [1.4987, 0.4126, 1.2596],
                 [0.2100, -0.5900, 0.1500], [-0.1349, -1.8397, 0.7632], [0.1700, -1.0100, -0.7500]],
                [[30.4300, -73.6200, 1486.2600], [0.2056, -0.5519, -4.2457], [1.8800, 0.1400, 0.6700],
                 [0.2100, -0.5900, 0.1500], [0.0400, -1.9700, 0.3200], [0.1700, -1.0100, -0.7500]],
                [[31.9300, -74.3200, 1481.2600], [0.5408, -0.8766, -5.5422], [1.8800, 0.1400, 0.6700],
                 [0.2100, -0.5900, 0.1500], [0.0400, -1.9700, 0.3200], [0.1700, -1.0100, -0.7500]],
                [[33.6200, -75.1600, 1476.6900], [2.8100, -2.3770, -10.7010], [1.9300, 0.1100, 0.5000],
                 [0.0600, -0.0400, -0.2200], [0.0000, -1.9600, 0.4200], [-0.0200, 0.0200, 0.1000]],
                [[35.8800, -78.4800, 1464.9500], [1.1740, -2.8740, -10.4120], [1.9900, 0.0600, 0.2300],
                 [0.0300, -0.0600, -0.2400], [-0.0000, -1.9300, 0.5300], [-0.0000, 0.0100, 0.0300]],
                [[36.1900, -80.9000, 1455.9700], [0.0770, -2.0120, -7.8650], [2.0000, 0.0000, 0.0200],
                 [0.0000, -0.0400, -0.1500], [-0.0100, -1.9400, 0.4900], [0.0000, -0.0100, -0.0300]],
                [[36.0900, -82.5300, 1449.2400], [-0.2730, -1.4680, -5.9770], [2.0000, -0.0200, -0.0900],
                 [-0.0100, -0.0300, -0.1400], [0.0000, -1.9400, 0.4800], [0.0000, -0.0100, -0.0500]],
                [[35.6900, -83.8300, 1444.0200], [-0.4590, -0.9780, -4.8470], [1.9800, -0.0500, -0.2600],
                 [-0.0100, -0.0100, -0.1300], [0.0000, -1.9600, 0.4100], [-0.0000, -0.0200, -0.1100]],
                [[34.6278, -85.2821, 1435.2964], [-1.3088, -0.8844, -6.6046], [1.9700, -0.0500, -0.3600],
                 [-0.0100, 0.0000, -0.0900], [-0.0000, -1.9800, 0.2700], [-0.0000, -0.0200, -0.1400]],
                [[32.1500, -86.0900, 1424.6500], [-3.8980, -1.1950, -17.0970], [1.9600, -0.0300, -0.4100],
                 [-0.0100, 0.0100, -0.0400], [-0.0000, -2.0000, 0.1400], [0.0000, -0.0100, -0.0400]],
                [[27.3000, -86.7500, 1405.4300], [-4.9910, -2.0750, -21.6580], [1.9500, -0.0400, -0.4400],
                 [0.0100, -0.0000, 0.1000], [0.0000, -1.9900, 0.1900], [0.0000, 0.0200, 0.1300]],
                [[22.3100, -90.5200, 1381.4900], [-1.7320, -6.3530, -25.9140], [2.0000, -0.0300, -0.1300],
                 [0.0000, 0.1000, 0.4300], [0.0000, -1.9500, 0.4600], [-0.0100, 0.0700, 0.2800]],
                [[24.4200, -99.5800, 1354.4300], [3.2710, -8.2110, -23.1480], [1.9500, 0.1600, 0.4300],
                 [-0.0100, 0.0500, 0.1700], [-0.0100, -1.8500, 0.7600], [-0.0000, 0.0200, 0.0600]],
                [[28.3800, -106.7800, 1335.2400], [2.3200, -5.2650, -15.7660], [1.9800, 0.0900, 0.2800],
                 [0.0200, -0.0800, -0.2100], [-0.0000, -1.9000, 0.6300], [0.0100, -0.0500, -0.1700]],
                [[29.4700, -110.3400, 1323.1400], [-0.9263, -2.1970, -7.4968], [2.0000, 0.0100, 0.0400],
                 [0.0100, -0.0300, -0.2200], [0.0000, -1.9500, 0.4400], [0.0200, -0.0500, -0.2500]],
                [[29.1389, -113.0662, 1310.4759], [-0.5819, 0.0967, -2.2031], [2.0000, 0.0100, 0.0400],
                 [0.0100, -0.0300, -0.2200], [0.0000, -1.9500, 0.4400], [0.0200, -0.0500, -0.2500]],
                [[28.2100, -113.1300, 1304.7800], [-2.8771, 0.8180, -10.7422], [2.0000, 0.0500, -0.1400],
                 [-0.0300, 0.1200, -0.2100], [0.0600, -2.0000, 0.1000], [-0.0400, 0.2500, -0.8800]],
                [[22.0800, -105.1300, 1283.9900], [-6.2440, 13.1000, -18.0150], [1.9400, 0.2800, -0.4000],
                 [-0.0200, 0.1100, -0.0800], [-0.1100, -1.3600, -1.4600], [-0.0300, 0.2500, -0.7000]],
                [[16.2000, -88.0200, 1270.0700], [-4.7340, 14.7100, -14.7400], [1.9600, 0.2700, -0.3000],
                 [0.0300, -0.1000, 0.1100], [-0.0000, -1.4800, -1.3400], [0.0600, -0.2500, 0.3900]],
                [[12.5900, -75.8000, 1255.0400], [-2.4550, 9.0700, -17.1730], [1.9600, 0.2700, -0.3000],
                 [0.0300, -0.1000, 0.1100], [-0.0000, -1.4800, -1.3400], [0.0600, -0.2500, 0.3900]],
                [[11.3900, -70.2700, 1236.6400], [-0.9680, 2.0750, -17.9280], [1.9600, 0.2700, -0.3000],
                 [0.0300, -0.1000, 0.1100], [-0.0000, -1.4800, -1.3400], [0.0600, -0.2500, 0.3900]],
                [[10.6700, -71.2900, 1219.9900], [-0.7540, -4.0290, -18.4990], [2.0000, -0.0200, -0.1000],
                 [0.0100, -0.0100, 0.1200], [-0.0000, -1.9700, 0.3700], [0.0100, 0.0300, 0.7500]],
                [[9.9200, -78.8500, 1200.3300], [-0.6040, -7.4150, -17.0050], [2.0000, 0.0500, 0.0600],
                 [-0.0300, -0.0400, -0.2000], [0.0200, -1.8100, 0.8500], [-0.0000, -0.0100, -0.0500]],
                [[9.4500, -85.8800, 1185.9700], [-1.6820, -5.4540, -14.7310], [2.0000, 0.0500, 0.0600],
                 [-0.0300, -0.0400, -0.2000], [0.0200, -1.8100, 0.8500], [-0.0000, -0.0100, -0.0500]],
                [[6.6200, -89.7000, 1171.1500], [-3.1360, -3.3600, -15.1710], [1.9400, -0.0800, -0.4600],
                 [-0.0000, 0.0400, 0.0800], [-0.0100, -1.9700, 0.3200], [-0.0100, 0.0400, 0.0800]],
                [[3.1800, -92.5700, 1155.6800], [-1.9530, -4.0670, -14.1290], [1.9400, -0.0800, -0.4600],
                 [-0.0000, 0.0400, 0.0800], [-0.0100, -1.9700, 0.3200], [-0.0100, 0.0400, 0.0800]],
                [[2.5400, -97.5100, 1143.1400], [0.8610, -6.1350, -11.1830], [1.9900, 0.1200, 0.2100],
                 [-0.1400, 0.0700, 0.7900], [0.0000, -1.7400, 0.9900], [0.0000, -0.0200, -0.1000]],
                [[4.7000, -104.4600, 1133.6100], [3.0040, -6.0820, -9.1750], [1.9900, 0.1200, 0.2100],
                 [-0.1400, 0.0700, 0.7900], [0.0000, -1.7400, 0.9900], [0.0000, -0.0200, -0.1000]],
                [[8.4000, -109.6400, 1124.9400], [5.2340, -3.8680, -9.3010], [1.9900, 0.1200, 0.2100],
                 [-0.1400, 0.0700, 0.7900], [0.0000, -1.7400, 0.9900], [0.0000, -0.0200, -0.1000]],
                [[15.0400, -111.8500, 1115.4500], [7.4420, 1.2160, -8.9840], [1.6600, 0.0700, 1.1100],
                 [-0.2300, -0.5000, 0.3600], [-0.0000, -2.0000, 0.1300], [0.0000, 0.1000, -1.0900]],
                [[21.5510, -107.8832, 1108.5723], [4.3528, 3.7140, -4.0727], [1.4900, -0.7400, 1.1000],
                 [0.0100, -0.3900, -0.1600], [0.0000, -1.6600, -1.1200], [-0.0000, 0.2800, -0.7100]],
                [[27.8746, -102.8826, 1102.7865], [5.3910, 3.9787, -4.2085], [1.5644, -0.6947, 0.9895],
                 [0.0100, -0.3900, -0.1600], [0.0000, -1.6600, -1.1200], [-0.0000, 0.2800, -0.7100]],
                [[33.1086, -99.4822, 1096.6479], [5.3801, 3.9959, -4.9890], [1.8813, -0.5939, 0.6402],
                 [0.0100, 0.6100, 0.0200], [-0.0000, -1.4300, -1.4000], [-0.0000, -0.0200, 0.8900]],
                [[38.5392, -94.5072, 1090.8784], [6.1389, 1.6957, -4.6728], [2.0260, -0.1290, 1.4950],
                 [0.1000, 0.7700, -0.2700], [-0.0000, -1.7600, 0.9400], [0.0000, 0.3500, 1.5700]],
                [[46.9139, -94.0263, 1084.1013], [7.5657, -2.4873, -6.8526], [1.7900, 0.8100, 0.3500],
                 [0.5500, -0.4300, -1.4300], [0.0000, -0.8000, 1.8300], [0.0000, 1.5700, 0.2100]],
                [[54.6608, -102.6169, 1076.9305], [2.2781, -7.2224, -3.5053], [1.7900, 0.8100, 0.3500],
                 [0.5500, -0.4300, -1.4300], [0.0000, -0.8000, 1.8300], [0.0000, 1.5700, 0.2100]],
            ]

            bifurcating_nodes = []
            nodesByGroup = [
                ['left vagus X nerve trunk', [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
                                              21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
                                              36, 37, 38, 39, 40]]
            ]

        elif "Right vagus nerve trunk 1" in parameterSetName:
            outerPoints = [
                [[-11.933, -70.156, 1499.057], [-3.097, 0.606, -0.529], [0.335, 1.953, 0.277],
                 [-1.527, 0.347, -0.971], [0.376, 0.213, -1.958], [-0.059, -1.652, -0.316]],
                [[-15.166, -69.390, 1498.361], [-3.073, 1.315, -1.404], [0.842, 1.799, -0.159],
                 [1.280, -0.719, 0.023], [0.642, -0.463, -1.840], [-0.612, 0.410, -0.133]],
                [[-18.534, -67.718, 1497.853], [-3.558, 0.336, -0.953], [0.245, 1.966, -0.221],
                 [1.257, 5.566, -1.272], [0.489, -0.277, -1.923], [0.512, -0.971, -6.700]],
                [[-21.965, -67.307, 1497.407], [-2.728, -1.531, -0.536], [0.763, -1.651, 0.833],
                 [4.047, 4.372, -3.802], [-0.679, 0.586, 1.783], [-1.715, -1.851, -6.928]],
                [[-24.365, -68.632, 1496.944], [-2.578, -1.732, 0.032], [0.908, -1.330, 1.187],
                 [1.131, 0.260, -0.386], [-0.647, 0.992, 1.607], [-0.495, -1.021, 0.408]],
                [[-26.568, -70.920, 1495.855], [-2.105, -1.818, -2.109], [1.564, -1.057, -0.650],
                 [0.084, 0.804, -0.888], [-0.301, -1.342, 1.458], [0.893, -0.579, -0.563]],
                [[-28.595, -72.538, 1493.540], [-1.952, 0.048, -3.429], [1.741, 0.092, -0.990],
                 [0.262, 0.807, 0.435], [0.068, -1.999, -0.067], [-0.421, -0.067, -1.349]],
                [[-30.562, -73.047, 1489.729], [-1.243, -0.584, -4.000], [1.912, -0.088, -0.581],
                 [0.275, 0.009, 1.331], [-0.003, -1.980, 0.290], [-0.158, -0.030, -0.162]],
                [[-31.843, -73.681, 1485.911], [-2.788, -0.763, -3.076], [1.503, -0.315, -1.284],
                 [-0.231, -0.221, -0.315], [0.003, -1.940, 0.479], [-0.252, -0.011, -0.250]],
                [[-33.630, -74.347, 1482.072], [-1.806, -1.381, -3.775], [1.822, -0.240, -0.784],
                 [0.190, 0.159, 0.361], [0.040, -1.886, 0.671], [0.091, 0.074, 0.301]],
                [[-34.533, -75.432, 1477.820], [-1.418, -1.717, -6.328], [1.957, -0.066, -0.421],
                 [-0.068, -0.062, -0.531], [0.045, -1.931, 0.514], [0.045, 0.049, 0.219]],
                [[-36.165, -77.560, 1469.323], [-0.686, -1.658, -8.729], [1.996, 0.018, -0.160],
                 [0.030, 0.084, 0.301], [0.047, -1.970, 0.370], [-0.006, -0.024, -0.114]],
                [[-37.057, -79.450, 1460.670], [-0.949, -2.083, -9.016], [1.988, 0.013, -0.212],
                 [0.004, -0.035, 0.048], [0.060, -1.948, 0.444], [0.023, 0.093, 0.336]],
                [[-37.371, -82.073, 1451.356], [0.927, -2.058, -10.047], [1.996, 0.033, 0.177],
                 [-0.022, 0.068, 0.234], [-0.003, -1.963, 0.402], [0.014, -0.109, -0.496]],
                [[-36.317, -84.402, 1440.777], [1.771, -3.396, -10.660], [1.978, 0.116, 0.292],
                 [-0.008, 0.022, -0.025], [0.022, -1.905, 0.610], [0.032, -0.058, -0.255]],
                [[-34.553, -86.374, 1429.340], [3.088, -2.275, -12.013], [1.940, 0.127, 0.475],
                 [-0.064, -0.052, 0.300], [0.035, -1.965, 0.381], [-0.089, 0.004, 0.112]],
                [[-31.446, -87.600, 1416.322], [2.925, 0.363, -11.409], [1.938, -0.004, 0.497],
                 [-0.017, -0.101, 0.078], [0.011, -1.998, -0.061], [-0.077, 0.015, -0.102]],
                [[-28.935, -87.247, 1406.555], [2.580, 1.851, -9.576], [1.939, -0.074, 0.508],
                 [-0.182, 0.013, 0.529], [0.023, -1.968, -0.374], [-0.092, 0.008, 0.065]],
                [[-26.318, -86.677, 1396.887], [1.127, 1.478, -12.159], [1.989, 0.083, 0.194],
                 [1.239, -1.439, -0.048], [0.105, -1.982, -0.231], [-0.429, 0.085, -0.884]],
                [[-24.009, -85.452, 1382.698], [0.761, -3.243, -11.344], [3.236, -2.891, 1.044],
                 [-0.130, -0.353, 0.879], [-1.369, -1.419, 0.314], [0.009, 0.648, 0.447]],
                [[-23.362, -86.727, 1373.757], [-1.461, -2.961, -8.848], [2.393, -0.803, -0.126],
                 [-0.675, 1.813, -0.366], [-0.333, -1.057, 0.409], [0.916, -0.123, 0.709]],
                [[-23.525, -89.779, 1364.490], [-0.308, -4.922, -15.315], [1.974, 0.299, -0.136],
                 [-0.382, -0.108, -0.748], [0.325, -1.877, 0.597], [0.078, -0.494, -0.290]],
                [[-22.429, -93.904, 1342.814], [10.112, -0.809, -21.026], [1.784, -0.269, 0.868],
                 [-0.182, 0.240, 0.441], [-0.273, -1.985, -0.055], [0.336, 0.328, -2.865]],
                [[-15.381, -83.312, 1322.575], [11.245, 9.106, -20.974], [1.794, -0.264, 0.847],
                 [0.256, -0.091, -0.846], [0.085, -1.849, -0.757], [-0.274, -0.823, 1.339]],
                [[-12.508, -75.558, 1297.419], [4.294, 7.870, -21.396], [1.965, -0.046, 0.378],
                 [0.040, -0.255, 0.602], [0.086, -1.881, -0.675], [-0.225, 0.016, -0.098]],
                [[-10.099, -69.832, 1278.719], [4.309, 9.988, -30.490], [1.964, -0.303, 0.178],
                 [-0.101, -0.228, 0.506], [-0.231, -1.874, -0.647], [-0.062, 0.001, 0.055]],
                [[-2.490, -61.586, 1235.274], [1.391, 0.585, -38.551], [1.992, -0.091, 0.070],
                 [0.028, 0.151, -0.271], [-0.090, -1.994, -0.034], [0.080, -0.057, 0.983]],
                [[-0.683, -67.061, 1203.928], [-2.477, -10.319, -24.684], [1.996, -0.043, -0.182],
                 [-0.020, -0.416, -0.673], [0.030, -1.848, 0.769], [-0.105, 0.175, 0.427]],
                [[-4.063, -78.102, 1185.912], [-5.085, -14.873, -13.686], [1.929, -0.522, -0.150],
                 [-0.158, -0.338, -0.081], [-0.235, -1.302, 1.502], [0.089, 0.546, 0.468]],
                [[-6.106, -92.207, 1172.185], [5.986, -13.557, -14.953], [1.921, 0.334, 0.466],
                 [-0.380, 0.760, 1.227], [-0.063, -1.495, 1.330], [-0.175, -0.394, -0.448]],
                [[0.955, -104.673, 1155.480], [6.986, -12.688, -18.494], [1.764, -0.317, 0.884],
                 [-0.161, -0.713, 0.041], [-0.729, -1.656, 0.861], [-0.768, 0.504, 0.267]],
                [[6.444, -121.020, 1137.493], [5.516, -13.627, -14.099], [1.456, -0.650, 1.198],
                 [-0.261, 0.137, 0.433], [-1.257, -1.338, 0.801], [-0.187, -0.049, -0.302]],
                [[11.717, -133.093, 1129.027], [6.191, -13.439, -5.973], [1.215, -0.140, 1.575],
                 [0.080, 0.382, -0.052], [-1.386, -1.071, 0.974], [0.244, -0.090, 0.219]],
                [[18.443, -146.764, 1123.778], [4.788, -12.265, -3.150], [1.558, 0.297, 1.211],
                 [0.372, -0.078, -0.036], [-1.031, -0.793, 1.521], [-0.033, 0.539, 0.269]],
                [[22.507, -156.621, 1121.351], [4.870, -9.002, -1.974], [1.699, 0.527, 1.786],
                 [0.041, 0.357, -0.181], [-1.142, -0.915, 1.356], [-0.001, 0.574, 1.981]],
                [[26.364, -165.617, 1120.405], [5.854, -6.502, -2.164], [1.517, 1.224, 0.426],
                 [-0.644, 1.030, -1.127], [-0.032, -1.505, 4.435], [0.837, -0.439, 0.039]],
                [[31.391, -171.911, 1119.546], [7.289, -7.217, -1.261], [1.367, 1.429, -0.278],
                 [-1.612, 1.241, -0.645], [0.369, 0.029, 1.967], [-0.238, 1.105, -1.383]],
                [[42.729, -177.037, 1119.916], [10.289, -4.464, -1.321], [0.677, 1.760, -0.675],
                 [-0.648, 0.017, -1.237], [0.473, 0.536, 1.873], [-0.051, 1.238, -0.147]],
                [[52.442, -178.895, 1121.078], [11.829, -2.045, 0.867], [0.120, -0.150, -1.994],
                 [-2.591, -0.953, -2.948], [0.324, 1.824, -0.118], [0.555, 2.464, -1.968]],
                [[66.032, -179.130, 1118.553], [9.387, 3.153, -4.680], [1.011, -1.255, 1.183],
                 [1.017, 3.010, -2.318], [-0.196, -1.445, -1.366], [0.909, 1.704, 1.981]],
                [[72.630, -177.788, 1114.521], [3.628, 1.116, -2.927], [1.210, -1.202, 1.042],
                 [-0.094, -2.907, 1.781], [-0.491, -1.527, -1.191], [-0.918, -1.690, -1.964]],
            ]

            bifurcating_nodes = []
            nodesByGroup = [
                ['right vagus X nerve trunk', [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
                                               21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38,
                                               39, 40, 41]],
            ]


        for n in range(len(outerPoints)):
            node = nodes.findNodeByIdentifier(n + 1)
            fieldcache.setNode(node)
            coordinates.setNodeParameters(fieldcache, -1, Node.VALUE_LABEL_VALUE, 1, outerPoints[n][0])
            #print(n + 1, len(outerPoints[n][1]))
            if (n + 1) in bifurcating_nodes:
                for v in range(len(outerPoints[n][1])):
                    coordinates.setNodeParameters(fieldcache, -1, Node.VALUE_LABEL_D_DS1, v + 1, outerPoints[n][1][v])
                    coordinates.setNodeParameters(fieldcache, -1, Node.VALUE_LABEL_D_DS2, v + 1, outerPoints[n][2][v])
                    coordinates.setNodeParameters(fieldcache, -1, Node.VALUE_LABEL_D2_DS1DS2, v + 1, outerPoints[n][3][v])
                    coordinates.setNodeParameters(fieldcache, -1, Node.VALUE_LABEL_D_DS3, v + 1, outerPoints[n][4][v])
                    coordinates.setNodeParameters(fieldcache, -1, Node.VALUE_LABEL_D2_DS1DS3, v + 1, outerPoints[n][5][v])
            else:
                coordinates.setNodeParameters(fieldcache, -1, Node.VALUE_LABEL_D_DS1, 1, outerPoints[n][1])
                coordinates.setNodeParameters(fieldcache, -1, Node.VALUE_LABEL_D_DS2, 1, outerPoints[n][2])
                coordinates.setNodeParameters(fieldcache, -1, Node.VALUE_LABEL_D2_DS1DS2, 1, outerPoints[n][3])
                coordinates.setNodeParameters(fieldcache, -1, Node.VALUE_LABEL_D_DS3, 1, outerPoints[n][4])
                coordinates.setNodeParameters(fieldcache, -1, Node.VALUE_LABEL_D2_DS1DS3, 1, outerPoints[n][5])

        for group_n in range(len(nodesByGroup)):
            branch_name = nodesByGroup[group_n][0]

            branch_field_group = findOrCreateFieldGroup(fieldmodule, branch_name)
            branch_nodeset = branch_field_group.createNodesetGroup(nodes)

            for n in range(len(nodesByGroup[group_n][1])):
                node = nodes.findNodeByIdentifier(nodesByGroup[group_n][1][n])
                branch_nodeset.addNode(node)

        # create markers
        if 'Left vagus nerve' in parameterSetName:
            markers = [
                ["left level of aortic hiatus on the vagus nerve", [33.06685565736445, -99.79675650489413, 1096.533330802349]],
                ["left level of esophageal hiatus on the vagus nerve", [3.146209400855563, -100.0347608405455, 1139.307993871152]],
                ["left level of sternal angle on the vagus nerve", [22.05489076832703, -104.8332280606236, 1283.890550463673]],
                ["left level of jugular notch on the vagus nerve", [29.38481050304174, -110.2391429293425, 1323.108962286499]],
                ["left level of superior border of the clavicle on the vagus nerve", [28.41567111857362, -107.0795092601865, 1333.898096789418]],
                ["left level of laryngeal prominence on the vagus nerve", [27.86043189405682, -86.62430668141346, 1407.793206838608]],
                ["left level of greater horn of hyoid on the vagus nerve", [35.62824151311525, -83.82816000000001, 1443.993933756558]],
                ["left level of carotid bifurcation on the vagus nerve", [35.11637594753900, -84.55354200000002, 1439.799758114304]],
                ["left level of angle of the mandible on the vagus nerve", [36.11596477766252, -82.68291542919793, 1449.201631366949]],
                ["left level of C1 transverse process on the vagus nerve", [35.61590793674574, -78.40798854214731, 1465.004007224821]],
                ["left level of inferior border of jugular foramen on the vagus nerve", [29.00379183524906, -73.43913993329343, 1489.753246601004]],
                ["left level of superior border of jugular foramen on the vagus nerve", [22.73942104901961, -68.45420763548567, 1496.786534505575]]
            ]
        elif 'Right vagus nerve' in parameterSetName:
            markers = [
                ["right level of aortic hiatus on the vagus nerve", [2.857187369130158e+01, -1.680750064195565e+02, 1.119661917545011e+03]],
                ["right level of esophageal hiatus on the vagus nerve", [-9.195302693446701e-01, -1.016361742421971e+02, 1.159723281904762e+03]],
                ["right level of sternal angle on the vagus nerve", [-1.058497116367158e+01, -7.125811558315239e+01, 1.282280061965457e+03]],
                ["right level of jugular notch on the vagus nerve", [-1.502748368488142e+01, -8.280071937399315e+01, 1.320639742807302e+03]],
                ["right level of superior border of the clavicle on the vagus nerve", [-2.001148178704096e+01, -9.104980648857322e+01, 1.334731212428474e+03]],
                ["right level of laryngeal prominence on the vagus nerve", [-2.849686285614611e+01, -8.749901649558907e+01, 1.406966474946987e+03]],
                ["right level of carotid bifurcation on the vagus nerve", [-3.595517091822101e+01, -8.519973466428642e+01, 1.437131806108974e+03]],
                ["right level of greater horn of hyoid on the vagus nerve", [-3.674862843782626e+01, -8.459908691176865e+01, 1.440846183137809e+03]],
                ["right level of angle of the mandible on the vagus nerve", [-3.744951219372309e+01, -8.229365059535783e+01, 1.450518951633510e+03]],
                ["right level of C1 transverse process on the vagus nerve", [-3.629626827494332e+01, -7.792534894897162e+01, 1.468880881043994e+03]],
                ["right level of inferior border of jugular foramen on the vagus nerve", [-3.205319523842088e+01, -7.382072085130416e+01, 1.485522883019911e+03]],
                ["right level of superior border of jugular foramen on the vagus nerve", [-2.904332161133046e+01, -7.276752724026950e+01, 1.492562938430684e+03]]
            ]
        else:
            markers = []

        # set markers
        datapoints = fieldmodule.findNodesetByFieldDomainType(Field.DOMAIN_TYPE_DATAPOINTS)
        data_coordinates = findOrCreateFieldCoordinates(fieldmodule, "coordinates")
        marker_names = findOrCreateFieldStoredString(fieldmodule, name="marker_name")

        dnodetemplate = datapoints.createNodetemplate()
        dnodetemplate.defineField(data_coordinates)
        dnodetemplate.setValueNumberOfVersions(data_coordinates, -1, Node.VALUE_LABEL_VALUE, 1)
        dnodetemplate.defineField(marker_names)

        marker_fieldgroup = findOrCreateFieldGroup(fieldmodule, 'marker')
        marker_nodesetgroup = marker_fieldgroup.createNodesetGroup(datapoints)
        for n in range(len(markers)):
            node = datapoints.createNode(n + 1, dnodetemplate)
            fieldcache.setNode(node)
            data_coordinates.setNodeParameters(fieldcache, -1, Node.VALUE_LABEL_VALUE, 1, markers[n][1])
            marker_names.assignString(fieldcache, markers[n][0])
            marker_nodesetgroup.addNode(node)

        if defineInnerCoordinates:
            cls._defineInnerCoordinates(region, coordinates, options, networkMesh)

        return [], networkMesh

    @classmethod
    def _defineInnerCoordinates(cls, region, coordinates, options, networkMesh):
        """
        Copy coordinates to inner coordinates via in-memory model file.
        Assign using the interactive function.
        :param region: Region to define field in.
        :param coordinates: Standard/outer coordinate field.
        :param options: Options used to generate scaffold.
        :param networkMesh: Network mesh object used to generate scaffold.
        """
        assert options["Define inner coordinates"]
        coordinates.setName("inner coordinates")  # temporarily rename
        sir = region.createStreaminformationRegion()
        srm = sir.createStreamresourceMemory()
        region.write(sir)
        result, buffer = srm.getBuffer()
        coordinates.setName("coordinates")  # restore name before reading inner coordinates back in
        sir = region.createStreaminformationRegion()
        sir.createStreamresourceMemoryBuffer(buffer)
        region.read(sir)
        functionOptions = {
            "To field": {"coordinates": False, "inner coordinates": True},
            "From field": {"coordinates": True, "inner coordinates": False},
            "Mode": {"Scale": True, "Offset": False},
            "D2 value": 0.5,
            "D3 value": 0.5}
        cls.assignCoordinates(region, options, networkMesh, functionOptions, editGroupName=None)

    @classmethod
    def editStructure(cls, region, options, networkMesh, functionOptions, editGroupName):
        """
        Edit structure safely, to prevent accidental changes.
        Copies functionOptions["Structure"] to options["Structure"] and regenerates with
        default geometric coordinates.
        :param region: Region containing model to clear and re-generate.
        :param options: The scaffold settings used to create the original model, pre-edits.
        :param networkMesh: The NetworkMesh construction object model was created from. Contents replaced.
        :param functionOptions: functionOptions["Structure"] contains new structure string.
        :param editGroupName: Name of Zinc group to put edited nodes in. Cleared.
        :return: boolean indicating if settings changed, boolean indicating if node parameters changed.
        """
        fieldmodule = region.getFieldmodule()
        with ChangeManager(fieldmodule):
            clearRegion(region)
            structure = options["Structure"] = functionOptions["Structure"]
            networkMesh.build(structure)
            networkMesh.create1DLayoutMesh(region)
            coordinates = findOrCreateFieldCoordinates(fieldmodule).castFiniteElement()
            coordinates.setManaged(True)  # since cleared by clearRegion
            defineInnerCoordinates = options["Define inner coordinates"]
            if defineInnerCoordinates:
                cls._defineInnerCoordinates(region, coordinates, options, networkMesh)

        return True, False  # settings changed, nodes not changed (since reset to original coordinates)

    class AssignCoordinatesMode(Enum):
        SCALE = 1,  # scale side derivative magnitude by value
        OFFSET = 2   # offset side derivative by absolute distance

    @classmethod
    def assignCoordinates(cls, region, options, networkMesh, functionOptions, editGroupName):
        """
        Assign coordinates or inner coordinates by scaling or offsetting from either original
        values or values from other field.
        If elements are selected, applied only to nodes used by the element and versions used in the enclosing segment.
        :param region: Region containing model to change parameters of.
        :param options: The scaffold settings used to create the original model, pre-edits.
        :param networkMesh: The NetworkMesh construction object model was created from. Unused.
        :param functionOptions: Which side directions to make normal.
        :param editGroupName: Name of Zinc group to put edited nodes in.
        :return: boolean indicating if settings changed, boolean indicating if node parameters changed.
        """
        fieldmodule = region.getFieldmodule()
        coordinates = fieldmodule.findFieldByName("coordinates").castFiniteElement()
        innerCoordinates = fieldmodule.findFieldByName("inner coordinates").castFiniteElement()
        if (functionOptions["To field"]["inner coordinates"] or functionOptions["From field"]["inner coordinates"]) \
                and not innerCoordinates.isValid():
            print("Assign coordinates:  inner coordinates field not defined")
            return False, False
        mode = None
        if functionOptions["Mode"]["Scale"]:
            mode = cls.AssignCoordinatesMode.SCALE
        elif functionOptions["Mode"]["Offset"]:
            mode = cls.AssignCoordinatesMode.OFFSET
        else:
            print("Assign coordinates:  Invalid mode")
            return False, False
        toCoordinates = coordinates if functionOptions["To field"]["coordinates"] else innerCoordinates
        fromCoordinates = coordinates if functionOptions["From field"]["coordinates"] else innerCoordinates
        d2Value = functionOptions["D2 value"]
        d3Value = functionOptions["D3 value"]
        nodeset = fieldmodule.findNodesetByFieldDomainType(Field.DOMAIN_TYPE_NODES)
        selectionGroup = scene_get_selection_group(region.getScene(), inherit_root_region=region.getRoot())
        selectionMeshGroup = None
        mesh1d = fieldmodule.findMeshByDimension(1)
        nodes = fieldmodule.findNodesetByFieldDomainType(Field.DOMAIN_TYPE_NODES)
        if selectionGroup:
            selectionMeshGroup = selectionGroup.getMeshGroup(mesh1d)
            if not selectionMeshGroup.isValid():
                print("Assign coordinates:  Selection contains no elements. Clear it to assign globally.")
                return False, False
        valueLabels = [
            Node.VALUE_LABEL_VALUE, Node.VALUE_LABEL_D_DS1,
            Node.VALUE_LABEL_D_DS2, Node.VALUE_LABEL_D2_DS1DS2,
            Node.VALUE_LABEL_D_DS3, Node.VALUE_LABEL_D2_DS1DS3]

        with ChangeManager(fieldmodule):
            # get all node parameters (from selection if any)
            editNodeset = nodeset
            originalNodeParameters = None
            if selectionGroup:
                # make group of only nodes being edited
                tmpGroup = fieldmodule.createFieldGroup()
                tmpGroup.setSubelementHandlingMode(FieldGroup.SUBELEMENT_HANDLING_MODE_FULL)
                tmpMeshGroup = tmpGroup.createMeshGroup(mesh1d)
                tmpMeshGroup.addElementsConditional(selectionGroup)
                editNodeset = tmpGroup.getNodesetGroup(nodes)
                _, originalNodeParameters = get_nodeset_field_parameters(editNodeset, toCoordinates, valueLabels)
                del tmpMeshGroup
                del tmpGroup
            _, nodeParameters = get_nodeset_field_parameters(editNodeset, fromCoordinates, valueLabels)

            modifyVersions = None  # default is to modify all versions
            if selectionGroup:
                nodeIdentifierIndexes = {}
                modifyVersions = []
                for n in range(len(nodeParameters)):
                    nodeIdentifierIndexes[nodeParameters[n][0]] = n
                    versionsCount = len(nodeParameters[n][1][1])
                    modifyVersions.append([False] * versionsCount if selectionGroup else [True] * versionsCount)
                networkSegments = networkMesh.getNetworkSegments()
                for networkSegment in networkSegments:
                    nodeIdentifiers = networkSegment.getNodeIdentifiers()
                    nodeVersions = networkSegment.getNodeVersions()
                    elementIdentifiers = networkSegment.getElementIdentifiers()
                    for e in range(len(elementIdentifiers)):
                        elementIdentifier = elementIdentifiers[e]
                        element = selectionMeshGroup.findElementByIdentifier(elementIdentifier)
                        if element.isValid():
                            for n in [e, e + 1]:
                                nodeIndex = nodeIdentifierIndexes.get(nodeIdentifiers[n])
                                # print("Node identifier", nodeIdentifiers[n], "index", nodeIndex, "version", nodeVersions[n])
                                if nodeIndex is not None:
                                    modifyVersions[nodeIndex][nodeVersions[n] - 1] = True

            for n in range(len(nodeParameters)):
                modifyVersion = modifyVersions[n] if modifyVersions else None
                nNodeParameters = nodeParameters[n][1]
                oNodeParameters = originalNodeParameters[n][1] if modifyVersions else None
                versionsCount = len(nNodeParameters[1])
                for v in range(versionsCount):
                    if (not modifyVersions) or modifyVersion[v]:
                        for dd in range(2):
                            scale = d2Value if (dd == 0) else d3Value
                            if mode == cls.AssignCoordinatesMode.OFFSET:
                                mag = magnitude(nNodeParameters[2 + 2 * dd][v])
                                scale = (mag + scale) / mag if (abs(mag) > 0.0) else 1.0
                            for d in [2 + 2 * dd, 3 + 2 * dd]:
                                nNodeParameters[d][v] = mult(nNodeParameters[d][v], scale)
                    else:
                        # copy original derivative versions
                        for d in range(2, 6):
                            nNodeParameters[d][v] = oNodeParameters[d][v]

            set_nodeset_field_parameters(editNodeset, toCoordinates, valueLabels, nodeParameters, editGroupName)
            del editNodeset

        return False, True  # settings not changed, nodes changed

    @classmethod
    def makeSideDerivativesNormal(cls, region, options, networkMesh, functionOptions, editGroupName):
        """
        Make side directions normal to d1 and each other. Works for all versions.
        :param region: Region containing model to change parameters of.
        :param options: The scaffold settings used to create the original model, pre-edits.
        :param networkMesh: The NetworkMesh construction object model was created from. Unused.
        :param functionOptions: Which side directions to make normal.
        :param editGroupName: Name of Zinc group to put edited nodes in.
        :return: boolean indicating if settings changed, boolean indicating if node parameters changed.
        """
        fieldmodule = region.getFieldmodule()
        coordinates = fieldmodule.findFieldByName("coordinates").castFiniteElement()
        innerCoordinates = fieldmodule.findFieldByName("inner coordinates").castFiniteElement()
        if functionOptions["Field"]["inner coordinates"] and not innerCoordinates.isValid():
            print("Make side derivatives normal:  inner coordinates field not defined")
            return False, False
        useCoordinates = coordinates if functionOptions["Field"]["coordinates"] else innerCoordinates
        makeD2Normal = functionOptions['Make D2 normal']
        makeD3Normal = functionOptions['Make D3 normal']
        if not (makeD2Normal or makeD3Normal):
            return False, False
        nodeset = fieldmodule.findNodesetByFieldDomainType(Field.DOMAIN_TYPE_NODES)
        make_nodeset_derivatives_orthogonal(nodeset, useCoordinates, makeD2Normal, makeD3Normal, editGroupName)
        return False, True  # settings not changed, nodes changed

    @classmethod
    def smoothSideCrossDerivatives(cls, region, options, networkMesh, functionOptions, editGroupName):
        """
        Smooth side cross derivatives giving rate of change of side directions d2, d3 w.r.t. d1.
        If a single element in a segment is selected, the whole segment is smoothed, and if the segment
        connects to others with the same version, they are also smoothed with it.
        Also detects loops back to the start of a segment.
        :param region: Region containing model to change parameters of.
        :param options: The scaffold settings used to create the original model, pre-edits.
        :param networkMesh: The NetworkMesh construction object model was created from.
        Used to determine connected paths for smoothing.
        :param functionOptions: Which side derivatives to smooth.
        :param editGroupName: Name of Zinc group to put edited nodes in.
        :return: boolean indicating if settings changed, boolean indicating if node parameters changed.
        """
        fieldmodule = region.getFieldmodule()
        coordinates = fieldmodule.findFieldByName("coordinates").castFiniteElement()
        innerCoordinates = fieldmodule.findFieldByName("inner coordinates").castFiniteElement()
        if functionOptions["Field"]["inner coordinates"] and not innerCoordinates.isValid():
            print("Make side derivatives normal:  inner coordinates field not defined")
            return False, False
        useCoordinates = coordinates if functionOptions["Field"]["coordinates"] else innerCoordinates
        smoothD12 = functionOptions["Smooth D12"]
        smoothD13 = functionOptions["Smooth D13"]
        if not (smoothD12 or smoothD13):
            return False, False

        nodes = fieldmodule.findNodesetByFieldDomainType(Field.DOMAIN_TYPE_NODES)
        selectionGroup = scene_get_selection_group(region.getScene(), inherit_root_region=region.getRoot())
        selectionMeshGroup = None
        mesh1d = fieldmodule.findMeshByDimension(1)
        if selectionGroup:
            selectionMeshGroup = selectionGroup.getMeshGroup(mesh1d)
            if not selectionMeshGroup.isValid():
                print("Smooth side cross derivatives:  Selection must contain elements to smooth segment chains "
                    "containing them, or be clear it to smooth all segment chains.")
                return False, False
        getValueLabels = [Node.VALUE_LABEL_VALUE, Node.VALUE_LABEL_D_DS1]
        setValueLabels = []
        if smoothD12:
            getValueLabels.append(Node.VALUE_LABEL_D_DS2)
            setValueLabels.append(Node.VALUE_LABEL_D2_DS1DS2)
        if smoothD13:
            getValueLabels.append(Node.VALUE_LABEL_D_DS3)
            setValueLabels.append(Node.VALUE_LABEL_D2_DS1DS3)

        # determine segment chains which must be smoothed together:
        # currently only links segments aligned in the same direction
        networkSegments = networkMesh.getNetworkSegments()
        segmentChains = []
        segmentChainsLoop = []  # True if same index segment chain is a loop
        processedSegments = set()
        for segment in networkSegments:
            if segment in processedSegments:
                continue
            segmentChain = [segment]
            processedSegments.add(segment)
            # add other non-processed segments attached and using the same derivative version
            startNetworkNode = segment.getNetworkNodes()[0]
            startNodeVersion = segment.getNodeVersions()[0]
            endNetworkNode = segment.getNetworkNodes()[-1]
            endNodeVersion = segment.getNodeVersions()[-1]
            while True:
                for outSegment in endNetworkNode.getOutSegments():
                    if ((outSegment.getNodeVersions()[0] == endNodeVersion) and
                            outSegment not in processedSegments):
                        segmentChain.append(outSegment)
                        processedSegments.add(outSegment)
                        endNetworkNode = outSegment.getNetworkNodes()[-1]
                        endNodeVersion = outSegment.getNodeVersions()[-1]
                        break
                else:
                    break
            while True:
                for inSegment in startNetworkNode.getInSegments():
                    if ((inSegment.getNodeVersions()[-1] == startNodeVersion) and
                            inSegment not in processedSegments):
                        segmentChain.insert(0, inSegment)
                        processedSegments.add(inSegment)
                        startNetworkNode = inSegment.getNetworkNodes()[0]
                        startNodeVersion = inSegment.getNodeVersions()[0]
                        break
                else:
                    break
            segmentChains.append(segmentChain)
            segmentChainsLoop.append((startNetworkNode == endNetworkNode) and (startNodeVersion == endNodeVersion))

        with ChangeManager(fieldmodule):

            editNodeset = nodes
            if selectionGroup:
                # include only chains containing a selected element
                chainIndex = 0
                while chainIndex < len(segmentChains):
                    segmentChain = segmentChains[chainIndex]
                    for segment in segmentChain:
                        if segment.hasLayoutElementsInMeshGroup(selectionMeshGroup):
                            break
                    else:
                        segmentChains.pop(chainIndex)
                        segmentChainsLoop.pop(chainIndex)
                        continue
                    chainIndex += 1
                # make group of only nodes being edited
                tmpGroup = fieldmodule.createFieldGroup()
                editNodeset = tmpGroup.createNodesetGroup(nodes)
                for segmentChain in segmentChains:
                    for segment in segmentChain:
                        for nodeIdentifier in segment.getNodeIdentifiers():
                            editNodeset.addNode(nodes.findNodeByIdentifier(nodeIdentifier))
                del tmpGroup

            _, nodeParameters = get_nodeset_field_parameters(editNodeset, useCoordinates, setValueLabels)
            nodeIdentifierIndexes = {}
            for n in range(len(nodeParameters)):
                nodeIdentifierIndexes[nodeParameters[n][0]] = n

            for chainIndex in range(len(segmentChains)):
                # get parameters for chain
                segmentChain = segmentChains[chainIndex]
                loop = segmentChainsLoop[chainIndex]
                segmentsCount = len(segmentChain)
                nx = []
                nd1 = []
                sideVectorsCount = 2 if smoothD12 and smoothD13 else 1
                nsv = [[] for s in range(sideVectorsCount)]
                nodeIdentifiers = []
                nodeVersions = []
                for segmentIndex in range(segmentsCount):
                    segment = segmentChain[segmentIndex]
                    segmentNodeIdentifiers = segment.getNodeIdentifiers()
                    segmentNodeVersions = segment.getNodeVersions()
                    segmentParameters = get_nodeset_path_ordered_field_parameters(
                        nodes, useCoordinates, getValueLabels, segmentNodeIdentifiers, segmentNodeVersions)
                    nodesCount = len(segmentNodeIdentifiers)
                    if loop or (segmentIndex < (segmentsCount - 1)):
                        nodesCount -= 1
                    nx += segmentParameters[0][:nodesCount]
                    nd1 += segmentParameters[1][:nodesCount]
                    for s in range(sideVectorsCount):
                        nsv[s] += segmentParameters[2 + s][:nodesCount]
                    nodeIdentifiers += segmentNodeIdentifiers[:nodesCount]
                    nodeVersions += segmentNodeVersions[:nodesCount]
                dnsv = smoothCurveSideCrossDerivatives(nx, nd1, nsv, loop=loop)
                for n in range(len(nodeIdentifiers)):
                    nodeIndex = nodeIdentifierIndexes.get(nodeIdentifiers[n])
                    nodeVersion = nodeVersions[n] - 1
                    assert nodeIndex is not None
                    for s in range(sideVectorsCount):
                        nodeParameters[nodeIndex][1][s][nodeVersion] = dnsv[s][n]

            set_nodeset_field_parameters(editNodeset, useCoordinates, setValueLabels, nodeParameters, editGroupName)
            del editNodeset

        return False, True  # settings not changed, nodes changed

    @classmethod
    def getInteractiveFunctions(cls):
        """
        Supply client with functions for smoothing path parameters.
        """
        # add choice of field to base functions
        modifiedBaseInteractiveFunctions = []
        for interactiveFunction in Scaffold_base.getInteractiveFunctions():
            dct = {"Field": {"coordinates": True, "inner coordinates": False}}
            dct.update(interactiveFunction[1])
            modifiedBaseInteractiveFunctions.append((
               interactiveFunction[0], dct,
               interactiveFunction[2]))
        return modifiedBaseInteractiveFunctions + [
            ("Edit structure...", {
                "Structure": None},  # None = take value from options
                lambda region, options, networkMesh, functionOptions, editGroupName:
                    cls.editStructure(region, options, networkMesh, functionOptions, editGroupName)),
            ("Assign coordinates...", {
                "To field": {"coordinates": True, "inner coordinates": False},
                "From field": {"coordinates": True, "inner coordinates": False},
                "Mode": {"Scale": True, "Offset": False},
                "D2 value": 1.0,
                "D3 value": 1.0},
                lambda region, options, networkMesh, functionOptions, editGroupName:
                    cls.assignCoordinates(region, options, networkMesh, functionOptions, editGroupName)),
            ("Make side derivatives normal...", {
                "Field": {"coordinates": True, "inner coordinates": False},
                "Make D2 normal": True,
                "Make D3 normal": True},
                lambda region, options, networkMesh, functionOptions, editGroupName:
                    cls.makeSideDerivativesNormal(region, options, networkMesh, functionOptions, editGroupName)),
            ("Smooth side cross derivatives...", {
                "Field": {"coordinates": True, "inner coordinates": False},
                "Smooth D12": True,
                "Smooth D13": True},
                lambda region, options, networkMesh, functionOptions, editGroupName:
                    cls.smoothSideCrossDerivatives(region, options, networkMesh, functionOptions, editGroupName))
        ]
